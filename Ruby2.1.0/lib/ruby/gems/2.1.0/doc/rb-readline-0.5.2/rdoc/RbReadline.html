<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>module RbReadline - Rb-Readline - Documentation</title>

<link href="./fonts.css" rel="stylesheet">
<link href="./rdoc.css" rel="stylesheet">

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
</script>

<script src="./js/jquery.js"></script>
<script src="./js/navigation.js"></script>
<script src="./js/search_index.js"></script>
<script src="./js/search.js"></script>
<script src="./js/searcher.js"></script>
<script src="./js/darkfish.js"></script>


<body id="top" role="document" class="module">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  

  <div id="class-metadata">
    
    
    
    
    <!-- Method Quickref -->
<div id="method-list-section" class="nav-section">
  <h3>Methods</h3>

  <ul class="link-list" role="directory">
    
    <li ><a href="#method-i-__rl_fix_point">#__rl_fix_point</a>
    
    <li ><a href="#method-i-_extract_last_quote">#_extract_last_quote</a>
    
    <li ><a href="#method-i-_rl_abort_internal">#_rl_abort_internal</a>
    
    <li ><a href="#method-i-_rl_adjust_point">#_rl_adjust_point</a>
    
    <li ><a href="#method-i-_rl_any_typein">#_rl_any_typein</a>
    
    <li ><a href="#method-i-_rl_arg_dispatch">#_rl_arg_dispatch</a>
    
    <li ><a href="#method-i-_rl_arg_getchar">#_rl_arg_getchar</a>
    
    <li ><a href="#method-i-_rl_arg_init">#_rl_arg_init</a>
    
    <li ><a href="#method-i-_rl_arg_overflow">#_rl_arg_overflow</a>
    
    <li ><a href="#method-i-_rl_backspace">#_rl_backspace</a>
    
    <li ><a href="#method-i-_rl_bind_tty_special_chars">#_rl_bind_tty_special_chars</a>
    
    <li ><a href="#method-i-_rl_char_search">#_rl_char_search</a>
    
    <li ><a href="#method-i-_rl_char_search_internal">#_rl_char_search_internal</a>
    
    <li ><a href="#method-i-_rl_char_value">#_rl_char_value</a>
    
    <li ><a href="#method-i-_rl_clean_up_for_exit">#_rl_clean_up_for_exit</a>
    
    <li ><a href="#method-i-_rl_clear_screen">#_rl_clear_screen</a>
    
    <li ><a href="#method-i-_rl_clear_to_eol">#_rl_clear_to_eol</a>
    
    <li ><a href="#method-i-_rl_col_width">#_rl_col_width</a>
    
    <li ><a href="#method-i-_rl_compare_chars">#_rl_compare_chars</a>
    
    <li ><a href="#method-i-_rl_control_keypad">#_rl_control_keypad</a>
    
    <li ><a href="#method-i-_rl_copy_to_kill_ring">#_rl_copy_to_kill_ring</a>
    
    <li ><a href="#method-i-_rl_current_display_line">#_rl_current_display_line</a>
    
    <li ><a href="#method-i-_rl_dispatch">#_rl_dispatch</a>
    
    <li ><a href="#method-i-_rl_dispatch_subseq">#_rl_dispatch_subseq</a>
    
    <li ><a href="#method-i-_rl_enable_meta_key">#_rl_enable_meta_key</a>
    
    <li ><a href="#method-i-_rl_erase_at_end_of_line">#_rl_erase_at_end_of_line</a>
    
    <li ><a href="#method-i-_rl_erase_entire_line">#_rl_erase_entire_line</a>
    
    <li ><a href="#method-i-_rl_find_completion_word">#_rl_find_completion_word</a>
    
    <li ><a href="#method-i-_rl_find_next_mbchar">#_rl_find_next_mbchar</a>
    
    <li ><a href="#method-i-_rl_find_prev_mbchar">#_rl_find_prev_mbchar</a>
    
    <li ><a href="#method-i-_rl_fix_point">#_rl_fix_point</a>
    
    <li ><a href="#method-i-_rl_get_char_len">#_rl_get_char_len</a>
    
    <li ><a href="#method-i-_rl_get_screen_size">#_rl_get_screen_size</a>
    
    <li ><a href="#method-i-_rl_history_set_point">#_rl_history_set_point</a>
    
    <li ><a href="#method-i-_rl_init_eightbit">#_rl_init_eightbit</a>
    
    <li ><a href="#method-i-_rl_init_line_state">#_rl_init_line_state</a>
    
    <li ><a href="#method-i-_rl_init_terminal_io">#_rl_init_terminal_io</a>
    
    <li ><a href="#method-i-_rl_input_available">#_rl_input_available</a>
    
    <li ><a href="#method-i-_rl_insert_char">#_rl_insert_char</a>
    
    <li ><a href="#method-i-_rl_insert_next">#_rl_insert_next</a>
    
    <li ><a href="#method-i-_rl_insert_typein">#_rl_insert_typein</a>
    
    <li ><a href="#method-i-_rl_internal_char_cleanup">#_rl_internal_char_cleanup</a>
    
    <li ><a href="#method-i-_rl_internal_pager">#_rl_internal_pager</a>
    
    <li ><a href="#method-i-_rl_is_mbchar_matched">#_rl_is_mbchar_matched</a>
    
    <li ><a href="#method-i-_rl_isearch_cleanup">#_rl_isearch_cleanup</a>
    
    <li ><a href="#method-i-_rl_isearch_dispatch">#_rl_isearch_dispatch</a>
    
    <li ><a href="#method-i-_rl_isearch_fini">#_rl_isearch_fini</a>
    
    <li ><a href="#method-i-_rl_isearch_init">#_rl_isearch_init</a>
    
    <li ><a href="#method-i-_rl_make_prompt_for_search">#_rl_make_prompt_for_search</a>
    
    <li ><a href="#method-i-_rl_move_cursor_relative">#_rl_move_cursor_relative</a>
    
    <li ><a href="#method-i-_rl_move_vert">#_rl_move_vert</a>
    
    <li ><a href="#method-i-_rl_nsearch_abort">#_rl_nsearch_abort</a>
    
    <li ><a href="#method-i-_rl_nsearch_cleanup">#_rl_nsearch_cleanup</a>
    
    <li ><a href="#method-i-_rl_nsearch_dispatch">#_rl_nsearch_dispatch</a>
    
    <li ><a href="#method-i-_rl_nsearch_dosearch">#_rl_nsearch_dosearch</a>
    
    <li ><a href="#method-i-_rl_nsearch_init">#_rl_nsearch_init</a>
    
    <li ><a href="#method-i-_rl_output_some_chars">#_rl_output_some_chars</a>
    
    <li ><a href="#method-i-_rl_overwrite_char">#_rl_overwrite_char</a>
    
    <li ><a href="#method-i-_rl_overwrite_rubout">#_rl_overwrite_rubout</a>
    
    <li ><a href="#method-i-_rl_read_init_file">#_rl_read_init_file</a>
    
    <li ><a href="#method-i-_rl_read_mbchar">#_rl_read_mbchar</a>
    
    <li ><a href="#method-i-_rl_read_mbstring">#_rl_read_mbstring</a>
    
    <li ><a href="#method-i-_rl_redisplay_after_sigwinch">#_rl_redisplay_after_sigwinch</a>
    
    <li ><a href="#method-i-_rl_replace_text">#_rl_replace_text</a>
    
    <li ><a href="#method-i-_rl_reset_argument">#_rl_reset_argument</a>
    
    <li ><a href="#method-i-_rl_rubout_char">#_rl_rubout_char</a>
    
    <li ><a href="#method-i-_rl_scxt_alloc">#_rl_scxt_alloc</a>
    
    <li ><a href="#method-i-_rl_search_getchar">#_rl_search_getchar</a>
    
    <li ><a href="#method-i-_rl_set_insert_mode">#_rl_set_insert_mode</a>
    
    <li ><a href="#method-i-_rl_set_mark_at_pos">#_rl_set_mark_at_pos</a>
    
    <li ><a href="#method-i-_rl_start_using_history">#_rl_start_using_history</a>
    
    <li ><a href="#method-i-_rl_strip_prompt">#_rl_strip_prompt</a>
    
    <li ><a href="#method-i-_rl_subseq_getchar">#_rl_subseq_getchar</a>
    
    <li ><a href="#method-i-_rl_to_lower">#_rl_to_lower</a>
    
    <li ><a href="#method-i-_rl_unget_char">#_rl_unget_char</a>
    
    <li ><a href="#method-i-_rl_update_final">#_rl_update_final</a>
    
    <li ><a href="#method-i-_rl_vi_done_inserting">#_rl_vi_done_inserting</a>
    
    <li ><a href="#method-i-_rl_vi_initialize_line">#_rl_vi_initialize_line</a>
    
    <li ><a href="#method-i-_rl_vi_reset_last">#_rl_vi_reset_last</a>
    
    <li ><a href="#method-i-_rl_vi_save_insert">#_rl_vi_save_insert</a>
    
    <li ><a href="#method-i-_rl_vi_textmod_command">#_rl_vi_textmod_command</a>
    
    <li ><a href="#method-i-_rl_walphabetic">#_rl_walphabetic</a>
    
    <li ><a href="#method-i-add_history">#add_history</a>
    
    <li ><a href="#method-i-alloc_history_entry">#alloc_history_entry</a>
    
    <li ><a href="#method-i-alloc_undo_entry">#alloc_undo_entry</a>
    
    <li ><a href="#method-i-append_to_match">#append_to_match</a>
    
    <li ><a href="#method-i-bind_arrow_keys">#bind_arrow_keys</a>
    
    <li ><a href="#method-i-bind_arrow_keys_internal">#bind_arrow_keys_internal</a>
    
    <li ><a href="#method-i-bind_termcap_arrow_keys">#bind_termcap_arrow_keys</a>
    
    <li ><a href="#method-i-block_sigint">#block_sigint</a>
    
    <li ><a href="#method-i-clear_history">#clear_history</a>
    
    <li ><a href="#method-i-compute_lcd_of_matches">#compute_lcd_of_matches</a>
    
    <li ><a href="#method-i-cr">#cr</a>
    
    <li ><a href="#method-i-cr_faster">#cr_faster</a>
    
    <li ><a href="#method-i-ctrl_char">#ctrl_char</a>
    
    <li ><a href="#method-i-current_history">#current_history</a>
    
    <li ><a href="#method-i-delete_chars">#delete_chars</a>
    
    <li ><a href="#method-i-display_matches">#display_matches</a>
    
    <li ><a href="#method-i-endsrch_char">#endsrch_char</a>
    
    <li ><a href="#method-i-expand_prompt">#expand_prompt</a>
    
    <li ><a href="#method-i-fnprint">#fnprint</a>
    
    <li ><a href="#method-i-fnwidth">#fnwidth</a>
    
    <li ><a href="#method-i-gen_completion_matches">#gen_completion_matches</a>
    
    <li ><a href="#method-i-get_term_capabilities">#get_term_capabilities</a>
    
    <li ><a href="#method-i-get_y_or_n">#get_y_or_n</a>
    
    <li ><a href="#method-i-handle_parser_directive">#handle_parser_directive</a>
    
    <li ><a href="#method-i-hist_inittime">#hist_inittime</a>
    
    <li ><a href="#method-i-history_arg_extract">#history_arg_extract</a>
    
    <li ><a href="#method-i-history_get">#history_get</a>
    
    <li ><a href="#method-i-history_is_stifled">#history_is_stifled</a>
    
    <li ><a href="#method-i-history_list">#history_list</a>
    
    <li ><a href="#method-i-history_search_pos">#history_search_pos</a>
    
    <li ><a href="#method-i-history_search_prefix">#history_search_prefix</a>
    
    <li ><a href="#method-i-history_set_pos">#history_set_pos</a>
    
    <li ><a href="#method-i-ibuffer_space">#ibuffer_space</a>
    
    <li ><a href="#method-i-init_line_structures">#init_line_structures</a>
    
    <li ><a href="#method-i-insert_all_matches">#insert_all_matches</a>
    
    <li ><a href="#method-i-insert_match">#insert_match</a>
    
    <li ><a href="#method-i-insert_some_chars">#insert_some_chars</a>
    
    <li ><a href="#method-i-inv_line">#inv_line</a>
    
    <li ><a href="#method-i-inv_llen">#inv_llen</a>
    
    <li ><a href="#method-i-isascii">#isascii</a>
    
    <li ><a href="#method-i-isprint">#isprint</a>
    
    <li ><a href="#method-i-m_offset">#m_offset</a>
    
    <li ><a href="#method-i-make_history_line_current">#make_history_line_current</a>
    
    <li ><a href="#method-i-make_quoted_replacement">#make_quoted_replacement</a>
    
    <li ><a href="#method-i-meta_char">#meta_char</a>
    
    <li ><a href="#method-i-next_history">#next_history</a>
    
    <li ><a href="#method-i-no_terminal-3F">#no_terminal?</a>
    
    <li ><a href="#method-i-noninc_dosearch">#noninc_dosearch</a>
    
    <li ><a href="#method-i-noninc_search">#noninc_search</a>
    
    <li ><a href="#method-i-noninc_search_from_pos">#noninc_search_from_pos</a>
    
    <li ><a href="#method-i-parser_else">#parser_else</a>
    
    <li ><a href="#method-i-parser_endif">#parser_endif</a>
    
    <li ><a href="#method-i-parser_if">#parser_if</a>
    
    <li ><a href="#method-i-parser_include">#parser_include</a>
    
    <li ><a href="#method-i-path_isdir">#path_isdir</a>
    
    <li ><a href="#method-i-postprocess_matches">#postprocess_matches</a>
    
    <li ><a href="#method-i-prepare_terminal_settings">#prepare_terminal_settings</a>
    
    <li ><a href="#method-i-previous_history">#previous_history</a>
    
    <li ><a href="#method-i-print_filename">#print_filename</a>
    
    <li ><a href="#method-i-printable_part">#printable_part</a>
    
    <li ><a href="#method-i-prompt_ending_index">#prompt_ending_index</a>
    
    <li ><a href="#method-i-readline">#readline</a>
    
    <li ><a href="#method-i-readline_default_bindings">#readline_default_bindings</a>
    
    <li ><a href="#method-i-readline_initialize_everything">#readline_initialize_everything</a>
    
    <li ><a href="#method-i-readline_internal">#readline_internal</a>
    
    <li ><a href="#method-i-readline_internal_charloop">#readline_internal_charloop</a>
    
    <li ><a href="#method-i-readline_internal_setup">#readline_internal_setup</a>
    
    <li ><a href="#method-i-readline_internal_teardown">#readline_internal_teardown</a>
    
    <li ><a href="#method-i-redraw_prompt">#redraw_prompt</a>
    
    <li ><a href="#method-i-release_sigint">#release_sigint</a>
    
    <li ><a href="#method-i-remove_duplicate_matches">#remove_duplicate_matches</a>
    
    <li ><a href="#method-i-remove_history">#remove_history</a>
    
    <li ><a href="#method-i-replace_history_data">#replace_history_data</a>
    
    <li ><a href="#method-i-replace_history_entry">#replace_history_entry</a>
    
    <li ><a href="#method-i-retry_if_interrupted">#retry_if_interrupted</a>
    
    <li ><a href="#method-i-rl_abort">#rl_abort</a>
    
    <li ><a href="#method-i-rl_add_undo">#rl_add_undo</a>
    
    <li ><a href="#method-i-rl_alphabetic">#rl_alphabetic</a>
    
    <li ><a href="#method-i-rl_arrow_keys">#rl_arrow_keys</a>
    
    <li ><a href="#method-i-rl_backward">#rl_backward</a>
    
    <li ><a href="#method-i-rl_backward_byte">#rl_backward_byte</a>
    
    <li ><a href="#method-i-rl_backward_char">#rl_backward_char</a>
    
    <li ><a href="#method-i-rl_backward_char_search">#rl_backward_char_search</a>
    
    <li ><a href="#method-i-rl_backward_kill_line">#rl_backward_kill_line</a>
    
    <li ><a href="#method-i-rl_backward_kill_word">#rl_backward_kill_word</a>
    
    <li ><a href="#method-i-rl_backward_word">#rl_backward_word</a>
    
    <li ><a href="#method-i-rl_beg_of_line">#rl_beg_of_line</a>
    
    <li ><a href="#method-i-rl_begin_undo_group">#rl_begin_undo_group</a>
    
    <li ><a href="#method-i-rl_beginning_of_history">#rl_beginning_of_history</a>
    
    <li ><a href="#method-i-rl_bind_key">#rl_bind_key</a>
    
    <li ><a href="#method-i-rl_bind_keyseq_if_unbound">#rl_bind_keyseq_if_unbound</a>
    
    <li ><a href="#method-i-rl_bind_keyseq_if_unbound_in_map">#rl_bind_keyseq_if_unbound_in_map</a>
    
    <li ><a href="#method-i-rl_bind_keyseq_in_map">#rl_bind_keyseq_in_map</a>
    
    <li ><a href="#method-i-rl_capitalize_word">#rl_capitalize_word</a>
    
    <li ><a href="#method-i-rl_change_case">#rl_change_case</a>
    
    <li ><a href="#method-i-rl_char_search">#rl_char_search</a>
    
    <li ><a href="#method-i-rl_character_len">#rl_character_len</a>
    
    <li ><a href="#method-i-rl_cleanup_after_signal">#rl_cleanup_after_signal</a>
    
    <li ><a href="#method-i-rl_clear_message">#rl_clear_message</a>
    
    <li ><a href="#method-i-rl_clear_pending_input">#rl_clear_pending_input</a>
    
    <li ><a href="#method-i-rl_clear_screen">#rl_clear_screen</a>
    
    <li ><a href="#method-i-rl_clear_signals">#rl_clear_signals</a>
    
    <li ><a href="#method-i-rl_complete">#rl_complete</a>
    
    <li ><a href="#method-i-rl_complete_internal">#rl_complete_internal</a>
    
    <li ><a href="#method-i-rl_completion_matches">#rl_completion_matches</a>
    
    <li ><a href="#method-i-rl_copy_text">#rl_copy_text</a>
    
    <li ><a href="#method-i-rl_crlf">#rl_crlf</a>
    
    <li ><a href="#method-i-rl_delete">#rl_delete</a>
    
    <li ><a href="#method-i-rl_delete_horizontal_space">#rl_delete_horizontal_space</a>
    
    <li ><a href="#method-i-rl_delete_or_show_completions">#rl_delete_or_show_completions</a>
    
    <li ><a href="#method-i-rl_delete_text">#rl_delete_text</a>
    
    <li ><a href="#method-i-rl_deprep_terminal">#rl_deprep_terminal</a>
    
    <li ><a href="#method-i-rl_digit_argument">#rl_digit_argument</a>
    
    <li ><a href="#method-i-rl_digit_loop">#rl_digit_loop</a>
    
    <li ><a href="#method-i-rl_ding">#rl_ding</a>
    
    <li ><a href="#method-i-rl_display_match_list">#rl_display_match_list</a>
    
    <li ><a href="#method-i-rl_display_search">#rl_display_search</a>
    
    <li ><a href="#method-i-rl_do_lowercase_version">#rl_do_lowercase_version</a>
    
    <li ><a href="#method-i-rl_do_undo">#rl_do_undo</a>
    
    <li ><a href="#method-i-rl_downcase_word">#rl_downcase_word</a>
    
    <li ><a href="#method-i-rl_emacs_editing_mode">#rl_emacs_editing_mode</a>
    
    <li ><a href="#method-i-rl_end_of_history">#rl_end_of_history</a>
    
    <li ><a href="#method-i-rl_end_of_line">#rl_end_of_line</a>
    
    <li ><a href="#method-i-rl_end_undo_group">#rl_end_undo_group</a>
    
    <li ><a href="#method-i-rl_exchange_point_and_mark">#rl_exchange_point_and_mark</a>
    
    <li ><a href="#method-i-rl_execute_next">#rl_execute_next</a>
    
    <li ><a href="#method-i-rl_expand_prompt">#rl_expand_prompt</a>
    
    <li ><a href="#method-i-rl_extend_line_buffer">#rl_extend_line_buffer</a>
    
    <li ><a href="#method-i-rl_filename_completion_function">#rl_filename_completion_function</a>
    
    <li ><a href="#method-i-rl_forced_update_display">#rl_forced_update_display</a>
    
    <li ><a href="#method-i-rl_forward">#rl_forward</a>
    
    <li ><a href="#method-i-rl_forward_byte">#rl_forward_byte</a>
    
    <li ><a href="#method-i-rl_forward_char">#rl_forward_char</a>
    
    <li ><a href="#method-i-rl_forward_search_history">#rl_forward_search_history</a>
    
    <li ><a href="#method-i-rl_forward_word">#rl_forward_word</a>
    
    <li ><a href="#method-i-rl_free_undo_list">#rl_free_undo_list</a>
    
    <li ><a href="#method-i-rl_function_of_keyseq">#rl_function_of_keyseq</a>
    
    <li ><a href="#method-i-rl_gather_tyi">#rl_gather_tyi</a>
    
    <li ><a href="#method-i-rl_generic_bind">#rl_generic_bind</a>
    
    <li ><a href="#method-i-rl_get_char">#rl_get_char</a>
    
    <li ><a href="#method-i-rl_get_keymap_name_from_edit_mode">#rl_get_keymap_name_from_edit_mode</a>
    
    <li ><a href="#method-i-rl_get_next_history">#rl_get_next_history</a>
    
    <li ><a href="#method-i-rl_get_previous_history">#rl_get_previous_history</a>
    
    <li ><a href="#method-i-rl_getc">#rl_getc</a>
    
    <li ><a href="#method-i-rl_initialize">#rl_initialize</a>
    
    <li ><a href="#method-i-rl_insert">#rl_insert</a>
    
    <li ><a href="#method-i-rl_insert_comment">#rl_insert_comment</a>
    
    <li ><a href="#method-i-rl_insert_completions">#rl_insert_completions</a>
    
    <li ><a href="#method-i-rl_insert_text">#rl_insert_text</a>
    
    <li ><a href="#method-i-rl_isstate">#rl_isstate</a>
    
    <li ><a href="#method-i-rl_kill_full_line">#rl_kill_full_line</a>
    
    <li ><a href="#method-i-rl_kill_line">#rl_kill_line</a>
    
    <li ><a href="#method-i-rl_kill_text">#rl_kill_text</a>
    
    <li ><a href="#method-i-rl_kill_word">#rl_kill_word</a>
    
    <li ><a href="#method-i-rl_line_buffer">#rl_line_buffer</a>
    
    <li ><a href="#method-i-rl_maybe_replace_line">#rl_maybe_replace_line</a>
    
    <li ><a href="#method-i-rl_maybe_save_line">#rl_maybe_save_line</a>
    
    <li ><a href="#method-i-rl_maybe_unsave_line">#rl_maybe_unsave_line</a>
    
    <li ><a href="#method-i-rl_message">#rl_message</a>
    
    <li ><a href="#method-i-rl_modifying">#rl_modifying</a>
    
    <li ><a href="#method-i-rl_named_function">#rl_named_function</a>
    
    <li ><a href="#method-i-rl_newline">#rl_newline</a>
    
    <li ><a href="#method-i-rl_noninc_forward_search">#rl_noninc_forward_search</a>
    
    <li ><a href="#method-i-rl_noninc_reverse_search">#rl_noninc_reverse_search</a>
    
    <li ><a href="#method-i-rl_on_new_line">#rl_on_new_line</a>
    
    <li ><a href="#method-i-rl_on_new_line_with_prompt">#rl_on_new_line_with_prompt</a>
    
    <li ><a href="#method-i-rl_overwrite_mode">#rl_overwrite_mode</a>
    
    <li ><a href="#method-i-rl_parse_and_bind">#rl_parse_and_bind</a>
    
    <li ><a href="#method-i-rl_possible_completions">#rl_possible_completions</a>
    
    <li ><a href="#method-i-rl_prep_terminal">#rl_prep_terminal</a>
    
    <li ><a href="#method-i-rl_quoted_insert">#rl_quoted_insert</a>
    
    <li ><a href="#method-i-rl_re_read_init_file">#rl_re_read_init_file</a>
    
    <li ><a href="#method-i-rl_read_init_file">#rl_read_init_file</a>
    
    <li ><a href="#method-i-rl_read_key">#rl_read_key</a>
    
    <li ><a href="#method-i-rl_redisplay">#rl_redisplay</a>
    
    <li ><a href="#method-i-rl_refresh_line">#rl_refresh_line</a>
    
    <li ><a href="#method-i-rl_replace_from_history">#rl_replace_from_history</a>
    
    <li ><a href="#method-i-rl_replace_line">#rl_replace_line</a>
    
    <li ><a href="#method-i-rl_reset_line_state">#rl_reset_line_state</a>
    
    <li ><a href="#method-i-rl_resize_terminal">#rl_resize_terminal</a>
    
    <li ><a href="#method-i-rl_restart_output">#rl_restart_output</a>
    
    <li ><a href="#method-i-rl_restore_prompt">#rl_restore_prompt</a>
    
    <li ><a href="#method-i-rl_reverse_search_history">#rl_reverse_search_history</a>
    
    <li ><a href="#method-i-rl_revert_line">#rl_revert_line</a>
    
    <li ><a href="#method-i-rl_rubout">#rl_rubout</a>
    
    <li ><a href="#method-i-rl_rubout_or_delete">#rl_rubout_or_delete</a>
    
    <li ><a href="#method-i-rl_save_prompt">#rl_save_prompt</a>
    
    <li ><a href="#method-i-rl_search_history">#rl_search_history</a>
    
    <li ><a href="#method-i-rl_set_keymap_from_edit_mode">#rl_set_keymap_from_edit_mode</a>
    
    <li ><a href="#method-i-rl_set_mark">#rl_set_mark</a>
    
    <li ><a href="#method-i-rl_set_prompt">#rl_set_prompt</a>
    
    <li ><a href="#method-i-rl_set_signals">#rl_set_signals</a>
    
    <li ><a href="#method-i-rl_setstate">#rl_setstate</a>
    
    <li ><a href="#method-i-rl_sigwinch_handler">#rl_sigwinch_handler</a>
    
    <li ><a href="#method-i-rl_stuff_char">#rl_stuff_char</a>
    
    <li ><a href="#method-i-rl_tab_insert">#rl_tab_insert</a>
    
    <li ><a href="#method-i-rl_tilde_expand">#rl_tilde_expand</a>
    
    <li ><a href="#method-i-rl_transpose_chars">#rl_transpose_chars</a>
    
    <li ><a href="#method-i-rl_transpose_words">#rl_transpose_words</a>
    
    <li ><a href="#method-i-rl_tty_set_default_bindings">#rl_tty_set_default_bindings</a>
    
    <li ><a href="#method-i-rl_tty_unset_default_bindings">#rl_tty_unset_default_bindings</a>
    
    <li ><a href="#method-i-rl_undo_command">#rl_undo_command</a>
    
    <li ><a href="#method-i-rl_unix_filename_rubout">#rl_unix_filename_rubout</a>
    
    <li ><a href="#method-i-rl_unix_line_discard">#rl_unix_line_discard</a>
    
    <li ><a href="#method-i-rl_unix_word_rubout">#rl_unix_word_rubout</a>
    
    <li ><a href="#method-i-rl_unsetstate">#rl_unsetstate</a>
    
    <li ><a href="#method-i-rl_upcase_word">#rl_upcase_word</a>
    
    <li ><a href="#method-i-rl_username_completion_function">#rl_username_completion_function</a>
    
    <li ><a href="#method-i-rl_variable_bind">#rl_variable_bind</a>
    
    <li ><a href="#method-i-rl_vi_check">#rl_vi_check</a>
    
    <li ><a href="#method-i-rl_vi_editing_mode">#rl_vi_editing_mode</a>
    
    <li ><a href="#method-i-rl_vi_insertion_mode">#rl_vi_insertion_mode</a>
    
    <li ><a href="#method-i-rl_yank">#rl_yank</a>
    
    <li ><a href="#method-i-rl_yank_last_arg">#rl_yank_last_arg</a>
    
    <li ><a href="#method-i-rl_yank_nth_arg">#rl_yank_nth_arg</a>
    
    <li ><a href="#method-i-rl_yank_nth_arg_internal">#rl_yank_nth_arg_internal</a>
    
    <li ><a href="#method-i-rl_yank_pop">#rl_yank_pop</a>
    
    <li ><a href="#method-i-save_tty_chars">#save_tty_chars</a>
    
    <li ><a href="#method-i-set_completion_defaults">#set_completion_defaults</a>
    
    <li ><a href="#method-i-sh_set_lines_and_columns">#sh_set_lines_and_columns</a>
    
    <li ><a href="#method-i-space_to_eol">#space_to_eol</a>
    
    <li ><a href="#method-i-stat_char">#stat_char</a>
    
    <li ><a href="#method-i-stifle_history">#stifle_history</a>
    
    <li ><a href="#method-i-tgetflag">#tgetflag</a>
    
    <li ><a href="#method-i-trans">#trans</a>
    
    <li ><a href="#method-i-unstifle_history">#unstifle_history</a>
    
    <li ><a href="#method-i-update_line">#update_line</a>
    
    <li ><a href="#method-i-using_history">#using_history</a>
    
    <li ><a href="#method-i-vis_chars">#vis_chars</a>
    
    <li ><a href="#method-i-vis_line">#vis_line</a>
    
    <li ><a href="#method-i-vis_llen">#vis_llen</a>
    
    <li ><a href="#method-i-vis_pos">#vis_pos</a>
    
    <li ><a href="#method-i-w_offset">#w_offset</a>
    
    <li ><a href="#method-i-where_history">#where_history</a>
    
    <li ><a href="#method-i-whitespace">#whitespace</a>
    
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-labelledby="module-RbReadline">
  <h1 id="module-RbReadline" class="module">
    module RbReadline
  </h1>

  <section class="description">
    
  </section>

  
  
  
  <section id="5Buntitled-5D" class="documentation-section">
    

    

    
    <section class="constants-list">
      <header>
        <h3>Constants</h3>
      </header>
      <dl>
      
        <dt id="ABORT_CHAR">ABORT_CHAR
        
        <dd>
        
      
        <dt id="ANCHORED_SEARCH">ANCHORED_SEARCH
        
        <dd><p>Possible definitions for history starting point specification.</p>
        
      
        <dt id="ANYOTHERKEY">ANYOTHERKEY
        
        <dd>
        
      
        <dt id="AUDIBLE_BELL">AUDIBLE_BELL
        
        <dd>
        
      
        <dt id="BAD_MODIFIER">BAD_MODIFIER
        
        <dd>
        
      
        <dt id="BAD_WORD_SPEC">BAD_WORD_SPEC
        
        <dd>
        
      
        <dt id="BFIND">BFIND
        
        <dd>
        
      
        <dt id="BTO">BTO
        
        <dd>
        
      
        <dt id="CapCase">CapCase
        
        <dd>
        
      
        <dt id="DEFAULT_BUFFER_SIZE">DEFAULT_BUFFER_SIZE
        
        <dd>
        
      
        <dt id="DEFAULT_INPUTRC">DEFAULT_INPUTRC
        
        <dd>
        
      
        <dt id="DEFAULT_MAX_KILLS">DEFAULT_MAX_KILLS
        
        <dd>
        
      
        <dt id="DownCase">DownCase
        
        <dd>
        
      
        <dt id="EOF">EOF
        
        <dd>
        
      
        <dt id="ESC">ESC
        
        <dd>
        
      
        <dt id="EVENT_NOT_FOUND">EVENT_NOT_FOUND
        
        <dd><p>Possible history errors passed to hist_error.</p>
        
      
        <dt id="FFIND">FFIND
        
        <dd>
        
      
        <dt id="FTO">FTO
        
        <dd><p>Definitions used when searching the line for characters. NOTE: it is
necessary that opposite directions are inverses</p>
        
      
        <dt id="HISTORY_APPEND">HISTORY_APPEND
        
        <dd><p>Possible definitions for what style of writing the history file we want.</p>
        
      
        <dt id="HISTORY_OVERWRITE">HISTORY_OVERWRITE
        
        <dd>
        
      
        <dt id="HISTORY_QUOTE_CHARACTERS">HISTORY_QUOTE_CHARACTERS
        
        <dd>
        
      
        <dt id="HISTORY_WORD_DELIMITERS">HISTORY_WORD_DELIMITERS
        
        <dd>
        
      
        <dt id="ISFUNC">ISFUNC
        
        <dd>
        
      
        <dt id="ISKMAP">ISKMAP
        
        <dd>
        
      
        <dt id="ISMACR">ISMACR
        
        <dd>
        
      
        <dt id="KEYMAP_SIZE">KEYMAP_SIZE
        
        <dd>
        
      
        <dt id="KEY_EVENT">KEY_EVENT
        
        <dd>
        
      
        <dt id="KSEQ_DISPATCHED">KSEQ_DISPATCHED
        
        <dd><p>A context for reading key sequences longer than a single character when</p>

<pre>using the callback interface.</pre>
        
      
        <dt id="KSEQ_RECURSIVE">KSEQ_RECURSIVE
        
        <dd>
        
      
        <dt id="KSEQ_SUBSEQ">KSEQ_SUBSEQ
        
        <dd>
        
      
        <dt id="LEFT_ALT_PRESSED">LEFT_ALT_PRESSED
        
        <dd>
        
      
        <dt id="LEFT_CTRL_PRESSED">LEFT_CTRL_PRESSED
        
        <dd>
        
      
        <dt id="MB_FIND_ANY">MB_FIND_ANY
        
        <dd>
        
      
        <dt id="MB_FIND_NONZERO">MB_FIND_NONZERO
        
        <dd>
        
      
        <dt id="MB_LEN_MAX">MB_LEN_MAX
        
        <dd>
        
      
        <dt id="MULT_MATCH">MULT_MATCH
        
        <dd>
        
      
        <dt id="NEWLINE">NEWLINE
        
        <dd>
        
      
        <dt id="NON_ANCHORED_SEARCH">NON_ANCHORED_SEARCH
        
        <dd>
        
      
        <dt id="NO_BELL">NO_BELL
        
        <dd>
        
      
        <dt id="NO_MATCH">NO_MATCH
        
        <dd><p>Possible values for do_replace argument to rl_filename_quoting_function,</p>

<pre>called by rl_complete_internal.</pre>
        
      
        <dt id="NO_PREV_SUBST">NO_PREV_SUBST
        
        <dd>
        
      
        <dt id="NUM_READONE">NUM_READONE
        
        <dd>
        
      
        <dt id="NUM_SAWDIGITS">NUM_SAWDIGITS
        
        <dd>
        
      
        <dt id="NUM_SAWMINUS">NUM_SAWMINUS
        
        <dd><p>Callback data for reading numeric arguments</p>
        
      
        <dt id="PAGE">PAGE
        
        <dd>
        
      
        <dt id="RB_READLINE_VERSION">RB_READLINE_VERSION
        
        <dd>
        
      
        <dt id="READERR">READERR
        
        <dd><p>Input error; can be returned by (*rl_getc_function) if readline is reading</p>

<pre>a top-level command (RL_ISSTATE (RL_STATE_READCMD)).</pre>
        
      
        <dt id="RETURN">RETURN
        
        <dd>
        
      
        <dt id="RIGHT_ALT_PRESSED">RIGHT_ALT_PRESSED
        
        <dd>
        
      
        <dt id="RIGHT_CTRL_PRESSED">RIGHT_CTRL_PRESSED
        
        <dd>
        
      
        <dt id="RL_IM_DEFAULT">RL_IM_DEFAULT
        
        <dd>
        
      
        <dt id="RL_IM_INSERT">RL_IM_INSERT
        
        <dd>
        
      
        <dt id="RL_IM_OVERWRITE">RL_IM_OVERWRITE
        
        <dd>
        
      
        <dt id="RL_LIBRARY_VERSION">RL_LIBRARY_VERSION
        
        <dd>
        
      
        <dt id="RL_PROMPT_END_IGNORE">RL_PROMPT_END_IGNORE
        
        <dd>
        
      
        <dt id="RL_PROMPT_START_IGNORE">RL_PROMPT_START_IGNORE
        
        <dd><p>Definitions available for use by readline clients.</p>
        
      
        <dt id="RL_QF_BACKSLASH">RL_QF_BACKSLASH
        
        <dd>
        
      
        <dt id="RL_QF_DOUBLE_QUOTE">RL_QF_DOUBLE_QUOTE
        
        <dd>
        
      
        <dt id="RL_QF_OTHER_QUOTE">RL_QF_OTHER_QUOTE
        
        <dd>
        
      
        <dt id="RL_QF_SINGLE_QUOTE">RL_QF_SINGLE_QUOTE
        
        <dd><p>Possible values for the found_quote flags word used by the completion</p>

<pre>functions.  It says what kind of (shell-like) quoting we found anywhere
in the line.</pre>
        
      
        <dt id="RL_READLINE_VERSION">RL_READLINE_VERSION
        
        <dd>
        
      
        <dt id="RL_SEARCH_CSEARCH">RL_SEARCH_CSEARCH
        
        <dd>
        
      
        <dt id="RL_SEARCH_ISEARCH">RL_SEARCH_ISEARCH
        
        <dd>
        
      
        <dt id="RL_SEARCH_NSEARCH">RL_SEARCH_NSEARCH
        
        <dd>
        
      
        <dt id="RL_STATE_CALLBACK">RL_STATE_CALLBACK
        
        <dd>
        
      
        <dt id="RL_STATE_COMPLETING">RL_STATE_COMPLETING
        
        <dd>
        
      
        <dt id="RL_STATE_DISPATCHING">RL_STATE_DISPATCHING
        
        <dd>
        
      
        <dt id="RL_STATE_DONE">RL_STATE_DONE
        
        <dd>
        
      
        <dt id="RL_STATE_INITIALIZED">RL_STATE_INITIALIZED
        
        <dd>
        
      
        <dt id="RL_STATE_INITIALIZING">RL_STATE_INITIALIZING
        
        <dd>
        
      
        <dt id="RL_STATE_INPUTPENDING">RL_STATE_INPUTPENDING
        
        <dd>
        
      
        <dt id="RL_STATE_ISEARCH">RL_STATE_ISEARCH
        
        <dd>
        
      
        <dt id="RL_STATE_MACRODEF">RL_STATE_MACRODEF
        
        <dd>
        
      
        <dt id="RL_STATE_MACROINPUT">RL_STATE_MACROINPUT
        
        <dd>
        
      
        <dt id="RL_STATE_METANEXT">RL_STATE_METANEXT
        
        <dd>
        
      
        <dt id="RL_STATE_MOREINPUT">RL_STATE_MOREINPUT
        
        <dd>
        
      
        <dt id="RL_STATE_MULTIKEY">RL_STATE_MULTIKEY
        
        <dd>
        
      
        <dt id="RL_STATE_NONE">RL_STATE_NONE
        
        <dd><p>Possible state values for rl_readline_state</p>
        
      
        <dt id="RL_STATE_NSEARCH">RL_STATE_NSEARCH
        
        <dd>
        
      
        <dt id="RL_STATE_NUMERICARG">RL_STATE_NUMERICARG
        
        <dd>
        
      
        <dt id="RL_STATE_OVERWRITE">RL_STATE_OVERWRITE
        
        <dd>
        
      
        <dt id="RL_STATE_READCMD">RL_STATE_READCMD
        
        <dd>
        
      
        <dt id="RL_STATE_SEARCH">RL_STATE_SEARCH
        
        <dd>
        
      
        <dt id="RL_STATE_SIGHANDLER">RL_STATE_SIGHANDLER
        
        <dd>
        
      
        <dt id="RL_STATE_TERMPREPPED">RL_STATE_TERMPREPPED
        
        <dd>
        
      
        <dt id="RL_STATE_TTYCSAVED">RL_STATE_TTYCSAVED
        
        <dd>
        
      
        <dt id="RL_STATE_UNDOING">RL_STATE_UNDOING
        
        <dd>
        
      
        <dt id="RL_STATE_VICMDONCE">RL_STATE_VICMDONCE
        
        <dd>
        
      
        <dt id="RL_STATE_VIMOTION">RL_STATE_VIMOTION
        
        <dd>
        
      
        <dt id="RUBOUT">RUBOUT
        
        <dd>
        
      
        <dt id="SF_FAILED">SF_FAILED
        
        <dd>
        
      
        <dt id="SF_FOUND">SF_FOUND
        
        <dd>
        
      
        <dt id="SF_REVERSE">SF_REVERSE
        
        <dd><p>search flags</p>
        
      
        <dt id="SINGLE_MATCH">SINGLE_MATCH
        
        <dd>
        
      
        <dt id="SPACE">SPACE
        
        <dd>
        
      
        <dt id="STD_INPUT_HANDLE">STD_INPUT_HANDLE
        
        <dd>
        
      
        <dt id="STD_OUTPUT_HANDLE">STD_OUTPUT_HANDLE
        
        <dd>
        
      
        <dt id="SUBST_FAILED">SUBST_FAILED
        
        <dd>
        
      
        <dt id="SYS_INPUTRC">SYS_INPUTRC
        
        <dd>
        
      
        <dt id="TAB">TAB
        
        <dd>
        
      
        <dt id="UNDO_END">UNDO_END
        
        <dd>
        
      
        <dt id="UpCase">UpCase
        
        <dd>
        
      
        <dt id="VISIBLE_BELL">VISIBLE_BELL
        
        <dd>
        
      
        <dt id="VK_LMENU">VK_LMENU
        
        <dd>
        
      
        <dt id="VK_MENU">VK_MENU
        
        <dd>
        
      
        <dt id="VK_RMENU">VK_RMENU
        
        <dd>
        
      
        <dt id="VK_SHIFT">VK_SHIFT
        
        <dd>
        
      
        <dt id="XOK">XOK
        
        <dd>
        
      
      </dl>
    </section>
    

    
    <section class="attribute-method-details" class="method-section">
      <header>
        <h3>Attributes</h3>
      </header>

      
      <div id="attribute-c-history_base" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">history_base</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-history_length" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">history_length</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_attempted_completion_function" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_attempted_completion_function</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_attempted_completion_over" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_attempted_completion_over</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_basic_quote_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_basic_quote_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_basic_word_break_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_basic_word_break_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_completer_quote_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_completer_quote_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_completer_word_break_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_completer_word_break_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_completion_append_character" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_completion_append_character</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_deprep_term_function" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_deprep_term_function</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_event_hook" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_event_hook</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_filename_quote_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_filename_quote_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_instream" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_instream</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_library_version" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_library_version</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_outstream" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_outstream</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_point" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_point</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-c-rl_readline_name" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_readline_name</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-history_base" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">history_base</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-history_length" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">history_length</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_attempted_completion_function" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_attempted_completion_function</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_attempted_completion_over" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_attempted_completion_over</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_basic_quote_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_basic_quote_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_basic_word_break_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_basic_word_break_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_completer_quote_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_completer_quote_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_completer_word_break_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_completer_word_break_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_completion_append_character" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_completion_append_character</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_deprep_term_function" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_deprep_term_function</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_event_hook" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_event_hook</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_filename_quote_characters" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_filename_quote_characters</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_instream" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_instream</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_library_version" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_library_version</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_outstream" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_outstream</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_point" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_point</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
      <div id="attribute-i-rl_readline_name" class="method-detail">
        <div class="method-heading attribute-method-heading">
          <span class="method-name">rl_readline_name</span><span
            class="attribute-access-type">[RW]</span>
        </div>

        <div class="method-description">
        
        
        
        </div>
      </div>
      
    </section>
    

    
     <section id="public-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Public Instance Methods</h3>
       </header>

    
      <div id="method-i-__rl_fix_point" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">__rl_fix_point</span><span
            class="method-args">(x)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Fix up point so that it is within the line boundaries after killing</p>

<pre>text.  If FIX_MARK_TOO is non-zero, the mark is forced within line
boundaries also.</pre>
          
          

          
          <div class="method-source-code" id="__rl_fix_point-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4938</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">__rl_fix_point</span>(<span class="ruby-identifier">x</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">x</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">x</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-value">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">x</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_extract_last_quote" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_extract_last_quote</span><span
            class="method-args">(string, quote_char)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_extract_last_quote-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7550</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_extract_last_quote</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">quote_char</span>)
  <span class="ruby-identifier">quote_char</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">quote_char</span>)
  <span class="ruby-identifier">string</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/(#{quote_char}(?:\.|[^#{quote_char}])+?#{quote_char}) *$/</span>
  <span class="ruby-node">$1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_abort_internal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_abort_internal</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>How to abort things.</p>
          
          

          
          <div class="method-source-code" id="_rl_abort_internal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4743</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_abort_internal</span>()
  <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-identifier">rl_clear_message</span>()
  <span class="ruby-identifier">_rl_reset_argument</span>()
  <span class="ruby-identifier">rl_clear_pending_input</span>()

  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MACRODEF</span>)

  <span class="ruby-ivar">@rl_last_func</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-comment">#throw :readline_top_level</span>
  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-ivar">@_rl_want_redisplay</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_adjust_point" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_adjust_point</span><span
            class="method-args">(string, point)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>adjust pointed byte and find mbstate of the point of string.</p>

<pre>adjusted point will be point &lt;= adjusted_point, and returns
differences of the byte(adjusted_point - point).
if point is invalied (point &lt; 0 || more than string length),
it returns -1</pre>
          
          

          
          <div class="method-source-code" id="_rl_adjust_point-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8561</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_adjust_point</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">point</span>)

  <span class="ruby-identifier">length</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span>)

  <span class="ruby-identifier">pos</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">x</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)
    <span class="ruby-identifier">i</span>, <span class="ruby-identifier">len</span> = <span class="ruby-value">0</span>, <span class="ruby-identifier">x</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">len</span>)
      <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">length</span>
      <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">x</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)
    <span class="ruby-identifier">i</span>, <span class="ruby-identifier">len</span> = <span class="ruby-value">0</span>, <span class="ruby-identifier">x</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">len</span>)
      <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">length</span>
      <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">x</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)
    <span class="ruby-identifier">i</span>, <span class="ruby-identifier">len</span> = <span class="ruby-value">0</span>, <span class="ruby-identifier">x</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">len</span>)
      <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">x</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">length</span>
      <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">enc</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">encoding</span>
    <span class="ruby-identifier">str</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">length</span> <span class="ruby-operator">/</span> <span class="ruby-value">2</span>
      <span class="ruby-comment"># count byte size from head</span>
      <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">len</span>)
        <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">bytesize</span>
        <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># count byte size from tail</span>
      <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">bytesize</span>
      <span class="ruby-identifier">i</span> = <span class="ruby-identifier">len</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">pos</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">bytesize</span>
        <span class="ruby-identifier">i</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">i</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>].<span class="ruby-identifier">bytesize</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">string</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-identifier">enc</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">point</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">point</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_any_typein" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_any_typein</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_any_typein-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5508</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_any_typein</span>()
  <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@push_index</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@pop_index</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_arg_dispatch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_arg_dispatch</span><span
            class="method-args">(cxt, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process C as part of the current numeric argument.  Return -1 if the</p>

<pre>argument should be aborted, 0 if we should not read any more chars, and
1 if we should continue to read chars.</pre>
          
          

          
          <div class="method-source-code" id="_rl_arg_dispatch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7753</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_arg_dispatch</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">key</span> = <span class="ruby-identifier">c</span>

  <span class="ruby-comment"># If we see a key bound to `universal-argument&#39; after seeing digits,</span>
  <span class="ruby-comment">#    it ends the argument but is otherwise ignored.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_keymap</span>[<span class="ruby-identifier">c</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:rl_universal_argument</span>)
    <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">cxt</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">NUM_SAWDIGITS</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@rl_numeric_arg</span> <span class="ruby-operator">*=</span> <span class="ruby-value">4</span>
      <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_CALLBACK</span>))
      <span class="ruby-ivar">@_rl_argcxt</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">NUM_READONE</span>
      <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-comment"># XXX</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
      <span class="ruby-identifier">key</span> = <span class="ruby-identifier">rl_read_key</span>()
      <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
      <span class="ruby-identifier">rl_restore_prompt</span>()
      <span class="ruby-identifier">rl_clear_message</span>()
      <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_NUMERICARG</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
        <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_dispatch</span>(<span class="ruby-identifier">key</span>, <span class="ruby-ivar">@_rl_keymap</span>))
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment">#c = (c[0].ord &amp; ~0x80).chr</span>
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">c</span>[<span class="ruby-value">1</span>,<span class="ruby-value">1</span>]
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">r</span><span class="ruby-operator">&gt;=</span><span class="ruby-string">&#39;0&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">r</span><span class="ruby-operator">&lt;=</span><span class="ruby-string">&#39;9&#39;</span>)
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">to_i</span>
    <span class="ruby-ivar">@rl_numeric_arg</span> = <span class="ruby-ivar">@rl_explicit_arg</span> <span class="ruby-operator">?</span> (<span class="ruby-ivar">@rl_numeric_arg</span> <span class="ruby-operator">*</span> <span class="ruby-value">10</span>) <span class="ruby-operator">+</span>  <span class="ruby-identifier">r</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">r</span>
    <span class="ruby-ivar">@rl_explicit_arg</span> = <span class="ruby-value">1</span>
    <span class="ruby-ivar">@_rl_argcxt</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">NUM_SAWDIGITS</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;-&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-ivar">@rl_numeric_arg</span> = <span class="ruby-value">1</span>
    <span class="ruby-ivar">@_rl_argcxt</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">NUM_SAWMINUS</span>
    <span class="ruby-ivar">@rl_arg_sign</span> = <span class="ruby-value">-1</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Make M-- command equivalent to M--1 command.</span>
    <span class="ruby-keyword">if</span> ((<span class="ruby-ivar">@_rl_argcxt</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">NUM_SAWMINUS</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_numeric_arg</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_explicit_arg</span>)
      <span class="ruby-ivar">@rl_explicit_arg</span> = <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">rl_restore_prompt</span>()
    <span class="ruby-identifier">rl_clear_message</span>()
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_NUMERICARG</span>)

    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">_rl_dispatch</span>(<span class="ruby-identifier">key</span>, <span class="ruby-ivar">@_rl_keymap</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_CALLBACK</span>))
      <span class="ruby-comment"># At worst, this will cause an extra redisplay.  Otherwise,</span>
      <span class="ruby-comment">#   we have to wait until the next character comes in.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_done</span>)
        <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">r</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">r</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_arg_getchar" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_arg_getchar</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_arg_getchar-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7742</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_arg_getchar</span>()
  <span class="ruby-identifier">rl_message</span>(<span class="ruby-node">&quot;(arg: #{@rl_arg_sign * @rl_numeric_arg}) &quot;</span>)
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">rl_read_key</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-identifier">c</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_arg_init" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_arg_init</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_arg_init-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7736</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_arg_init</span>()
  <span class="ruby-identifier">rl_save_prompt</span>()
  <span class="ruby-ivar">@_rl_argcxt</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_NUMERICARG</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_arg_overflow" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_arg_overflow</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_arg_overflow-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7813</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_arg_overflow</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_numeric_arg</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1000000</span>)
    <span class="ruby-ivar">@_rl_argcxt</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@rl_explicit_arg</span> = <span class="ruby-ivar">@rl_numeric_arg</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">rl_restore_prompt</span>()
    <span class="ruby-identifier">rl_clear_message</span>()
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_NUMERICARG</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_backspace" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_backspace</span><span
            class="method-args">(count)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move the cursor back.</p>
          
          

          
          <div class="method-source-code" id="_rl_backspace-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4628</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_backspace</span>(<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_backspace</span>)
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_backspace</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;\b&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_bind_tty_special_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_bind_tty_special_chars</span><span
            class="method-args">(kmap)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_bind_tty_special_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6939</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_bind_tty_special_chars</span>(<span class="ruby-identifier">kmap</span>)
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_erase</span>] = <span class="ruby-value">:rl_rubout</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_kill</span>] = <span class="ruby-value">:rl_unix_line_discard</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_werase</span>] = <span class="ruby-value">:rl_unix_word_rubout</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_lnext</span>] = <span class="ruby-value">:rl_quoted_insert</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_char_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_char_search</span><span
            class="method-args">(count, fdir, bdir)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_char_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7583</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_char_search</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">fdir</span>, <span class="ruby-identifier">bdir</span>)
  <span class="ruby-identifier">mbchar</span> = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-identifier">mb_len</span> = <span class="ruby-identifier">_rl_read_mbchar</span>(<span class="ruby-identifier">mbchar</span>, <span class="ruby-constant">MB_LEN_MAX</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">mbchar</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">mbchar</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_char_search_internal</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">bdir</span>, <span class="ruby-identifier">mbchar</span>, <span class="ruby-identifier">mb_len</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_char_search_internal</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">fdir</span>, <span class="ruby-identifier">mbchar</span>, <span class="ruby-identifier">mb_len</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_char_search_internal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_char_search_internal</span><span
            class="method-args">(count, dir, smbchar, len)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_char_search_internal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7556</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_char_search_internal</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">smbchar</span>, <span class="ruby-identifier">len</span>)
  <span class="ruby-identifier">pos</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">inc</span> = (<span class="ruby-identifier">dir</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-value">-1</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count!</span>=<span class="ruby-value">0</span>)
    <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">dir</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">dir</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_end</span>))
      <span class="ruby-identifier">rl_ding</span>()
      <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">pos</span> = (<span class="ruby-identifier">inc</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>) <span class="ruby-operator">:</span>
      <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
    <span class="ruby-keyword">begin</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_is_mbchar_matched</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-ivar">@rl_end</span>, <span class="ruby-identifier">smbchar</span>, <span class="ruby-identifier">len</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
        <span class="ruby-identifier">count</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">dir</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
          <span class="ruby-ivar">@rl_point</span> = (<span class="ruby-identifier">dir</span> <span class="ruby-operator">==</span> <span class="ruby-constant">BTO</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">pos</span><span class="ruby-operator">+</span><span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">pos</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@rl_point</span> = (<span class="ruby-identifier">dir</span> <span class="ruby-operator">==</span> <span class="ruby-constant">FTO</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">pos</span><span class="ruby-operator">-</span><span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">pos</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">prepos</span> = <span class="ruby-identifier">pos</span>
    <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span> ((<span class="ruby-identifier">dir</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> (<span class="ruby-identifier">pos</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-constant">MB_FIND_ANY</span>)) <span class="ruby-operator">!=</span> <span class="ruby-identifier">prepos</span> <span class="ruby-operator">:</span>
               (<span class="ruby-identifier">pos</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>)) <span class="ruby-operator">!=</span> <span class="ruby-identifier">prepos</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_char_value" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_char_value</span><span
            class="method-args">(buf,ind)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_char_value-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5150</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-identifier">buf</span>,<span class="ruby-identifier">ind</span>)
  <span class="ruby-identifier">buf</span>[<span class="ruby-identifier">ind</span>,<span class="ruby-value">1</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_clean_up_for_exit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_clean_up_for_exit</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_clean_up_for_exit-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1516</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_clean_up_for_exit</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@readline_echoing_p</span>
    <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-ivar">@_rl_vis_botlin</span>)
    <span class="ruby-ivar">@_rl_vis_botlin</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>
    <span class="ruby-identifier">rl_restart_output</span>(<span class="ruby-value">1</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_clear_screen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_clear_screen</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_clear_screen-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4619</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_clear_screen</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_clrpag</span>)
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_clrpag</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_crlf</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_clear_to_eol" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_clear_to_eol</span><span
            class="method-args">(count)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clear to the end of the line.  COUNT is the minimum</p>

<pre>number of character spaces to clear,</pre>
          
          

          
          <div class="method-source-code" id="_rl_clear_to_eol-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4596</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_clreol</span>)
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_clreol</span>)
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">count!</span>=<span class="ruby-value">0</span>)
    <span class="ruby-identifier">space_to_eol</span>(<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_col_width" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_col_width</span><span
            class="method-args">(string,start,_end)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_col_width-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3834</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">string</span>,<span class="ruby-identifier">start</span>,<span class="ruby-identifier">_end</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">_end</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">start</span>

  <span class="ruby-comment"># Find the first occurance of 0.chr, which marks the end of the string.</span>
  <span class="ruby-comment"># Because newlines are also in the string as 0.chrs (they are tracked</span>
  <span class="ruby-comment"># seperately), we need to ignore any 0.chrs that lie before _end.</span>
  <span class="ruby-identifier">index</span> = <span class="ruby-identifier">string</span>[<span class="ruby-identifier">_end</span><span class="ruby-operator">...</span><span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span>].<span class="ruby-identifier">index</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)

  <span class="ruby-identifier">str</span> = <span class="ruby-identifier">index</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">index</span><span class="ruby-operator">+</span><span class="ruby-identifier">_end</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">string</span>
  <span class="ruby-identifier">width</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;N&#39;</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">str</span>[<span class="ruby-identifier">start</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">_end</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;U&#39;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span> }
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">str</span>[<span class="ruby-identifier">start</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">_end</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span> }
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">str</span>[<span class="ruby-identifier">start</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">_end</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>).<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span> }
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">str</span>[<span class="ruby-identifier">start</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">_end</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>).<span class="ruby-identifier">codepoints</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">width</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span> }
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">width</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_compare_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_compare_chars</span><span
            class="method-args">(buf1, pos1, buf2, pos2)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>compare the specified two characters. If the characters matched,</p>

<pre>return true. Otherwise return false.</pre>
          
          

          
          <div class="method-source-code" id="_rl_compare_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8681</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_compare_chars</span>(<span class="ruby-identifier">buf1</span>, <span class="ruby-identifier">pos1</span>, <span class="ruby-identifier">buf2</span>, <span class="ruby-identifier">pos2</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">buf1</span>[<span class="ruby-identifier">pos1</span>].<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">buf2</span>[<span class="ruby-identifier">pos2</span>].<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">buf1</span>[<span class="ruby-identifier">pos1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">buf2</span>[<span class="ruby-identifier">pos2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">buf1</span>[<span class="ruby-identifier">pos1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">buf2</span>[<span class="ruby-identifier">pos2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">buf1</span>[<span class="ruby-identifier">pos1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">buf2</span>[<span class="ruby-identifier">pos2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">buf1</span>[<span class="ruby-identifier">pos1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">buf2</span>[<span class="ruby-identifier">pos2</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>]
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">buf1</span>[<span class="ruby-identifier">pos1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">buf2</span>[<span class="ruby-identifier">pos2</span>]
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_control_keypad" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_control_keypad</span><span
            class="method-args">(on)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_control_keypad-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6976</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_control_keypad</span>(<span class="ruby-identifier">on</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">on</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_ks</span>
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_ks</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span><span class="ruby-identifier">on</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_ke</span>
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_ke</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_copy_to_kill_ring" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_copy_to_kill_ring</span><span
            class="method-args">(text, append)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add TEXT to the kill ring, allocating a new kill ring slot as necessary.</p>

<pre>This uses TEXT directly, so the caller must not free it.  If APPEND is
non-zero, and the last command was a kill, the text is appended to the
current kill ring slot, otherwise prepended.</pre>
          
          

          
          <div class="method-source-code" id="_rl_copy_to_kill_ring-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5881</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_copy_to_kill_ring</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">append</span>)
  <span class="ruby-comment"># First, find the slot to work with.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_last_command_was_kill</span>)
    <span class="ruby-comment"># Get a new slot.</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_kill_ring</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-comment"># If we don&#39;t have any defined, then make one.</span>
      <span class="ruby-ivar">@rl_kill_ring_length</span> = <span class="ruby-value">1</span>
      <span class="ruby-ivar">@rl_kill_ring</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@rl_kill_ring_length</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)
      <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-identifier">slot</span> = <span class="ruby-value">0</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># We have to add a new slot on the end, unless we have</span>
      <span class="ruby-comment">#   exceeded the max limit for remembering kills.</span>
      <span class="ruby-identifier">slot</span> = <span class="ruby-ivar">@rl_kill_ring_length</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">slot</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_max_kills</span>)
        <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">slot</span>] = <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-value">1</span>,<span class="ruby-identifier">slot</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">slot</span> = <span class="ruby-ivar">@rl_kill_ring_length</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-identifier">slot</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">slot</span> = <span class="ruby-ivar">@rl_kill_ring_length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If the last command was a kill, prepend or append.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_last_command_was_kill</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-identifier">old</span> = <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-identifier">slot</span>]

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">append</span>)
      <span class="ruby-identifier">new</span> = <span class="ruby-identifier">old</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">text</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">new</span> = <span class="ruby-identifier">text</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">old</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">old</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">text</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-identifier">slot</span>] = <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-identifier">slot</span>] = <span class="ruby-identifier">text</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@rl_kill_index</span> = <span class="ruby-identifier">slot</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_current_display_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_current_display_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>return the `current display line&#39; of the cursor  the number of lines
to</p>

<pre>move up to get to the first screen line of the current readline line.</pre>
          
          

          
          <div class="method-source-code" id="_rl_current_display_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5264</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_current_display_line</span>()
  <span class="ruby-comment"># Find out whether or not there might be invisible characters in the</span>
  <span class="ruby-comment">#   editing buffer.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_display_prompt</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_prompt</span>)
    <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@rl_visible_prompt_length</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@_rl_screenwidth</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">nleft</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">ret</span> = <span class="ruby-value">1</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">nleft</span> <span class="ruby-operator">/</span> <span class="ruby-ivar">@_rl_screenwidth</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ret</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_dispatch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_dispatch</span><span
            class="method-args">(key, map)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Do the command associated with KEY in MAP.</p>

<pre>If the associated command is really a keymap, then read
another key, and dispatch into that map.</pre>
          
          

          
          <div class="method-source-code" id="_rl_dispatch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4308</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_dispatch</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">map</span>)
  <span class="ruby-ivar">@_rl_dispatching_keymap</span> = <span class="ruby-identifier">map</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">_rl_dispatch_subseq</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">map</span>, <span class="ruby-keyword">false</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_dispatch_subseq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_dispatch_subseq</span><span
            class="method-args">(key, map, got_subseq)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_dispatch_subseq-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4314</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_dispatch_subseq</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">map</span>, <span class="ruby-identifier">got_subseq</span>)
  <span class="ruby-identifier">func</span> = <span class="ruby-identifier">map</span>[<span class="ruby-identifier">key</span>]
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">func</span>)
    <span class="ruby-ivar">@rl_executing_keymap</span> = <span class="ruby-identifier">map</span>

    <span class="ruby-ivar">@rl_dispatching</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_DISPATCHING</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-identifier">map</span>[<span class="ruby-identifier">key</span>],<span class="ruby-ivar">@rl_numeric_arg</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@rl_arg_sign</span>, <span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_DISPATCHING</span>)
    <span class="ruby-ivar">@rl_dispatching</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_pending_input</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">map</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">:rl_digit_argument</span>)
      <span class="ruby-ivar">@rl_last_func</span> = <span class="ruby-identifier">map</span>[<span class="ruby-identifier">key</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span>(<span class="ruby-identifier">map</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">detect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^#{Regexp.escape(key)}/</span>})
      <span class="ruby-identifier">key</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">_rl_subseq_getchar</span>(<span class="ruby-identifier">key</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-identifier">_rl_dispatch_subseq</span>(<span class="ruby-identifier">key</span>,<span class="ruby-identifier">map</span>,<span class="ruby-identifier">got_subseq</span>)
    <span class="ruby-keyword">elsif</span>(<span class="ruby-identifier">key</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">ord</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0x7f</span>)
      <span class="ruby-identifier">_rl_abort_internal</span>()
      <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_dispatching</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_DISPATCHING</span>)
      <span class="ruby-identifier">send</span>(<span class="ruby-value">:rl_insert</span>,<span class="ruby-ivar">@rl_numeric_arg</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@rl_arg_sign</span>, <span class="ruby-identifier">key</span>)
      <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_DISPATCHING</span>)
      <span class="ruby-ivar">@rl_dispatching</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_enable_meta_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_enable_meta_key</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_enable_meta_key-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2425</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_enable_meta_key</span>()
  <span class="ruby-keyword">if</span>(<span class="ruby-ivar">@term_has_meta</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_mm</span>)
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_mm</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_erase_at_end_of_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_erase_at_end_of_line</span><span
            class="method-args">(l)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Quick redisplay hack when erasing characters at the end of the line.</p>
          
          

          
          <div class="method-source-code" id="_rl_erase_at_end_of_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5809</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_erase_at_end_of_line</span>(<span class="ruby-identifier">l</span>)
  <span class="ruby-identifier">_rl_backspace</span>(<span class="ruby-identifier">l</span>)
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39; &#39;</span><span class="ruby-operator">*</span><span class="ruby-identifier">l</span>)
  <span class="ruby-identifier">_rl_backspace</span>(<span class="ruby-identifier">l</span>)
  <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">l</span>
  <span class="ruby-ivar">@visible_line</span>[<span class="ruby-ivar">@_rl_last_c_pos</span>,<span class="ruby-identifier">l</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">l</span>
  <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_display_fixed</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_erase_entire_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_erase_entire_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_erase_entire_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4654</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_erase_entire_line</span>()
  <span class="ruby-identifier">cr</span>()
  <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-value">0</span>)
  <span class="ruby-identifier">cr</span>()
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_find_completion_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_find_completion_word</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_find_completion_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6137</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_find_completion_word</span>()
  <span class="ruby-identifier">_end</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">found_quote</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">delimiter</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-identifier">quote_char</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>

  <span class="ruby-identifier">brkchars</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_completion_word_break_hook</span>
    <span class="ruby-identifier">brkchars</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_completion_word_break_hook</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">brkchars</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">brkchars</span> = <span class="ruby-ivar">@rl_completer_word_break_characters</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_completer_quote_characters</span>)
    <span class="ruby-comment"># We have a list of characters which can be used in pairs to</span>
    <span class="ruby-comment"># quote substrings for the completer.  Try to find the start</span>
    <span class="ruby-comment"># of an unclosed quoted substring.</span>
    <span class="ruby-comment"># FOUND_QUOTE is set so we know what kind of quotes we found.</span>
    <span class="ruby-identifier">scan</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">pass_next</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">while</span> <span class="ruby-identifier">scan</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">_end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-identifier">scan</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">scan</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">scan</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">pass_next</span>)
        <span class="ruby-identifier">pass_next</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Shell-like semantics for single quotes -- don&#39;t allow backslash</span>
      <span class="ruby-comment">#   to quote anything in single quotes, especially not the closing</span>
      <span class="ruby-comment">#   quote.  If you don&#39;t like this, take out the check on the value</span>
      <span class="ruby-comment">#   of quote_char.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">quote_char</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;&#39;&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">scan</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\\&quot;</span>)
        <span class="ruby-identifier">pass_next</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-identifier">found_quote</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">RL_QF_BACKSLASH</span>
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">quote_char</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
        <span class="ruby-comment"># Ignore everything until the matching close quote char.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">scan</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">quote_char</span>)
          <span class="ruby-comment"># Found matching close.  Abandon this substring.</span>
          <span class="ruby-identifier">quote_char</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
          <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_end</span>
        <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_completer_quote_characters</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">scan</span>,<span class="ruby-value">1</span>]))

        <span class="ruby-comment"># Found start of a quoted substring.</span>
        <span class="ruby-identifier">quote_char</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">scan</span>,<span class="ruby-value">1</span>]
        <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">scan</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
        <span class="ruby-comment"># Shell-like quoting conventions.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">quote_char</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;&#39;&quot;</span>)
          <span class="ruby-identifier">found_quote</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">RL_QF_SINGLE_QUOTE</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">quote_char</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&quot;&#39;</span>)
          <span class="ruby-identifier">found_quote</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">RL_QF_DOUBLE_QUOTE</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">found_quote</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">RL_QF_OTHER_QUOTE</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">_end</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">quote_char</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)

    <span class="ruby-comment"># We didn&#39;t find an unclosed quoted substring upon which to do</span>
    <span class="ruby-comment">#   completion, so use the word break characters to find the</span>
    <span class="ruby-comment">#   substring on which to complete.</span>


    <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span> =  <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">?</span>
           <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_ANY</span>)<span class="ruby-operator">:</span>(<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>))<span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>

      <span class="ruby-identifier">scan</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">1</span>]
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">brkchars</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">scan</span>)
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># Call the application-specific function to tell us whether</span>
      <span class="ruby-comment">#   this word break character is quoted and should be skipped.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_char_is_quoted_p</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">found_quote!</span>=<span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_char_is_quoted_p</span>,<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>))
        <span class="ruby-keyword">next</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Convoluted code, but it avoids an n^2 algorithm with calls</span>
      <span class="ruby-comment">#   to char_is_quoted.</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we are at an unquoted word break, then advance past it.</span>
  <span class="ruby-identifier">scan</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">1</span>]

  <span class="ruby-comment"># If there is an application-specific function to say whether or not</span>
  <span class="ruby-comment">#   a character is quoted and we found a quote character, let that</span>
  <span class="ruby-comment">#   function decide whether or not a character is a word break, even</span>
  <span class="ruby-comment">#   if it is found in rl_completer_word_break_characters.  Don&#39;t bother</span>
  <span class="ruby-comment">#   if we&#39;re at the end of the line, though.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">scan</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_char_is_quoted_p</span>)
      <span class="ruby-identifier">isbrk</span> = (<span class="ruby-identifier">found_quote</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span>
               <span class="ruby-operator">!</span><span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_char_is_quoted_p</span>,<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>)) <span class="ruby-operator">&amp;&amp;</span>
               <span class="ruby-identifier">brkchars</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">scan</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">isbrk</span> = <span class="ruby-identifier">brkchars</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">scan</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">isbrk</span>)
      <span class="ruby-comment"># If the character that caused the word break was a quoting</span>
      <span class="ruby-comment">#   character, then remember it as the delimiter.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_basic_quote_characters</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-ivar">@rl_basic_quote_characters</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">scan</span>) <span class="ruby-operator">&amp;&amp;</span>
          (<span class="ruby-identifier">_end</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@rl_point</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
        <span class="ruby-identifier">delimiter</span> = <span class="ruby-identifier">scan</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># If the character isn&#39;t needed to determine something special</span>
      <span class="ruby-comment">#   about what kind of completion to perform, then advance past it.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_special_prefixes</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_special_prefixes</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">scan</span>) )
        <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> [<span class="ruby-identifier">quote_char</span>,<span class="ruby-identifier">found_quote!</span>=<span class="ruby-value">0</span>,<span class="ruby-identifier">delimiter</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_find_next_mbchar" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_find_next_mbchar</span><span
            class="method-args">(string, seed, count, flags)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Find next `count&#39; characters started byte point of the specified seed.</p>

<pre>If flags is MB_FIND_NONZERO, we look for non-zero-width multibyte
characters.</pre>
          
          

          
          <div class="method-source-code" id="_rl_find_next_mbchar-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8622</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">seed</span>, <span class="ruby-identifier">count</span>, <span class="ruby-identifier">flags</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@encoding</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;N&#39;</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">seed</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">seed</span> = <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">seed</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">seed</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>

  <span class="ruby-identifier">point</span> = <span class="ruby-identifier">seed</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">_rl_adjust_point</span>(<span class="ruby-identifier">string</span>,<span class="ruby-identifier">seed</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">seed</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">point</span>)
    <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">str</span> = (<span class="ruby-identifier">flags</span> <span class="ruby-operator">==</span> <span class="ruby-constant">MB_FIND_NONZERO</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\x00+$/</span>,<span class="ruby-string">&#39;&#39;</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">string</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">point</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>,<span class="ruby-identifier">count</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">point</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>,<span class="ruby-identifier">count</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">point</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>,<span class="ruby-identifier">count</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">str</span>[<span class="ruby-identifier">point</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>,<span class="ruby-identifier">count</span>].<span class="ruby-identifier">bytesize</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">count</span>
    <span class="ruby-identifier">point</span> = <span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">str</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">point</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_find_prev_mbchar" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_find_prev_mbchar</span><span
            class="method-args">(string, seed, flags)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Find previous character started byte point of the specified seed.</p>

<pre>Returned point will be point &lt;= seed.  If flags is MB_FIND_NONZERO,
we look for non-zero-width multibyte characters.</pre>
          
          

          
          <div class="method-source-code" id="_rl_find_prev_mbchar-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8655</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">seed</span>, <span class="ruby-identifier">flags</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@encoding</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;N&#39;</span>
    <span class="ruby-keyword">return</span> ((<span class="ruby-identifier">seed</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">seed</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">seed</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">length</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">seed</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">seed</span>
    <span class="ruby-keyword">return</span> <span class="ruby-identifier">length</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">seed</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">seed</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">seed</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">seed</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">bytesize</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_fix_point" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_fix_point</span><span
            class="method-args">(fix_mark_too)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_fix_point-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4948</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_fix_point</span>(<span class="ruby-identifier">fix_mark_too</span>)
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">__rl_fix_point</span>(<span class="ruby-ivar">@rl_point</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">fix_mark_too</span>)
    <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-identifier">__rl_fix_point</span>(<span class="ruby-ivar">@rl_mark</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_get_char_len" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_get_char_len</span><span
            class="method-args">(src)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>return the number of bytes parsed from the multibyte sequence starting at
src, if a non-L&#39;0&#39; wide character was recognized. It returns 0, if
a L&#39;0&#39; wide character was recognized. It  returns (size_t)(-1), if
an invalid multibyte sequence was encountered. It returns (size_t)(-2) if
it couldn&#39;t parse a complete  multibyte character.</p>
          
          

          
          <div class="method-source-code" id="_rl_get_char_len-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8702</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_get_char_len</span>(<span class="ruby-identifier">src</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">src</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">src</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>
  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">src</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">src</span>.<span class="ruby-identifier">valid_encoding?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">src</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">bytesize</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">len</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">len</span><span class="ruby-operator">==</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">-2</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">len</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_get_screen_size" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_get_screen_size</span><span
            class="method-args">(tty, ignore_env)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get readline&#39;s idea of the screen size.  TTY is a file descriptor open</p>

<pre>to the terminal.  If IGNORE_ENV is true, we do not pay attention to the
values of $LINES and $COLUMNS.  The tests for TERM_STRING_BUFFER being
non-null serve to check whether or not we have initialized termcap.</pre>
          
          

          
          <div class="method-source-code" id="_rl_get_screen_size-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1857</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_get_screen_size</span>(<span class="ruby-identifier">tty</span>, <span class="ruby-identifier">ignore_env</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@hConsoleHandle</span>
    <span class="ruby-identifier">csbi</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">24</span>
    <span class="ruby-ivar">@GetConsoleScreenBufferInfo</span>.<span class="ruby-constant">Call</span>(<span class="ruby-ivar">@hConsoleHandle</span>,<span class="ruby-identifier">csbi</span>)
    <span class="ruby-identifier">wc</span>,<span class="ruby-identifier">wr</span> = <span class="ruby-identifier">csbi</span>[<span class="ruby-value">0</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;SS&#39;</span>)
    <span class="ruby-comment"># wr,wc, = `mode con`.scan(/\d+\n/).map{|x| x.to_i}</span>
    <span class="ruby-ivar">@_rl_screenwidth</span> = <span class="ruby-identifier">wc</span>
    <span class="ruby-ivar">@_rl_screenheight</span> = <span class="ruby-identifier">wr</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">wr</span>, <span class="ruby-identifier">wc</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
      <span class="ruby-identifier">wr</span>, <span class="ruby-identifier">wc</span> = <span class="ruby-value">%xstty size`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39; &#39;</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">to_i</span> }
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@_rl_screenwidth</span> = <span class="ruby-identifier">wc</span>
    <span class="ruby-ivar">@_rl_screenheight</span> = <span class="ruby-identifier">wr</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ignore_env</span><span class="ruby-operator">==</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;LINES&#39;</span>]
      <span class="ruby-ivar">@_rl_screenheight</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;LINES&#39;</span>].<span class="ruby-identifier">to_i</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ignore_env</span><span class="ruby-operator">==</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;COLUMNS&#39;</span>]
      <span class="ruby-ivar">@_rl_screenwidth</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&#39;COLUMNS&#39;</span>].<span class="ruby-identifier">to_i</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If all else fails, default to 80x24 terminal.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_screenwidth</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">1</span>
    <span class="ruby-ivar">@_rl_screenwidth</span> = <span class="ruby-value">80</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_screenheight</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_screenheight</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>
    <span class="ruby-ivar">@_rl_screenheight</span> = <span class="ruby-value">24</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># If we&#39;re being compiled as part of bash, set the environment</span>
  <span class="ruby-comment">#   variables $LINES and $COLUMNS to new values.  Otherwise, just</span>
  <span class="ruby-comment">#   do a pair of putenv () or setenv () calls.</span>
  <span class="ruby-identifier">sh_set_lines_and_columns</span>(<span class="ruby-ivar">@_rl_screenheight</span>, <span class="ruby-ivar">@_rl_screenwidth</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_term_autowrap</span>
    <span class="ruby-ivar">@_rl_screenwidth</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_screenchars</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@_rl_screenheight</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_history_set_point" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_history_set_point</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_history_set_point-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5442</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_history_set_point</span> ()
  <span class="ruby-ivar">@rl_point</span> = (<span class="ruby-ivar">@_rl_history_preserve_point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_history_saved_point</span> <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span>) <span class="ruby-operator">?</span>
    <span class="ruby-ivar">@_rl_history_saved_point</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_keymap</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@vi_insertion_keymap</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
    <span class="ruby-ivar">@rl_mark</span> = (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_end</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_init_eightbit" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_init_eightbit</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_init_eightbit-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2077</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_init_eightbit</span>()

<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_init_line_state" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_init_line_state</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_init_line_state-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2545</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_init_line_state</span>()
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-ivar">@rl_end</span> = <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@rl_line_buffer</span> = <span class="ruby-string">&quot;&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_init_terminal_io" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_init_terminal_io</span><span
            class="method-args">(terminal_name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_init_terminal_io-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1969</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_init_terminal_io</span>(<span class="ruby-identifier">terminal_name</span>)
  <span class="ruby-identifier">term</span> = <span class="ruby-identifier">terminal_name</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">terminal_name</span> <span class="ruby-operator">:</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;TERM&quot;</span>]
  <span class="ruby-ivar">@_rl_term_clrpag</span> = <span class="ruby-ivar">@_rl_term_cr</span> = <span class="ruby-ivar">@_rl_term_clreol</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">tty</span> = <span class="ruby-ivar">@rl_instream</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_instream</span>.<span class="ruby-identifier">fileno</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">no_terminal?</span>
    <span class="ruby-identifier">term</span> = <span class="ruby-string">&quot;dumb&quot;</span>
    <span class="ruby-ivar">@_rl_bind_stty_chars</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@term_string_buffer</span> <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">2032</span>

  <span class="ruby-ivar">@term_buffer</span> <span class="ruby-operator">||=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">4080</span>

  <span class="ruby-identifier">buffer</span> = <span class="ruby-ivar">@term_string_buffer</span>

  <span class="ruby-identifier">tgetent_ret</span> = (<span class="ruby-identifier">term</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;dumb&quot;</span>) <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-value">-1</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">tgetent_ret</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">buffer</span> = <span class="ruby-ivar">@term_buffer</span> = <span class="ruby-ivar">@term_string_buffer</span> = <span class="ruby-keyword">nil</span>

    <span class="ruby-ivar">@_rl_term_autowrap</span> = <span class="ruby-keyword">false</span>    <span class="ruby-comment"># used by _rl_get_screen_size</span>

    <span class="ruby-comment"># Allow calling application to set default height and width, using</span>
    <span class="ruby-comment">#rl_set_screen_size</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_screenheight</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">_rl_get_screen_size</span>(<span class="ruby-identifier">tty</span>, <span class="ruby-value">0</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Defaults.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_screenheight</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@_rl_screenwidth</span> = <span class="ruby-value">79</span>
      <span class="ruby-ivar">@_rl_screenheight</span> = <span class="ruby-value">24</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Everything below here is used by the redisplay code (tputs).</span>
    <span class="ruby-ivar">@_rl_screenchars</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@_rl_screenheight</span>
    <span class="ruby-ivar">@_rl_term_cr</span> = <span class="ruby-string">&quot;\r&quot;</span>
    <span class="ruby-ivar">@_rl_term_im</span> = <span class="ruby-ivar">@_rl_term_ei</span> = <span class="ruby-ivar">@_rl_term_ic</span> = <span class="ruby-ivar">@_rl_term_IC</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_up</span> = <span class="ruby-ivar">@_rl_term_dc</span> = <span class="ruby-ivar">@_rl_term_DC</span> = <span class="ruby-ivar">@_rl_visible_bell</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_ku</span> = <span class="ruby-ivar">@_rl_term_kd</span> = <span class="ruby-ivar">@_rl_term_kl</span> = <span class="ruby-ivar">@_rl_term_kr</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_kh</span> = <span class="ruby-ivar">@_rl_term_kH</span> = <span class="ruby-ivar">@_rl_term_kI</span> = <span class="ruby-ivar">@_rl_term_kD</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_ks</span> = <span class="ruby-ivar">@_rl_term_ke</span> = <span class="ruby-ivar">@_rl_term_at7</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_mm</span> = <span class="ruby-ivar">@_rl_term_mo</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_ve</span> = <span class="ruby-ivar">@_rl_term_vs</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_term_forward_char</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_terminal_can_insert</span> = <span class="ruby-ivar">@term_has_meta</span> = <span class="ruby-keyword">false</span>

    <span class="ruby-comment"># Reasonable defaults for tgoto().  Readline currently only uses</span>
    <span class="ruby-comment">#   tgoto if _rl_term_IC or _rl_term_DC is defined, but just in case we</span>
    <span class="ruby-comment">#   change that later...</span>
    <span class="ruby-ivar">@_rl_term_backspace</span> = <span class="ruby-string">&quot;\b&quot;</span>

    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">get_term_capabilities</span>(<span class="ruby-identifier">buffer</span>)

  <span class="ruby-ivar">@_rl_term_cr</span> <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;\r&quot;</span>
  <span class="ruby-ivar">@_rl_term_autowrap</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">tgetflag</span>(<span class="ruby-string">&quot;am&quot;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">tgetflag</span>(<span class="ruby-string">&quot;xn&quot;</span>))

  <span class="ruby-comment"># Allow calling application to set default height and width, using</span>
  <span class="ruby-comment">#   rl_set_screen_size</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_screenheight</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_get_screen_size</span>(<span class="ruby-identifier">tty</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Check to see if this terminal has a meta key and clear the capability</span>
  <span class="ruby-comment">#   variables if there is none.</span>
  <span class="ruby-ivar">@term_has_meta</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">tgetflag</span>(<span class="ruby-string">&quot;km&quot;</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">tgetflag</span>(<span class="ruby-string">&quot;MT&quot;</span>))
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@term_has_meta</span>
    <span class="ruby-ivar">@_rl_term_mm</span> = <span class="ruby-ivar">@_rl_term_mo</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Attempt to find and bind the arrow keys.  Do not override already</span>
  <span class="ruby-comment">#   bound keys in an overzealous attempt, however.</span>

  <span class="ruby-identifier">bind_termcap_arrow_keys</span>(<span class="ruby-ivar">@emacs_standard_keymap</span>)

  <span class="ruby-identifier">bind_termcap_arrow_keys</span>(<span class="ruby-ivar">@vi_movement_keymap</span>)
  <span class="ruby-identifier">bind_termcap_arrow_keys</span>(<span class="ruby-ivar">@vi_insertion_keymap</span>)

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_input_available" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_input_available</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_input_available-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4007</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_input_available</span>
  <span class="ruby-constant">IO</span>.<span class="ruby-identifier">select</span>([ <span class="ruby-identifier">$stdin</span> ], <span class="ruby-keyword">nil</span>, [ <span class="ruby-identifier">$stdin</span> ], <span class="ruby-ivar">@_keyboard_input_timeout</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_insert_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_insert_char</span><span
            class="method-args">(count, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Insert the character C at the current location, moving point forward.</p>

<pre>If C introduces a multibyte sequence, we read the whole sequence and
then insert the multibyte char into the line buffer.</pre>
          
          

          
          <div class="method-source-code" id="_rl_insert_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5527</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)

  <span class="ruby-identifier">incoming</span> = <span class="ruby-string">&#39;&#39;</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">incoming</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
    <span class="ruby-identifier">incoming_length</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@pending_bytes</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">_rl_get_char_len</span>(<span class="ruby-ivar">@pending_bytes</span>) <span class="ruby-operator">==</span> <span class="ruby-value">-2</span>
      <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">incoming</span> = <span class="ruby-ivar">@pending_bytes</span>
      <span class="ruby-ivar">@pending_bytes</span> = <span class="ruby-string">&#39;&#39;</span>
      <span class="ruby-identifier">incoming_length</span> = <span class="ruby-identifier">incoming</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span>(<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>)
    <span class="ruby-identifier">string</span> = <span class="ruby-identifier">incoming</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">count</span>
    <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">string</span>)
    <span class="ruby-identifier">string</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-comment"># We are inserting a single character.</span>
    <span class="ruby-comment">#If there is pending input, then make a string of all of the</span>
    <span class="ruby-comment">#pending characters that are bound to rl_insert, and insert</span>
    <span class="ruby-comment">#them all.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_any_typein</span>())
      <span class="ruby-identifier">_rl_insert_typein</span>(<span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">incoming</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_insert_next" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_insert_next</span><span
            class="method-args">(count)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Insert the next typed character verbatim.</p>
          
          

          
          <div class="method-source-code" id="_rl_insert_next-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5605</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_insert_next</span>(<span class="ruby-identifier">count</span>)
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">rl_read_key</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_insert_typein" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_insert_typein</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_insert_typein-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5512</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_insert_typein</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">string</span> = <span class="ruby-identifier">c</span>

  <span class="ruby-keyword">while</span> ((<span class="ruby-identifier">key</span> = <span class="ruby-identifier">rl_get_char</span>()) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_keymap</span>[<span class="ruby-identifier">key</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:rl_insert</span>)
    <span class="ruby-identifier">string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">key</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">_rl_unget_char</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">string</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_internal_char_cleanup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_internal_char_cleanup</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_internal_char_cleanup-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4661</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_internal_char_cleanup</span>()
  <span class="ruby-comment"># In vi mode, when you exit insert mode, the cursor moves back</span>
  <span class="ruby-comment">#   over the previous character.  We explicitly check for that here.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_keymap</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_movement_keymap</span>)
    <span class="ruby-identifier">rl_vi_check</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_num_chars_to_read</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_num_chars_to_read</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
    <span class="ruby-ivar">@_rl_want_redisplay</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">rl_newline</span>(<span class="ruby-value">1</span>, <span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_done</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
    <span class="ruby-ivar">@_rl_want_redisplay</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If the application writer has told us to erase the entire line if</span>
  <span class="ruby-comment">#   the only character typed was something bound to rl_newline, do so.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_erase_empty_line</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_done</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_last_func</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_newline</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_erase_entire_line</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_internal_pager" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_internal_pager</span><span
            class="method-args">(lines)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_internal_pager-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6488</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_internal_pager</span>(<span class="ruby-identifier">lines</span>)
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">puts</span> <span class="ruby-string">&quot;--More--&quot;</span>
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>
  <span class="ruby-identifier">i</span> = <span class="ruby-identifier">get_y_or_n</span>(<span class="ruby-value">1</span>)
  <span class="ruby-identifier">_rl_erase_entire_line</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-value">2</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">lines</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_is_mbchar_matched" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_is_mbchar_matched</span><span
            class="method-args">(string, seed, _end, mbchar, length)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_is_mbchar_matched-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8767</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_is_mbchar_matched</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">seed</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">mbchar</span>, <span class="ruby-identifier">length</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">seed</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">length</span>)

  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">length</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">string</span>[<span class="ruby-identifier">seed</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">i</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">mbchar</span>[<span class="ruby-identifier">i</span>])
      <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_isearch_cleanup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_isearch_cleanup</span><span
            class="method-args">(cxt, r)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_isearch_cleanup-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4294</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_isearch_cleanup</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">r</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">r</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_isearch_fini</span>(<span class="ruby-identifier">cxt</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_iscxt</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_ISEARCH</span>)

  <span class="ruby-identifier">r</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_isearch_dispatch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_isearch_dispatch</span><span
            class="method-args">(cxt, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process just-read character C according to isearch context CXT.  Return</p>

<pre>-1 if the caller should just free the context and return, 0 if we should
break out of the loop, and 1 if we should continue to read characters.</pre>
          
          

          
          <div class="method-source-code" id="_rl_isearch_dispatch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4014</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_isearch_dispatch</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">f</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">SF_FAILED</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Translate the keys we do something with to opcodes.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_keymap</span>[<span class="ruby-identifier">c</span>])
    <span class="ruby-identifier">f</span> = <span class="ruby-ivar">@_rl_keymap</span>[<span class="ruby-identifier">c</span>]
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">f</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_reverse_search_history</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">-1</span> <span class="ruby-operator">:</span> <span class="ruby-value">-2</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">f</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_forward_search_history</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-value">-2</span> <span class="ruby-operator">:</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">f</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_rubout</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-value">-3</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\C-G&quot;</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-value">-4</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\C-W&quot;</span>)  <span class="ruby-comment"># XXX</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-value">-5</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\C-Y&quot;</span>)  <span class="ruby-comment"># XXX</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-value">-6</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># The characters in isearch_terminators (set from the user-settable</span>
  <span class="ruby-comment">#   variable isearch-terminators) are used to terminate the search but</span>
  <span class="ruby-comment">#   not subsequently execute the character as a command.  The default</span>
  <span class="ruby-comment">#   value is &quot;\033\012&quot; (ESC and C-J).</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_terminators</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>))
    <span class="ruby-comment"># ESC still terminates the search, but if there is pending</span>
    <span class="ruby-comment">#input or if input arrives within 0.1 seconds (on systems</span>
    <span class="ruby-comment">#with select(2)) it is used as a prefix character</span>
    <span class="ruby-comment">#with rl_execute_next.  WATCH OUT FOR THIS!  This is intended</span>
    <span class="ruby-comment">#to allow the arrow keys to be used like ^F and ^B are used</span>
    <span class="ruby-comment">#to terminate the search and execute the movement command.</span>
    <span class="ruby-comment">#XXX - since _rl_input_available depends on the application-</span>
    <span class="ruby-comment">#settable keyboard timeout value, this could alternatively</span>
    <span class="ruby-comment">#use _rl_input_queued(100000)</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> <span class="ruby-operator">==</span> <span class="ruby-constant">ESC</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">_rl_input_available</span>())
      <span class="ruby-identifier">rl_execute_next</span>(<span class="ruby-constant">ESC</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">mb</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">endsrch_char</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>))
      <span class="ruby-comment"># This sets rl_pending_input to c; it will be picked up the next</span>
      <span class="ruby-comment">#   time rl_read_key is called.</span>
      <span class="ruby-identifier">rl_execute_next</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>)
      <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">endsrch_char</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>))
    <span class="ruby-comment"># This sets rl_pending_input to LASTC; it will be picked up the next</span>
    <span class="ruby-comment">#   time rl_read_key is called.</span>
    <span class="ruby-identifier">rl_execute_next</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Now dispatch on the character.  `Opcodes&#39; affect the search string or</span>
  <span class="ruby-comment">#   state.  Other characters are added to the string.</span>
  <span class="ruby-keyword">case</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>)

    <span class="ruby-comment"># search again</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@last_isearch_string</span>)
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span> = <span class="ruby-value">64</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@last_isearch_string_len</span>
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span> = <span class="ruby-ivar">@last_isearch_string</span>.<span class="ruby-identifier">dup</span>
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> = <span class="ruby-ivar">@last_isearch_string_len</span>
        <span class="ruby-identifier">rl_display_search</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>, (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>, <span class="ruby-value">-1</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">return</span> (<span class="ruby-value">1</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># switch directions</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">-2</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span> = <span class="ruby-operator">-</span><span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">SF_REVERSE</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;=</span> <span class="ruby-operator">~</span><span class="ruby-constant">SF_REVERSE</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># delete character from search string.</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">-3</span>  <span class="ruby-comment"># C-H, DEL</span>
    <span class="ruby-comment"># This is tricky.  To do this right, we need to keep a</span>
    <span class="ruby-comment"># stack of search positions for the current search, with</span>
    <span class="ruby-comment"># sentinels marking the beginning and end.  But this will</span>
    <span class="ruby-comment"># do until we have a real isearch-undo.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>.<span class="ruby-identifier">chop!</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">-4</span>  <span class="ruby-comment"># C-G, abort</span>
    <span class="ruby-identifier">rl_replace_line</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>], <span class="ruby-keyword">false</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_point</span>
    <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_mark</span>
    <span class="ruby-identifier">rl_restore_prompt</span>()
    <span class="ruby-identifier">rl_clear_message</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">when</span> <span class="ruby-value">-5</span>  <span class="ruby-comment"># C-W</span>
    <span class="ruby-comment"># skip over portion of line we already matched and yank word</span>
    <span class="ruby-identifier">wstart</span> = <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">wstart</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_end</span>)
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># if not in a word, move to one.</span>
      <span class="ruby-identifier">cval</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">wstart</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">cval</span>))
        <span class="ruby-identifier">rl_ding</span>()
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-identifier">n</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">wstart</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">n</span> = <span class="ruby-identifier">wstart</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">while</span> (<span class="ruby-identifier">n</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)
          <span class="ruby-identifier">cval</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">n</span>)
          <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">cval</span>)
          <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
            <span class="ruby-identifier">n</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">n</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">n</span> = <span class="ruby-identifier">n</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">wlen</span> = <span class="ruby-identifier">n</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">wstart</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">wlen</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span>)
          <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">wlen</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">wstart</span>,<span class="ruby-identifier">wlen</span>]
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">wlen</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">when</span> <span class="ruby-value">-6</span>  <span class="ruby-comment"># C-Y</span>
    <span class="ruby-comment"># skip over portion of line we already matched and yank rest</span>
    <span class="ruby-identifier">wstart</span> = <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">wstart</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_end</span>)
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">n</span> = <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">wstart</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">n</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span>)
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">n</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">wstart</span>,<span class="ruby-identifier">n</span>]
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Add character to search string and continue search.</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+</span> <span class="ruby-value">2</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span> <span class="ruby-operator">+=</span> <span class="ruby-value">128</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-keyword">for</span> <span class="ruby-identifier">j</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">mb</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">mb</span>[<span class="ruby-identifier">j</span>,<span class="ruby-value">1</span>]
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;=</span> <span class="ruby-operator">~</span>(<span class="ruby-constant">SF_FOUND</span><span class="ruby-operator">|</span><span class="ruby-constant">SF_FAILED</span>))<span class="ruby-operator">!=</span><span class="ruby-value">0</span>
    <span class="ruby-identifier">limit</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-comment"># Search the current line.</span>
    <span class="ruby-keyword">while</span> ((<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>) <span class="ruby-operator">:</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">limit</span>))

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span>,<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span>])
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">SF_FOUND</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_FOUND</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>

    <span class="ruby-comment"># Move to the next line, but skip new copies of the line</span>
    <span class="ruby-comment"># we just found and lines shorter than the string we&#39;re</span>
    <span class="ruby-comment"># searching for.</span>
    <span class="ruby-keyword">begin</span>
      <span class="ruby-comment"># Move to the next line.</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span>

      <span class="ruby-comment"># At limit for direction?</span>
      <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">:</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">hlen</span>))
        <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">SF_FAILED</span>
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># We will need these later.</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span>]
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span> ((<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">prev_line_found</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">prev_line_found</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span>]) <span class="ruby-operator">||</span>
               (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span>))

    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_FAILED</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>

    <span class="ruby-comment"># Now set up the line for searching...</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> = (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_FAILED</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>
    <span class="ruby-comment"># We cannot find the search string.  Ding the bell.</span>
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># We have found the search string.  Just display it.  But don&#39;t</span>
  <span class="ruby-comment">#   actually move there in the history list until the user accepts</span>
  <span class="ruby-comment">#   the location.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_FOUND</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">prev_line_found</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span>]
    <span class="ruby-identifier">rl_replace_line</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span>], <span class="ruby-keyword">false</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span>
    <span class="ruby-identifier">rl_display_search</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>, (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>, (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>) <span class="ruby-operator">?</span> <span class="ruby-value">-1</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_isearch_fini" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_isearch_fini</span><span
            class="method-args">(cxt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_isearch_fini-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4258</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_isearch_fini</span>(<span class="ruby-identifier">cxt</span>)
  <span class="ruby-comment"># First put back the original state.</span>
  <span class="ruby-ivar">@rl_line_buffer</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>].<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">rl_restore_prompt</span>()

  <span class="ruby-comment"># Save the search string for possible later use.</span>
  <span class="ruby-ivar">@last_isearch_string</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>
  <span class="ruby-ivar">@last_isearch_string_len</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>)
    <span class="ruby-identifier">rl_get_previous_history</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_get_next_history</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If the string was not found, put point at the end of the last matching</span>
  <span class="ruby-comment">#   line.  If last_found_line == orig_line, we didn&#39;t find any matching</span>
  <span class="ruby-comment">#   history lines at all, so put point back in its original position.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>)
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_point</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> = <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>).<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_mark</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span>
  <span class="ruby-comment"># Don&#39;t worry about where to put the mark here; rl_get_previous_history</span>
  <span class="ruby-comment">#   and rl_get_next_history take care of it.</span>
  <span class="ruby-identifier">rl_clear_message</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_isearch_init" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_isearch_init</span><span
            class="method-args">(direction)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_isearch_init-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7216</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_isearch_init</span>(<span class="ruby-identifier">direction</span>)
  <span class="ruby-identifier">cxt</span> = <span class="ruby-identifier">_rl_scxt_alloc</span>(<span class="ruby-constant">RL_SEARCH_ISEARCH</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">direction</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">SF_REVERSE</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_terminators</span> = <span class="ruby-ivar">@_rl_isearch_terminators</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@_rl_isearch_terminators</span> <span class="ruby-operator">:</span>
    <span class="ruby-ivar">@default_isearch_terminators</span>

  <span class="ruby-comment"># Create an arrary of pointers to the lines that we want to search.</span>
  <span class="ruby-identifier">hlist</span> = <span class="ruby-identifier">history_list</span>()
  <span class="ruby-identifier">rl_maybe_replace_line</span>()
  <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">hlist</span>)
    <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">while</span>(<span class="ruby-identifier">hlist</span>[<span class="ruby-identifier">i</span>])
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Allocate space for this many lines, +1 for the current input line,</span>
  <span class="ruby-comment">#   and remember those lines.</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">hlen</span> = <span class="ruby-identifier">i</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span> = []
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">hlen</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">i</span>] = <span class="ruby-identifier">hlist</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">line</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_saved_line_for_history</span>)
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span>[<span class="ruby-identifier">i</span>] = <span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">line</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Keep track of this so we can free it.</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">allocated_line</span> = <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">allocated_line</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">hlen</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>

  <span class="ruby-comment"># The line where we start the search.</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>

  <span class="ruby-identifier">rl_save_prompt</span>()

  <span class="ruby-comment"># Initialize search parameters.</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span> = <span class="ruby-value">128</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span> = <span class="ruby-string">&quot;&quot;</span>

  <span class="ruby-comment"># Normalize DIRECTION into 1 or -1.</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span> = (<span class="ruby-identifier">direction</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-value">-1</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline</span> = <span class="ruby-ivar">@rl_line_buffer</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>).<span class="ruby-identifier">length</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> = <span class="ruby-ivar">@rl_point</span>

  <span class="ruby-ivar">@_rl_iscxt</span> = <span class="ruby-identifier">cxt</span>     <span class="ruby-comment"># save globally</span>
  <span class="ruby-identifier">cxt</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_make_prompt_for_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_make_prompt_for_search</span><span
            class="method-args">(pchar)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_make_prompt_for_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8116</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_make_prompt_for_search</span>(<span class="ruby-identifier">pchar</span>)
  <span class="ruby-identifier">rl_save_prompt</span>()

  <span class="ruby-comment"># We&#39;ve saved the prompt, and can do anything with the various prompt</span>
  <span class="ruby-comment">#   strings we need before they&#39;re restored.  We want the unexpanded</span>
  <span class="ruby-comment">#   portion of the prompt string after any final newline.</span>
  <span class="ruby-identifier">_p</span> = <span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_prompt</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-string">&quot;\n&quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">_p</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">len</span> = (<span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_prompt</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> ) <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">len</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">pmt</span> = <span class="ruby-ivar">@rl_prompt</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">pmt</span> = <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">pmt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pchar</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">_p</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">pmt</span> = <span class="ruby-ivar">@rl_prompt</span>[<span class="ruby-identifier">_p</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
    <span class="ruby-identifier">pmt</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pchar</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># will be overwritten by expand_prompt, called from rl_message</span>
  <span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-ivar">@saved_physical_chars</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">pmt</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_move_cursor_relative" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_move_cursor_relative</span><span
            class="method-args">(new, data, start=0)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move the cursor from _rl_last_c_pos to NEW, which are buffer indices.</p>

<pre>(Well, when we don&#39;t have multibyte characters, _rl_last_c_pos is a
buffer index.)
DATA is the contents of the screen line of interest; i.e., where
the movement is being done.</pre>
          
          

          
          <div class="method-source-code" id="_rl_move_cursor_relative-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1530</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">start</span>=<span class="ruby-value">0</span>)
  <span class="ruby-identifier">woff</span> = <span class="ruby-identifier">w_offset</span>(<span class="ruby-ivar">@_rl_last_v_pos</span>, <span class="ruby-ivar">@wrap_offset</span>)
  <span class="ruby-identifier">cpos</span> = <span class="ruby-ivar">@_rl_last_c_pos</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">dpos</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">start</span><span class="ruby-operator">+</span><span class="ruby-identifier">new</span>)

    <span class="ruby-comment"># Use NEW when comparing against the last invisible character in the</span>
    <span class="ruby-comment"># prompt string, since they&#39;re both buffer indices and DPOS is a desired</span>
    <span class="ruby-comment"># display position.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">new</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@prompt_last_invisible</span>)     <span class="ruby-comment"># XXX - don&#39;t use woff here</span>
      <span class="ruby-identifier">dpos</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">woff</span>
      <span class="ruby-comment"># Since this will be assigned to _rl_last_c_pos at the end (more</span>
      <span class="ruby-comment">#   precisely, _rl_last_c_pos == dpos when this function returns),</span>
      <span class="ruby-comment">#   let the caller know.</span>
      <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">dpos</span> = <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># If we don&#39;t have to do anything, then return.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cpos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">dpos</span>)
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@hConsoleHandle</span>
    <span class="ruby-identifier">csbi</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">24</span>
    <span class="ruby-ivar">@GetConsoleScreenBufferInfo</span>.<span class="ruby-constant">Call</span>(<span class="ruby-ivar">@hConsoleHandle</span>,<span class="ruby-identifier">csbi</span>)
    <span class="ruby-identifier">x</span>,<span class="ruby-identifier">y</span> = <span class="ruby-identifier">csbi</span>[<span class="ruby-value">4</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;SS&#39;</span>)
    <span class="ruby-identifier">x</span> = <span class="ruby-identifier">dpos</span>
    <span class="ruby-ivar">@SetConsoleCursorPosition</span>.<span class="ruby-constant">Call</span>(<span class="ruby-ivar">@hConsoleHandle</span>,<span class="ruby-identifier">y</span><span class="ruby-operator">*</span><span class="ruby-value">65536</span><span class="ruby-operator">+</span><span class="ruby-identifier">x</span>)
    <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">dpos</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># It may be faster to output a CR, and then move forwards instead</span>
  <span class="ruby-comment">#   of moving backwards.</span>
  <span class="ruby-comment"># i == current physical cursor position.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">i</span> = <span class="ruby-ivar">@_rl_last_c_pos</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">i</span> = <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">woff</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">dpos</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cr_faster</span>(<span class="ruby-identifier">dpos</span>, <span class="ruby-ivar">@_rl_last_c_pos</span>) <span class="ruby-operator">||</span>
      (<span class="ruby-ivar">@_rl_term_autowrap</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_screenwidth</span>))
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-identifier">cpos</span> = <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cpos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">dpos</span>)
    <span class="ruby-comment"># Move the cursor forward.  We do it by printing the command</span>
    <span class="ruby-comment"># to move the cursor forward if there is one, else print that</span>
    <span class="ruby-comment"># portion of the output buffer again.  Which is cheaper?</span>

    <span class="ruby-comment"># The above comment is left here for posterity.  It is faster</span>
    <span class="ruby-comment"># to print one character (non-control) than to print a control</span>
    <span class="ruby-comment"># sequence telling the terminal to move forward one character.</span>
    <span class="ruby-comment"># That kind of control is for people who don&#39;t know what the</span>
    <span class="ruby-comment"># data is underneath the cursor.</span>

    <span class="ruby-comment"># However, we need a handle on where the current display position is</span>
    <span class="ruby-comment"># in the buffer for the immediately preceding comment to be true.</span>
    <span class="ruby-comment"># In multibyte locales, we don&#39;t currently have that info available.</span>
    <span class="ruby-comment"># Without it, we don&#39;t know where the data we have to display begins</span>
    <span class="ruby-comment"># in the buffer and we have to go back to the beginning of the screen</span>
    <span class="ruby-comment"># line.  In this case, we can use the terminal sequence to move forward</span>
    <span class="ruby-comment"># if it&#39;s available.</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_forward_char</span>)
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_forward_char</span> <span class="ruby-operator">*</span> (<span class="ruby-identifier">dpos</span><span class="ruby-operator">-</span><span class="ruby-identifier">cpos</span>))
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">data</span>[<span class="ruby-identifier">start</span>,<span class="ruby-identifier">new</span>])
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">data</span>[<span class="ruby-identifier">start</span><span class="ruby-operator">+</span><span class="ruby-identifier">cpos</span>,<span class="ruby-identifier">new</span><span class="ruby-operator">-</span><span class="ruby-identifier">cpos</span>])
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">cpos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">dpos</span>)
    <span class="ruby-identifier">_rl_backspace</span>(<span class="ruby-identifier">cpos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">dpos</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">dpos</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_move_vert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_move_vert</span><span
            class="method-args">(to)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>PWP: move the cursor up or down.</p>
          
          

          
          <div class="method-source-code" id="_rl_move_vert-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1616</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-identifier">to</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_last_v_pos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">to</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">to</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_screenheight</span>)
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">delta</span> = <span class="ruby-identifier">to</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@_rl_last_v_pos</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;\n&quot;</span><span class="ruby-operator">*</span><span class="ruby-identifier">delta</span>)
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;\r&quot;</span>)
    <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span>(<span class="ruby-ivar">@_rl_term_up</span>)
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_up</span><span class="ruby-operator">*</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">delta</span>))
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_last_v_pos</span> = <span class="ruby-identifier">to</span>        <span class="ruby-comment"># Now TO is here</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_nsearch_abort" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_nsearch_abort</span><span
            class="method-args">(cxt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_nsearch_abort-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8175</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_nsearch_abort</span>(<span class="ruby-identifier">cxt</span>)
  <span class="ruby-identifier">rl_maybe_unsave_line</span>()
  <span class="ruby-identifier">rl_clear_message</span>()
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_point</span>
  <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_mark</span>
  <span class="ruby-identifier">rl_restore_prompt</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_NSEARCH</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_nsearch_cleanup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_nsearch_cleanup</span><span
            class="method-args">(cxt, r)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_nsearch_cleanup-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8168</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_nsearch_cleanup</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">r</span>)
  <span class="ruby-identifier">cxt</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@_rl_nscxt</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_NSEARCH</span>)
  <span class="ruby-identifier">r</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_nsearch_dispatch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_nsearch_dispatch</span><span
            class="method-args">(cxt, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Process just-read character C according to search context CXT.  Return -1</p>

<pre>if the caller should abort the search, 0 if we should break out of the
loop, and 1 if we should continue to read characters.</pre>
          
          

          
          <div class="method-source-code" id="_rl_nsearch_dispatch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8187</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_nsearch_dispatch</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">case</span> (<span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\C-W&quot;</span>
    <span class="ruby-identifier">rl_unix_word_rubout</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\C-U&quot;</span>
    <span class="ruby-identifier">rl_unix_line_discard</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-constant">RETURN</span>,<span class="ruby-constant">NEWLINE</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\C-H&quot;</span>,<span class="ruby-constant">RUBOUT</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">_rl_nsearch_abort</span>(<span class="ruby-identifier">cxt</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">_rl_rubout_char</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;\C-C&quot;</span>,<span class="ruby-string">&quot;\C-G&quot;</span>
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">_rl_nsearch_abort</span>(<span class="ruby-identifier">cxt</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">mb</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_nsearch_dosearch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_nsearch_dosearch</span><span
            class="method-args">(cxt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Perform one search according to CXT, using NONINC_SEARCH_STRING.  Return</p>

<pre>-1 if the search should be aborted, any other value means to clean up
using _rl_nsearch_cleanup ().  Returns 1 if the search was successful,
0 otherwise.</pre>
          
          

          
          <div class="method-source-code" id="_rl_nsearch_dosearch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8221</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_nsearch_dosearch</span>(<span class="ruby-identifier">cxt</span>)
  <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_mark</span>

  <span class="ruby-comment"># If rl_point == 0, we want to re-use the previous search string and</span>
  <span class="ruby-comment">#   start from the saved history position.  If there&#39;s no previous search</span>
  <span class="ruby-comment">#   string, punt.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@noninc_search_string</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">rl_ding</span>()
      <span class="ruby-identifier">rl_restore_prompt</span>()
      <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_NSEARCH</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># We want to start the search from the current history position.</span>
    <span class="ruby-ivar">@noninc_history_pos</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>
    <span class="ruby-ivar">@noninc_search_string</span> = <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">dup</span>

    <span class="ruby-comment"># If we don&#39;t want the subsequent undo list generated by the search</span>
    <span class="ruby-comment">#matching a history line to include the contents of the search string,</span>
    <span class="ruby-comment">#we need to clear rl_line_buffer here.  For now, we just clear the</span>
    <span class="ruby-comment">#undo list generated by reading the search string.  (If the search</span>
    <span class="ruby-comment">#fails, the old undo list will be restored by rl_maybe_unsave_line.)</span>
    <span class="ruby-identifier">rl_free_undo_list</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_restore_prompt</span>()
  <span class="ruby-identifier">noninc_dosearch</span>(<span class="ruby-ivar">@noninc_search_string</span>, <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_nsearch_init" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_nsearch_init</span><span
            class="method-args">(dir, pchar)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_nsearch_init-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8142</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_nsearch_init</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">pchar</span>)
  <span class="ruby-identifier">cxt</span> = <span class="ruby-identifier">_rl_scxt_alloc</span>(<span class="ruby-constant">RL_SEARCH_NSEARCH</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">dir</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">|=</span> <span class="ruby-constant">SF_REVERSE</span>      <span class="ruby-comment"># not strictly needed</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span> = <span class="ruby-identifier">dir</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>
  <span class="ruby-identifier">rl_maybe_save_line</span>()
  <span class="ruby-comment"># Clear the undo list, since reading the search string should create its</span>
  <span class="ruby-comment">#   own undo list, and the whole list will end up being freed when we</span>
  <span class="ruby-comment">#   finish reading the search string.</span>
  <span class="ruby-ivar">@rl_undo_list</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Use the line buffer to read the search string.</span>
  <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-ivar">@rl_end</span> = <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">_p</span> = <span class="ruby-identifier">_rl_make_prompt_for_search</span>(<span class="ruby-identifier">pchar</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">pchar</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39;:&#39;</span>)
  <span class="ruby-identifier">rl_message</span>(<span class="ruby-identifier">_p</span>)
  <span class="ruby-identifier">_p</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_NSEARCH</span>)
  <span class="ruby-ivar">@_rl_nscxt</span> = <span class="ruby-identifier">cxt</span>
  <span class="ruby-identifier">cxt</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_output_some_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_output_some_chars</span><span
            class="method-args">(string,start,count)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Write COUNT characters from STRING to the output stream.</p>
          
          

          
          <div class="method-source-code" id="_rl_output_some_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3861</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">string</span>,<span class="ruby-identifier">start</span>,<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">string</span>[<span class="ruby-identifier">start</span>, <span class="ruby-identifier">count</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">string</span>[<span class="ruby-identifier">start</span>, <span class="ruby-identifier">count</span>])
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_overwrite_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_overwrite_char</span><span
            class="method-args">(count, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Overwrite the character at point (or next COUNT characters) with C.</p>

<pre>If C introduces a multibyte character sequence, read the entire sequence
before starting the overwrite loop.</pre>
          
          

          
          <div class="method-source-code" id="_rl_overwrite_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5573</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_overwrite_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>)

  <span class="ruby-comment"># Read an entire multibyte character sequence to insert COUNT times.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
    <span class="ruby-identifier">mbkey</span> = <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-identifier">_rl_read_mbstring</span>(<span class="ruby-identifier">c</span>, <span class="ruby-identifier">mbkey</span>, <span class="ruby-constant">MB_LEN_MAX</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_begin_undo_group</span>()

  <span class="ruby-identifier">count</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">mbkey</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)
      <span class="ruby-identifier">rl_delete</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_end_undo_group</span>()

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_overwrite_rubout" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_overwrite_rubout</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This is different from what vi does, so the code&#39;s not shared.  Emacs</p>

<pre>rubout in overwrite mode has one oddity:  it replaces a control
character that&#39;s displayed as two characters (^X) with two spaces.</pre>
          
          

          
          <div class="method-source-code" id="_rl_overwrite_rubout-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5757</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_overwrite_rubout</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">opoint</span> = <span class="ruby-ivar">@rl_point</span>

  <span class="ruby-comment"># L == number of spaces to insert</span>
  <span class="ruby-identifier">l</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">count</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">rl_backward_char</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">l</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">rl_character_len</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">1</span>], <span class="ruby-ivar">@rl_point</span>) <span class="ruby-comment"># not exactly right</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_begin_undo_group</span>()

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">opoint</span>, <span class="ruby-ivar">@rl_point</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">opoint</span>, <span class="ruby-ivar">@rl_point</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Emacs puts point at the beginning of the sequence of spaces.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-identifier">opoint</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-identifier">l</span>, <span class="ruby-string">&#39; &#39;</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">opoint</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_end_undo_group</span>()

  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_read_init_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_read_init_file</span><span
            class="method-args">(filename, include_level)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_read_init_file-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2110</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_read_init_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-identifier">include_level</span>)
  <span class="ruby-ivar">@current_readline_init_file</span> = <span class="ruby-identifier">filename</span>
  <span class="ruby-ivar">@current_readline_init_include_level</span> = <span class="ruby-identifier">include_level</span>

  <span class="ruby-identifier">openname</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">buffer</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">openname</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">file</span><span class="ruby-operator">|</span>
      <span class="ruby-identifier">buffer</span> = <span class="ruby-identifier">file</span>.<span class="ruby-identifier">read</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">rescue</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">include_level</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">filename</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@last_readline_init_file</span>)
    <span class="ruby-ivar">@last_readline_init_file</span> = <span class="ruby-identifier">filename</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@currently_reading_init_file</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-comment"># Loop over the lines in the file.  Lines that start with `#&#39; are</span>
  <span class="ruby-comment">#   comments; all other lines are commands for readline initialization.</span>
  <span class="ruby-ivar">@current_readline_init_lineno</span> = <span class="ruby-value">1</span>

  <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">each_line</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">line</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">line</span>.<span class="ruby-identifier">strip!</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^#/</span>
    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">line</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>
    <span class="ruby-identifier">rl_parse_and_bind</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_read_mbchar" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_read_mbchar</span><span
            class="method-args">(mbchar, size)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>read multibyte char</p>
          
          

          
          <div class="method-source-code" id="_rl_read_mbchar-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8721</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_read_mbchar</span>(<span class="ruby-identifier">mbchar</span>, <span class="ruby-identifier">size</span>)
  <span class="ruby-identifier">mb_len</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">mb_len</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">size</span>)
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">rl_read_key</span>()
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)

    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>

    <span class="ruby-identifier">mbchar</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
    <span class="ruby-identifier">mb_len</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">mbchar</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>).<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">mbchar</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>).<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">mbchar</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>).<span class="ruby-identifier">empty?</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">mbchar</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>).<span class="ruby-identifier">valid_encoding?</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">mb_len</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_read_mbstring" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_read_mbstring</span><span
            class="method-args">(first, mb, mlen)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Read a multibyte-character string whose first character is FIRST into</p>

<pre>the buffer MB of length MLEN.  Returns the last character read, which
may be FIRST.  Used by the search functions, among others.  Very similar
to _rl_read_mbchar.</pre>
          
          

          
          <div class="method-source-code" id="_rl_read_mbstring-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8750</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_read_mbstring</span>(<span class="ruby-identifier">first</span>, <span class="ruby-identifier">mb</span>, <span class="ruby-identifier">mlen</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">first</span>
  (<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-identifier">mlen</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">mb</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">c</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">_rl_get_char_len</span>(<span class="ruby-identifier">mb</span>) <span class="ruby-operator">==</span> <span class="ruby-value">-2</span>
      <span class="ruby-comment"># Read more for multibyte character</span>
      <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">rl_read_key</span>()
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">c</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_redisplay_after_sigwinch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_redisplay_after_sigwinch</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Redisplay the current line after a SIGWINCH is received.</p>
          
          

          
          <div class="method-source-code" id="_rl_redisplay_after_sigwinch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8798</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_redisplay_after_sigwinch</span>()
  <span class="ruby-comment"># Clear the current line and put the cursor at column 0.  Make sure</span>
  <span class="ruby-comment">#   the right thing happens if we have wrapped to a new screen line.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_term_cr</span>
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_term_clreol</span>
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_clreol</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">space_to_eol</span>(<span class="ruby-ivar">@_rl_screenwidth</span>)
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_last_v_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-value">0</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_crlf</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Redraw only the last line of a multi-line prompt.</span>
  <span class="ruby-identifier">t</span> = <span class="ruby-ivar">@rl_display_prompt</span>.<span class="ruby-identifier">index</span>(<span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span>
    <span class="ruby-identifier">redraw_prompt</span>(<span class="ruby-ivar">@rl_display_prompt</span>[(<span class="ruby-identifier">t</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)<span class="ruby-operator">..</span><span class="ruby-value">-1</span>])
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_forced_update_display</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_replace_text" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_replace_text</span><span
            class="method-args">(text, start, _end)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Replace the contents of the line buffer between START and END with</p>

<pre>TEXT.  The operation is undoable.  To replace the entire line in an
undoable mode, use _rl_replace_text(text, 0, rl_end)</pre>
          
          

          
          <div class="method-source-code" id="_rl_replace_text-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4977</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_replace_text</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
  <span class="ruby-identifier">rl_begin_undo_group</span>()
  <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">start</span>
  <span class="ruby-identifier">n</span> = <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">text</span>)
  <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-identifier">n</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_reset_argument" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_reset_argument</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Create a default argument.</p>
          
          

          
          <div class="method-source-code" id="_rl_reset_argument-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3964</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_reset_argument</span>()
  <span class="ruby-ivar">@rl_numeric_arg</span> = <span class="ruby-ivar">@rl_arg_sign</span> = <span class="ruby-value">1</span>
  <span class="ruby-ivar">@rl_explicit_arg</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@_rl_argcxt</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_rubout_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_rubout_char</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_rubout_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5818</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_rubout_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-comment"># Duplicated code because this is called from other parts of the library.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_delete</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-identifier">rl_backward_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_byte_oriented</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>,<span class="ruby-value">1</span>]
    <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-identifier">orig_point</span>)
    <span class="ruby-comment"># The erase-at-end-of-line hack is of questionable merit now.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">isprint</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">l</span> = <span class="ruby-identifier">rl_character_len</span>(<span class="ruby-identifier">c</span>, <span class="ruby-ivar">@rl_point</span>)
      <span class="ruby-identifier">_rl_erase_at_end_of_line</span>(<span class="ruby-identifier">l</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-identifier">orig_point</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_scxt_alloc" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_scxt_alloc</span><span
            class="method-args">(type, flags)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_scxt_alloc-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7176</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_scxt_alloc</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">flags</span>)
  <span class="ruby-identifier">cxt</span> = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:type</span>,<span class="ruby-value">:sflags</span>,<span class="ruby-value">:search_string</span>,<span class="ruby-value">:search_string_index</span>,<span class="ruby-value">:search_string_size</span>,<span class="ruby-value">:lines</span>,<span class="ruby-value">:allocated_line</span>,
                   <span class="ruby-value">:hlen</span>,<span class="ruby-value">:hindex</span>,<span class="ruby-value">:save_point</span>,<span class="ruby-value">:save_mark</span>,<span class="ruby-value">:save_line</span>,<span class="ruby-value">:last_found_line</span>,<span class="ruby-value">:prev_line_found</span>,<span class="ruby-value">:save_undo_list</span>,<span class="ruby-value">:history_pos</span>,
                   <span class="ruby-value">:direction</span>,<span class="ruby-value">:lastc</span>,<span class="ruby-value">:sline</span>,<span class="ruby-value">:sline_len</span>,<span class="ruby-value">:sline_index</span>,<span class="ruby-value">:search_terminators</span>,<span class="ruby-value">:mb</span>).<span class="ruby-identifier">new</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">type</span> = <span class="ruby-identifier">type</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> = <span class="ruby-identifier">flags</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_size</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string_index</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lines</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">allocated_line</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">hlen</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">hindex</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_point</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_mark</span> = <span class="ruby-ivar">@rl_mark</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">last_found_line</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_line</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">prev_line_found</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">save_undo_list</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">history_pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">direction</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_len</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sline_index</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_terminators</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">cxt</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_search_getchar" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_search_getchar</span><span
            class="method-args">(cxt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_search_getchar-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3991</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_search_getchar</span>(<span class="ruby-identifier">cxt</span>)
  <span class="ruby-comment"># Read a key and decide how to proceed.</span>
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-identifier">c</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-identifier">rl_read_key</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">mb</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span> = <span class="ruby-identifier">_rl_read_mbstring</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>, <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">mb</span>, <span class="ruby-constant">MB_LEN_MAX</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">c</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_set_insert_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_set_insert_mode</span><span
            class="method-args">(im, force)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Function for the rest of the library to use to set insert/overwrite mode.</p>
          
          

          
          <div class="method-source-code" id="_rl_set_insert_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1447</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-identifier">im</span>, <span class="ruby-identifier">force</span>)
  <span class="ruby-ivar">@rl_insert_mode</span> = <span class="ruby-identifier">im</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_set_mark_at_pos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_set_mark_at_pos</span><span
            class="method-args">(position)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set the mark at POSITION.</p>
          
          

          
          <div class="method-source-code" id="_rl_set_mark_at_pos-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7071</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_set_mark_at_pos</span>(<span class="ruby-identifier">position</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">position</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rl_end</span>)
  <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-identifier">position</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_start_using_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_start_using_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set the history pointer back to the last entry in the history.</p>
          
          

          
          <div class="method-source-code" id="_rl_start_using_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2551</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_start_using_history</span>()
  <span class="ruby-identifier">using_history</span>()
  <span class="ruby-ivar">@_rl_saved_line_for_history</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_strip_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_strip_prompt</span><span
            class="method-args">(pmt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_strip_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3830</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_strip_prompt</span>(<span class="ruby-identifier">pmt</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">pmt</span>).<span class="ruby-identifier">first</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_subseq_getchar" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_subseq_getchar</span><span
            class="method-args">(key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_subseq_getchar-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4580</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_subseq_getchar</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-constant">ESC</span>)
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_METANEXT</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-identifier">k</span> = <span class="ruby-identifier">rl_read_key</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-constant">ESC</span>)
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_METANEXT</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">k</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_to_lower" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_to_lower</span><span
            class="method-args">(char)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_to_lower-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1310</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_to_lower</span>(<span class="ruby-identifier">char</span>)
  <span class="ruby-identifier">char</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">char</span>.<span class="ruby-identifier">chr</span>.<span class="ruby-identifier">downcase</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_unget_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_unget_char</span><span
            class="method-args">(key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Stuff KEY into the <strong>front</strong> of the input buffer.</p>

<pre>Returns non-zero if successful, zero if there is
no space left in the buffer.</pre>
          
          

          
          <div class="method-source-code" id="_rl_unget_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4568</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_unget_char</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ibuffer_space</span>()<span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
    <span class="ruby-ivar">@pop_index</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@pop_index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@pop_index</span> = <span class="ruby-ivar">@ibuffer_len</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@ibuffer</span>[<span class="ruby-ivar">@pop_index</span>] = <span class="ruby-identifier">key</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-value">1</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_update_final" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_update_final</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_update_final-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5679</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_update_final</span>()
  <span class="ruby-identifier">full_lines</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-comment"># If the cursor is the only thing on an otherwise-blank last line,</span>
  <span class="ruby-comment">#   compensate so we don&#39;t print an extra CRLF.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_vis_botlin</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-ivar">@visible_line</span>[<span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-ivar">@_rl_vis_botlin</span>],<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> )
    <span class="ruby-ivar">@_rl_vis_botlin</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">full_lines</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-ivar">@_rl_vis_botlin</span>)
  <span class="ruby-comment"># If we&#39;ve wrapped lines, remove the final xterm line-wrap flag.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">full_lines</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_autowrap</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">vis_llen</span>(<span class="ruby-ivar">@_rl_vis_botlin</span>) <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_screenwidth</span>))
    <span class="ruby-identifier">last_line</span> = <span class="ruby-ivar">@visible_line</span>[<span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-ivar">@_rl_vis_botlin</span>]<span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
    <span class="ruby-ivar">@cpos_buffer_position</span> = <span class="ruby-value">-1</span> <span class="ruby-comment"># don&#39;t know where we are in buffer</span>
    <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">last_line</span>)   <span class="ruby-comment"># XXX</span>
    <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-value">0</span>)
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">last_line</span>[<span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>])
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_vis_botlin</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">rl_crlf</span>()
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>
  <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_display_fixed</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_vi_done_inserting" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_vi_done_inserting</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_vi_done_inserting-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5639</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_vi_done_inserting</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_vi_doing_insert</span>)

    <span class="ruby-comment"># The `C&#39;, `s&#39;, and `S&#39; commands set this.</span>
    <span class="ruby-identifier">rl_end_undo_group</span>()
    <span class="ruby-comment"># Now, the text between rl_undo_list-&gt;next-&gt;start and</span>
    <span class="ruby-comment"># rl_undo_list-&gt;next-&gt;end is what was inserted while in insert</span>
    <span class="ruby-comment"># mode.  It gets copied to VI_INSERT_BUFFER because it depends</span>
    <span class="ruby-comment"># on absolute indices into the line which may change (though they</span>
    <span class="ruby-comment"># probably will not).</span>
    <span class="ruby-ivar">@_rl_vi_doing_insert</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">_rl_vi_save_insert</span>(<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">next</span>)
    <span class="ruby-ivar">@vi_continued_command</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> ((<span class="ruby-ivar">@_rl_vi_last_key_before_insert</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;i&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_vi_last_key_before_insert</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;a&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_undo_list</span>)
      <span class="ruby-identifier">_rl_vi_save_insert</span>(<span class="ruby-ivar">@rl_undo_list</span>)

      <span class="ruby-comment"># XXX - Other keys probably need to be checked.</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@_rl_vi_last_key_before_insert</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;C&#39;</span>)
      <span class="ruby-identifier">rl_end_undo_group</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@_rl_undo_group_level</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">rl_end_undo_group</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@vi_continued_command</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_vi_initialize_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_vi_initialize_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_vi_initialize_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3786</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_vi_initialize_line</span>
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_VICMDONCE</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_vi_reset_last" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_vi_reset_last</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_vi_reset_last-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5672</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_vi_reset_last</span>()
  <span class="ruby-ivar">@_rl_vi_last_command</span> = <span class="ruby-string">&#39;i&#39;</span>
  <span class="ruby-ivar">@_rl_vi_last_repeat</span> = <span class="ruby-value">1</span>
  <span class="ruby-ivar">@_rl_vi_last_arg_sign</span> = <span class="ruby-value">1</span>
  <span class="ruby-ivar">@_rl_vi_last_motion</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_vi_save_insert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_vi_save_insert</span><span
            class="method-args">(up)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_vi_save_insert-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5626</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_vi_save_insert</span>(<span class="ruby-identifier">up</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">up</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">up</span>.<span class="ruby-identifier">what</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">UNDO_INSERT</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@vi_insert_buffer_size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">1</span>)
      <span class="ruby-ivar">@vi_insert_buffer</span>[<span class="ruby-value">0</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">start</span> = <span class="ruby-identifier">up</span>.<span class="ruby-identifier">start</span>
  <span class="ruby-identifier">_end</span> = <span class="ruby-identifier">up</span>.<span class="ruby-identifier">end</span>
  <span class="ruby-identifier">len</span> = <span class="ruby-identifier">_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
  <span class="ruby-ivar">@vi_insert_buffer</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span>,<span class="ruby-identifier">len</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_vi_textmod_command" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_vi_textmod_command</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Is the command C a VI mode text modification command?</p>
          
          

          
          <div class="method-source-code" id="_rl_vi_textmod_command-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5668</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_vi_textmod_command</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@vi_textmod</span>[<span class="ruby-identifier">c</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-_rl_walphabetic" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">_rl_walphabetic</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="_rl_walphabetic-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5166</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">rl_alphabetic</span>(<span class="ruby-identifier">c</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-add_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">add_history</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Place STRING at the end of the history list.  The data field</p>

<pre>is  set to NULL.</pre>
          
          

          
          <div class="method-source-code" id="add_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6100</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">add_history</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@history_stifled</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-ivar">@history_length</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@history_max_entries</span>))
    <span class="ruby-comment"># If the history is stifled, and history_length is zero,</span>
    <span class="ruby-comment"># and it equals history_max_entries, we don&#39;t save items.</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@history_length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">shift</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-ivar">@the_history</span> = []
      <span class="ruby-ivar">@history_length</span> = <span class="ruby-value">1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@history_length</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">alloc_history_entry</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">hist_inittime</span>())
  <span class="ruby-ivar">@the_history</span>[<span class="ruby-ivar">@history_length</span>] = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@the_history</span>[<span class="ruby-ivar">@history_length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>] = <span class="ruby-identifier">temp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-alloc_history_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">alloc_history_entry</span><span
            class="method-args">(string, ts)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="alloc_history_entry-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6080</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">alloc_history_entry</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">ts</span>)
  <span class="ruby-identifier">temp</span> = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:line</span>,<span class="ruby-value">:data</span>,<span class="ruby-value">:timestamp</span>).<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">line</span> = <span class="ruby-identifier">string</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">string</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">string</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">data</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">ts</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">temp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-alloc_undo_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">alloc_undo_entry</span><span
            class="method-args">(what, start, _end, text)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="alloc_undo_entry-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4877</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">alloc_undo_entry</span>(<span class="ruby-identifier">what</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">text</span>)
  <span class="ruby-identifier">temp</span> = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:what</span>,<span class="ruby-value">:start</span>,<span class="ruby-value">:end</span>,<span class="ruby-value">:text</span>,<span class="ruby-value">:next</span>).<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">what</span> = <span class="ruby-identifier">what</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">start</span> = <span class="ruby-identifier">start</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">end</span> = <span class="ruby-identifier">_end</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">text</span> = <span class="ruby-identifier">text</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">next</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">temp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-append_to_match" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">append_to_match</span><span
            class="method-args">(text, delimiter, quote_char, nontrivial_match)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Append any necessary closing quote and a separator character to the
just-inserted match.  If the user has specified that directories should be
marked by a trailing `/&#39;, append one of those instead.  The default
trailing character is a space.  Returns the number of characters appended. 
If NONTRIVIAL_MATCH is set, we test for a symlink (if the OS has them) and
don&#39;t add a suffix for a symlink to a directory.  A nontrivial match is
one that actually adds to the word being completed. The variable
rl_completion_mark_symlink_dirs controls this behavior (it&#39;s initially
set to the what the user has chosen, indicated by the value of
_rl_complete_mark_symlink_dirs, but may be modified by an application&#39;s
completion function).</p>
          
          

          
          <div class="method-source-code" id="append_to_match-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8416</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">append_to_match</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">delimiter</span>, <span class="ruby-identifier">quote_char</span>, <span class="ruby-identifier">nontrivial_match</span>)
  <span class="ruby-identifier">temp_string</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">4</span>
  <span class="ruby-identifier">temp_string_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">quote_char</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_completion_suppress_quote</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">quote_char</span>)
    <span class="ruby-identifier">temp_string</span>[<span class="ruby-identifier">temp_string_index</span>] = <span class="ruby-identifier">quote_char</span>
    <span class="ruby-identifier">temp_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">delimiter</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
    <span class="ruby-identifier">temp_string</span>[<span class="ruby-identifier">temp_string_index</span>] = <span class="ruby-identifier">delimiter</span>
    <span class="ruby-identifier">temp_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_completion_suppress_append</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_completion_append_character</span>)
    <span class="ruby-identifier">temp_string</span>[<span class="ruby-identifier">temp_string_index</span>] = <span class="ruby-ivar">@rl_completion_append_character</span>
    <span class="ruby-identifier">temp_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">temp_string</span>[<span class="ruby-identifier">temp_string_index</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-identifier">temp_string_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_filename_completion_desired</span>)
    <span class="ruby-identifier">filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">text</span>)
    <span class="ruby-identifier">s</span> = (<span class="ruby-identifier">nontrivial_match</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_completion_mark_symlink_dirs</span>) <span class="ruby-operator">?</span>
      <span class="ruby-constant">File</span>.<span class="ruby-identifier">lstat</span>(<span class="ruby-identifier">filename</span>) <span class="ruby-operator">:</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">filename</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">directory?</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_complete_mark_directories</span>
        <span class="ruby-comment"># This is clumsy.  Avoid putting in a double slash if point</span>
        <span class="ruby-comment"># is at the end of the line and the previous character is a</span>
        <span class="ruby-comment"># slash.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;/&#39;</span> )

        <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;/&#39;</span>)
          <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-string">&#39;/&#39;</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># Don&#39;t add anything if the filename is a symlink and resolves to a</span>
      <span class="ruby-comment"># directory.</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">symlink?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">filename</span>).<span class="ruby-identifier">directory?</span>

    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">temp_string_index</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
        <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">temp_string</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">filename</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">temp_string_index</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">temp_string</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">temp_string_index</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bind_arrow_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bind_arrow_keys</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Try and bind the common arrow key prefixes after giving termcap and</p>

<pre>the inputrc file a chance to bind them and create `real&#39; keymaps
for the arrow key prefix.</pre>
          
          

          
          <div class="method-source-code" id="bind_arrow_keys-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2487</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bind_arrow_keys</span>()
  <span class="ruby-identifier">bind_arrow_keys_internal</span>(<span class="ruby-ivar">@emacs_standard_keymap</span>)
  <span class="ruby-identifier">bind_arrow_keys_internal</span>(<span class="ruby-ivar">@vi_movement_keymap</span>)
  <span class="ruby-identifier">bind_arrow_keys_internal</span>(<span class="ruby-ivar">@vi_insertion_keymap</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bind_arrow_keys_internal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bind_arrow_keys_internal</span><span
            class="method-args">(map)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bind some common arrow key sequences in MAP.</p>
          
          

          
          <div class="method-source-code" id="bind_arrow_keys_internal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2450</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bind_arrow_keys_internal</span>(<span class="ruby-identifier">map</span>)
  <span class="ruby-identifier">xkeymap</span> = <span class="ruby-ivar">@_rl_keymap</span>
  <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-identifier">map</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/mswin|mingw/</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340H&quot;</span>, <span class="ruby-value">:rl_get_previous_history</span>) <span class="ruby-comment"># Up</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340P&quot;</span>, <span class="ruby-value">:rl_get_next_history</span>) <span class="ruby-comment"># Down</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340M&quot;</span>, <span class="ruby-value">:rl_forward_char</span>)  <span class="ruby-comment"># Right</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340K&quot;</span>, <span class="ruby-value">:rl_backward_char</span>) <span class="ruby-comment"># Left</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340G&quot;</span>, <span class="ruby-value">:rl_beg_of_line</span>)   <span class="ruby-comment"># Home</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340O&quot;</span>, <span class="ruby-value">:rl_end_of_line</span>)   <span class="ruby-comment"># End</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340s&quot;</span>, <span class="ruby-value">:rl_backward_word</span>) <span class="ruby-comment"># Ctrl-Left</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340t&quot;</span>, <span class="ruby-value">:rl_forward_word</span>) <span class="ruby-comment"># Ctrl-Right</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340S&quot;</span>, <span class="ruby-value">:rl_delete</span>) <span class="ruby-comment"># Delete</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\340R&quot;</span>, <span class="ruby-value">:rl_overwrite_mode</span>) <span class="ruby-comment"># Insert</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033[A&quot;</span>, <span class="ruby-value">:rl_get_previous_history</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033[B&quot;</span>, <span class="ruby-value">:rl_get_next_history</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033[C&quot;</span>, <span class="ruby-value">:rl_forward_char</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033[D&quot;</span>, <span class="ruby-value">:rl_backward_char</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033[H&quot;</span>, <span class="ruby-value">:rl_beg_of_line</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033[F&quot;</span>, <span class="ruby-value">:rl_end_of_line</span>)

    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033OA&quot;</span>, <span class="ruby-value">:rl_get_previous_history</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033OB&quot;</span>, <span class="ruby-value">:rl_get_next_history</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033OC&quot;</span>, <span class="ruby-value">:rl_forward_char</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033OD&quot;</span>, <span class="ruby-value">:rl_backward_char</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033OH&quot;</span>, <span class="ruby-value">:rl_beg_of_line</span>)
    <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-string">&quot;\033OF&quot;</span>, <span class="ruby-value">:rl_end_of_line</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-identifier">xkeymap</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-bind_termcap_arrow_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">bind_termcap_arrow_keys</span><span
            class="method-args">(map)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bind the arrow key sequences from the termcap description in MAP.</p>
          
          

          
          <div class="method-source-code" id="bind_termcap_arrow_keys-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1951</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">bind_termcap_arrow_keys</span>(<span class="ruby-identifier">map</span>)
  <span class="ruby-identifier">xkeymap</span> = <span class="ruby-ivar">@_rl_keymap</span>
  <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-identifier">map</span>

  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_ku</span>, <span class="ruby-value">:rl_get_previous_history</span>)
  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_kd</span>, <span class="ruby-value">:rl_get_next_history</span>)
  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_kr</span>, <span class="ruby-value">:rl_forward_char</span>)
  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_kl</span>, <span class="ruby-value">:rl_backward_char</span>)

  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_kh</span>, <span class="ruby-value">:rl_beg_of_line</span>) <span class="ruby-comment"># Home</span>
  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_at7</span>, <span class="ruby-value">:rl_end_of_line</span>)   <span class="ruby-comment"># End</span>

  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_kD</span>, <span class="ruby-value">:rl_delete</span>)
  <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-ivar">@_rl_term_kI</span>, <span class="ruby-value">:rl_overwrite_mode</span>)

  <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-identifier">xkeymap</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-block_sigint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">block_sigint</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="block_sigint-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6889</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">block_sigint</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@sigint_blocked</span>
  <span class="ruby-ivar">@sigint_proc</span> = <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">trap</span>(<span class="ruby-string">&quot;INT&quot;</span>, <span class="ruby-string">&quot;IGNORE&quot;</span>)
  <span class="ruby-ivar">@sigint_blocked</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-clear_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">clear_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="clear_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8496</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">clear_history</span>()
  <span class="ruby-ivar">@the_history</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@history_offset</span> = <span class="ruby-ivar">@history_length</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-compute_lcd_of_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">compute_lcd_of_matches</span><span
            class="method-args">(match_list, matches, text)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Find the common prefix of the list of matches, and put it into</p>

<pre>matches[0].</pre>
          
          

          
          <div class="method-source-code" id="compute_lcd_of_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1316</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">compute_lcd_of_matches</span>(<span class="ruby-identifier">match_list</span>, <span class="ruby-identifier">matches</span>, <span class="ruby-identifier">text</span>)
  <span class="ruby-comment"># If only one match, just use that.  Otherwise, compare each</span>
  <span class="ruby-comment">#   member of the list with the next, finding out where they</span>
  <span class="ruby-comment">#   stop matching.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>)
    <span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">match_list</span>[<span class="ruby-value">1</span>]
    <span class="ruby-identifier">match_list</span>[<span class="ruby-value">1</span>] = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>
  <span class="ruby-identifier">low</span> = <span class="ruby-value">100000</span>
  <span class="ruby-keyword">while</span>(<span class="ruby-identifier">i</span><span class="ruby-operator">&lt;</span><span class="ruby-identifier">matches</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_completion_case_fold</span>)
      <span class="ruby-identifier">si</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">while</span>((<span class="ruby-identifier">c1</span> = <span class="ruby-identifier">_rl_to_lower</span>(<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>][<span class="ruby-identifier">si</span>])) <span class="ruby-operator">&amp;&amp;</span>
            (<span class="ruby-identifier">c2</span> = <span class="ruby-identifier">_rl_to_lower</span>(<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>][<span class="ruby-identifier">si</span>])))
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-keyword">if</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_compare_chars</span>(<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">si</span>,<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>],<span class="ruby-identifier">si</span>))
            <span class="ruby-keyword">break</span>
          <span class="ruby-keyword">elsif</span> ((<span class="ruby-identifier">v</span> = <span class="ruby-identifier">_rl_get_char_len</span>(<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>][<span class="ruby-identifier">si</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>])) <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
            <span class="ruby-identifier">si</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c1</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">c2</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">si</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">si</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">while</span>((<span class="ruby-identifier">c1</span> = <span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>][<span class="ruby-identifier">si</span>]) <span class="ruby-operator">&amp;&amp;</span>
            (<span class="ruby-identifier">c2</span> = <span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>][<span class="ruby-identifier">si</span>]))
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-keyword">if</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_compare_chars</span>(<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>],<span class="ruby-identifier">si</span>,<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>],<span class="ruby-identifier">si</span>))
            <span class="ruby-keyword">break</span>
          <span class="ruby-keyword">elsif</span> ((<span class="ruby-identifier">v</span> = <span class="ruby-identifier">_rl_get_char_len</span>(<span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>][<span class="ruby-identifier">si</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>])) <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>)
            <span class="ruby-identifier">si</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c1</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">c2</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">si</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">low</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">si</span>)
      <span class="ruby-identifier">low</span> = <span class="ruby-identifier">si</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If there were multiple matches, but none matched up to even the</span>
  <span class="ruby-comment">#   first character, and the user typed something, use that as the</span>
  <span class="ruby-comment">#   value of matches[0].</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">low</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">text</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> )
    <span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># XXX - this might need changes in the presence of multibyte chars</span>

    <span class="ruby-comment"># If we are ignoring case, try to preserve the case of the string</span>
    <span class="ruby-comment"># the user typed in the face of multiple matches differing in case.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_completion_case_fold</span>)

      <span class="ruby-comment"># We&#39;re making an assumption here:</span>
      <span class="ruby-comment">#  IF we&#39;re completing filenames AND</span>
      <span class="ruby-comment">#     the application has defined a filename dequoting function AND</span>
      <span class="ruby-comment">#     we found a quote character AND</span>
      <span class="ruby-comment">#     the application has requested filename quoting</span>
      <span class="ruby-comment">#  THEN</span>
      <span class="ruby-comment">#     we assume that TEXT was dequoted before checking against</span>
      <span class="ruby-comment">#     the file system and needs to be dequoted here before we</span>
      <span class="ruby-comment">#     check against the list of matches</span>
      <span class="ruby-comment">#  FI</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_filename_completion_desired</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-ivar">@rl_filename_dequoting_function</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-ivar">@rl_completion_found_quote</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-ivar">@rl_filename_quoting_desired</span>)

        <span class="ruby-identifier">dtext</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_filename_dequoting_function</span>,<span class="ruby-identifier">text</span>, <span class="ruby-ivar">@rl_completion_quote_character</span>)
        <span class="ruby-identifier">text</span> = <span class="ruby-identifier">dtext</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># sort the list to get consistent answers.</span>
      <span class="ruby-identifier">match_list</span> = [<span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>]] <span class="ruby-operator">+</span> <span class="ruby-identifier">match_list</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">sort</span>

      <span class="ruby-identifier">si</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">si</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">low</span>)
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span> <span class="ruby-operator">..</span> <span class="ruby-identifier">matches</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">0</span>,<span class="ruby-identifier">si</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">text</span>
            <span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">i</span>][<span class="ruby-value">0</span>,<span class="ruby-identifier">low</span>]
            <span class="ruby-keyword">break</span>
          <span class="ruby-keyword">end</span>
          <span class="ruby-comment"># no casematch, use first entry</span>
          <span class="ruby-keyword">if</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">matches</span>)
            <span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">match_list</span>[<span class="ruby-value">1</span>][<span class="ruby-value">0</span>,<span class="ruby-identifier">low</span>]
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-comment"># otherwise, just use the text the user typed.</span>
        <span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">text</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">low</span>]
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">match_list</span>[<span class="ruby-value">0</span>] = <span class="ruby-identifier">match_list</span>[<span class="ruby-value">1</span>][<span class="ruby-value">0</span>,<span class="ruby-identifier">low</span>]
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">matches</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-cr" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cr</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move to the start of the current line.</p>
          
          

          
          <div class="method-source-code" id="cr-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4647</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cr</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-cr_faster" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">cr_faster</span><span
            class="method-args">(new, cur)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="cr_faster-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2557</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">cr_faster</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">cur</span>)
  (<span class="ruby-identifier">new</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>) <span class="ruby-operator">&lt;</span> (<span class="ruby-identifier">cur</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">new</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-ctrl_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ctrl_char</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="ctrl_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2614</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-string">&quot;\x20&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-current_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">current_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the history entry at the current position, as determined by</p>

<pre>history_offset.  If there is no entry there, return a NULL pointer.</pre>
          
          

          
          <div class="method-source-code" id="current_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2606</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">current_history</span>()
  <span class="ruby-keyword">return</span> ((<span class="ruby-ivar">@history_offset</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@history_length</span>) <span class="ruby-operator">||</span> <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">nil?</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@the_history</span>[<span class="ruby-ivar">@history_offset</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-delete_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">delete_chars</span><span
            class="method-args">(count)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete COUNT characters from the display line.</p>
          
          

          
          <div class="method-source-code" id="delete_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8541</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">delete_chars</span>(<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_screenwidth</span>)   <span class="ruby-comment"># XXX</span>

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@hConsoleHandle</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-comment">#if (@_rl_term_DC)</span>
    <span class="ruby-comment">#   buffer = tgoto(_rl_term_DC, count, count);</span>
    <span class="ruby-comment">#   @_rl_out_stream.write(buffer * count)</span>
    <span class="ruby-comment">#else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_dc</span>)
      <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_dc</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">count</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment">#end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-display_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">display_matches</span><span
            class="method-args">(matches)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Display MATCHES, a list of matching filenames in argv format.  This handles
the simple case  a single match  first.  If there is more than one match,
we compute the number of strings in the list and the length of the longest
string, which will be needed by the display function.  If the application
wants to handle displaying the list of matches itself, it sets
RL_COMPLETION_DISPLAY_MATCHES_HOOK to the address of a function, and we
just call it.  If we&#39;re handling the display ourselves, we just call
rl_display_match_list.  We also check that the list of matches doesn&#39;t
exceed the user-settable threshold, and ask the user if he wants to see the
list if there are more matches than RL_COMPLETION_QUERY_ITEMS.</p>
          
          

          
          <div class="method-source-code" id="display_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6669</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">display_matches</span>(<span class="ruby-identifier">matches</span>)
  <span class="ruby-comment"># Move to the last visible line of a possibly-multiple-line command.</span>
  <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-ivar">@_rl_vis_botlin</span>)

  <span class="ruby-comment"># Handle simple case first.  What if there is only one answer?</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span>].<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">printable_part</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>])
    <span class="ruby-identifier">rl_crlf</span>()
    <span class="ruby-identifier">print_filename</span>(<span class="ruby-identifier">temp</span>, <span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>])
    <span class="ruby-identifier">rl_crlf</span>()
    <span class="ruby-identifier">rl_forced_update_display</span>()
    <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># There is more than one answer.  Find out how many there are,</span>
  <span class="ruby-comment">#   and find the maximum printed length of a single entry.</span>
  <span class="ruby-identifier">max</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">while</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">printable_part</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">fnwidth</span>(<span class="ruby-identifier">temp</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">len</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max</span>)
      <span class="ruby-identifier">max</span> = <span class="ruby-identifier">len</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">len</span> = <span class="ruby-identifier">i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>

  <span class="ruby-comment"># If the caller has defined a display hook, then call that now.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_completion_display_matches_hook</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_completion_display_matches_hook</span>,<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">len</span>, <span class="ruby-identifier">max</span>)
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If there are many items, then ask the user if she really wants to</span>
  <span class="ruby-comment">#   see them all.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_completion_query_items</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">len</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_completion_query_items</span>)

    <span class="ruby-identifier">rl_crlf</span>()
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-node">&quot;Display all #{len} possibilities? (y or n)&quot;</span>)
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">get_y_or_n</span>(<span class="ruby-keyword">false</span>)<span class="ruby-operator">==</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">rl_crlf</span>()

      <span class="ruby-identifier">rl_forced_update_display</span>()
      <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span>

      <span class="ruby-keyword">return</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_display_match_list</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">len</span>, <span class="ruby-identifier">max</span>)

  <span class="ruby-identifier">rl_forced_update_display</span>()
  <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-endsrch_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">endsrch_char</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="endsrch_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4003</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">endsrch_char</span>(<span class="ruby-identifier">c</span>)
  ((<span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">meta_char</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">c</span>) <span class="ruby-operator">==</span> <span class="ruby-constant">RUBOUT</span>) <span class="ruby-operator">&amp;&amp;</span> ((<span class="ruby-identifier">c</span>) <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;\C-G&quot;</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-expand_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">expand_prompt</span><span
            class="method-args">(pmt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Current implementation:</p>

<pre> \001 (^A) start non-visible characters
 \002 (^B) end non-visible characters
all characters except \001 and \002 (following a \001) are copied to
the returned string all characters except those between \001 and
\002 are assumed to be `visible&#39;.</pre>
          
          

          
          <div class="method-source-code" id="expand_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1674</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">pmt</span>)
  <span class="ruby-comment"># Short-circuit if we can.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pmt</span>[<span class="ruby-constant">RL_PROMPT_START_IGNORE</span>].<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">pmt</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">lp</span> = <span class="ruby-identifier">r</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-identifier">lip</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">niflp</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">vlp</span> = <span class="ruby-identifier">lp</span>
    <span class="ruby-keyword">return</span> [<span class="ruby-identifier">r</span>,<span class="ruby-identifier">lp</span>,<span class="ruby-identifier">lip</span>,<span class="ruby-identifier">niflp</span>,<span class="ruby-identifier">vlp</span>]
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">l</span> = <span class="ruby-identifier">pmt</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-identifier">ret</span> = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-identifier">invfl</span> = <span class="ruby-value">0</span>    <span class="ruby-comment"># invisible chars in first line of prompt</span>
  <span class="ruby-identifier">invflset</span> = <span class="ruby-value">0</span>    <span class="ruby-comment"># we only want to set invfl once</span>

  <span class="ruby-identifier">igstart</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">rl</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">ignoring</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">last</span> = <span class="ruby-identifier">ninvis</span> = <span class="ruby-identifier">physchars</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">pi</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">pmt</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-comment"># This code strips the invisible character string markers</span>
    <span class="ruby-comment">#RL_PROMPT_START_IGNORE and RL_PROMPT_END_IGNORE</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">ignoring</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pmt</span>[<span class="ruby-identifier">pi</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">RL_PROMPT_START_IGNORE</span>)        <span class="ruby-comment"># XXX - check ignoring?</span>
      <span class="ruby-identifier">ignoring</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-identifier">igstart</span> = <span class="ruby-identifier">pi</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">ignoring</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">pmt</span>[<span class="ruby-identifier">pi</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">RL_PROMPT_END_IGNORE</span>)
      <span class="ruby-identifier">ignoring</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">pi</span> <span class="ruby-operator">!=</span> (<span class="ruby-identifier">igstart</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>))
        <span class="ruby-identifier">last</span> = <span class="ruby-identifier">ret</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-identifier">pind</span> = <span class="ruby-identifier">pi</span>
        <span class="ruby-identifier">ind</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-identifier">pmt</span>, <span class="ruby-identifier">pind</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
        <span class="ruby-identifier">l</span> = <span class="ruby-identifier">ind</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pind</span>
        <span class="ruby-keyword">while</span> (<span class="ruby-identifier">l</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
          <span class="ruby-identifier">l</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
          <span class="ruby-identifier">ret</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pmt</span>[<span class="ruby-identifier">pi</span>]
          <span class="ruby-identifier">pi</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">ignoring</span>)
          <span class="ruby-identifier">rl</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">ind</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pind</span>
          <span class="ruby-identifier">physchars</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">pmt</span>, <span class="ruby-identifier">pind</span>, <span class="ruby-identifier">ind</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">ninvis</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">ind</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pind</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">pi</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>       <span class="ruby-comment"># compensate for later increment</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ret</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">pmt</span>[<span class="ruby-identifier">pi</span>]
        <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">ignoring</span>)
          <span class="ruby-identifier">rl</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>            <span class="ruby-comment"># visible length byte counter</span>
          <span class="ruby-identifier">physchars</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">ninvis</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>        <span class="ruby-comment"># invisible chars byte counter</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">invflset</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">rl</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-identifier">invfl</span> = <span class="ruby-identifier">ninvis</span>
          <span class="ruby-identifier">invflset</span> = <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
    <span class="ruby-identifier">invfl</span> = <span class="ruby-identifier">ninvis</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">lp</span> = <span class="ruby-identifier">rl</span>
  <span class="ruby-identifier">lip</span> = <span class="ruby-identifier">last</span>
  <span class="ruby-identifier">niflp</span> = <span class="ruby-identifier">invfl</span>
  <span class="ruby-identifier">vlp</span> = <span class="ruby-identifier">physchars</span>
  <span class="ruby-keyword">return</span> [<span class="ruby-identifier">ret</span>,<span class="ruby-identifier">lp</span>,<span class="ruby-identifier">lip</span>,<span class="ruby-identifier">niflp</span>,<span class="ruby-identifier">vlp</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-fnprint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fnprint</span><span
            class="method-args">(to_print)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="fnprint-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6449</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fnprint</span>(<span class="ruby-identifier">to_print</span>)
  <span class="ruby-identifier">printed_len</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
    <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">to_print</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
    <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">to_print</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
    <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">to_print</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">to_print</span>.<span class="ruby-identifier">dup</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>).<span class="ruby-identifier">chars</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">arr</span> = <span class="ruby-identifier">to_print</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./m</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">arr</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
    <span class="ruby-keyword">if</span>(<span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">s</span>))
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39;^&#39;</span><span class="ruby-operator">+</span>(<span class="ruby-identifier">s</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ord</span><span class="ruby-operator">|</span><span class="ruby-value">0x40</span>).<span class="ruby-identifier">chr</span>.<span class="ruby-identifier">upcase</span>)
      <span class="ruby-identifier">printed_len</span> <span class="ruby-operator">+=</span> <span class="ruby-value">2</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">s</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RUBOUT</span>
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39;^?&#39;</span>)
      <span class="ruby-identifier">printed_len</span> <span class="ruby-operator">+=</span> <span class="ruby-value">2</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@encoding</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;U&#39;</span>
        <span class="ruby-identifier">printed_len</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;U&#39;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@encoding</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;X&#39;</span>
        <span class="ruby-identifier">printed_len</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">ord</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">printed_len</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">printed_len</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-fnwidth" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">fnwidth</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Compute width of STRING when displayed on screen by <a
href="RbReadline.html#method-i-print_filename">#print_filename</a></p>
          
          

          
          <div class="method-source-code" id="fnwidth-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6619</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">fnwidth</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-identifier">left</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">width</span> = <span class="ruby-identifier">pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>]) <span class="ruby-operator">||</span> <span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">RUBOUT</span>)
      <span class="ruby-identifier">width</span> <span class="ruby-operator">+=</span> <span class="ruby-value">2</span>
      <span class="ruby-identifier">pos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>,<span class="ruby-identifier">left</span><span class="ruby-operator">-</span><span class="ruby-identifier">pos</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>,<span class="ruby-identifier">left</span><span class="ruby-operator">-</span><span class="ruby-identifier">pos</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>,<span class="ruby-identifier">left</span><span class="ruby-operator">-</span><span class="ruby-identifier">pos</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;U&#39;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>,<span class="ruby-identifier">left</span><span class="ruby-operator">-</span><span class="ruby-identifier">pos</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">bytesize</span>
        <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">ord</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">string</span>[<span class="ruby-identifier">pos</span>,<span class="ruby-identifier">left</span><span class="ruby-operator">-</span><span class="ruby-identifier">pos</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./m</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">clen</span> = <span class="ruby-identifier">bytes</span>
      <span class="ruby-identifier">pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">clen</span>
      <span class="ruby-identifier">w</span> = <span class="ruby-identifier">tempwidth</span>
      <span class="ruby-identifier">width</span> <span class="ruby-operator">+=</span> (<span class="ruby-identifier">w</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">w</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">width</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-gen_completion_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">gen_completion_matches</span><span
            class="method-args">(text, start, _end, our_func, found_quote, quote_char)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="gen_completion_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6268</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">gen_completion_matches</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">our_func</span>, <span class="ruby-identifier">found_quote</span>, <span class="ruby-identifier">quote_char</span>)
  <span class="ruby-ivar">@rl_completion_found_quote</span> = <span class="ruby-identifier">found_quote</span>
  <span class="ruby-ivar">@rl_completion_quote_character</span> = <span class="ruby-identifier">quote_char</span>

  <span class="ruby-comment"># If the user wants to TRY to complete, but then wants to give</span>
  <span class="ruby-comment">#   up and use the default completion function, they set the</span>
  <span class="ruby-comment">#   variable rl_attempted_completion_function.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_attempted_completion_function</span>)
    <span class="ruby-identifier">matches</span> = <span class="ruby-constant">Readline</span>.<span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_attempted_completion_function</span>,<span class="ruby-identifier">text</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_attempted_completion_over</span>)
      <span class="ruby-ivar">@rl_attempted_completion_over</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">return</span> (<span class="ruby-identifier">matches</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># XXX -- filename dequoting moved into rl_filename_completion_function</span>

  <span class="ruby-identifier">matches</span> = <span class="ruby-identifier">rl_completion_matches</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">our_func</span>)
  <span class="ruby-identifier">matches</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_term_capabilities" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_term_capabilities</span><span
            class="method-args">(buffer)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="get_term_capabilities-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1811</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_term_capabilities</span>(<span class="ruby-identifier">buffer</span>)
  <span class="ruby-identifier">hash</span> = {}
    <span class="ruby-value">%xinfocmp -C`</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;:&#39;</span>).<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/(.*)=(.*)/</span> <span class="ruby-keyword">and</span> <span class="ruby-identifier">hash</span>[<span class="ruby-node">$1</span>]=<span class="ruby-node">$2</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&#39;\E&#39;</span>,<span class="ruby-string">&quot;\e&quot;</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\^(.)/</span>){(<span class="ruby-node">$1</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ord</span> <span class="ruby-operator">^</span> ((<span class="ruby-value">?a</span><span class="ruby-operator">..</span><span class="ruby-value">?z</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-node">$1</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">?</span> <span class="ruby-value">0x60</span> <span class="ruby-operator">:</span> <span class="ruby-value">0x40</span>)).<span class="ruby-identifier">chr</span>}}
    <span class="ruby-ivar">@_rl_term_at7</span>          =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;@7&quot;</span>]
    <span class="ruby-ivar">@_rl_term_DC</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;DC&quot;</span>]
    <span class="ruby-ivar">@_rl_term_IC</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;IC&quot;</span>]
    <span class="ruby-ivar">@_rl_term_clreol</span>       =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ce&quot;</span>]
    <span class="ruby-ivar">@_rl_term_clrpag</span>       =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;cl&quot;</span>]
    <span class="ruby-ivar">@_rl_term_cr</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;cr&quot;</span>]
    <span class="ruby-ivar">@_rl_term_dc</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;dc&quot;</span>]
    <span class="ruby-ivar">@_rl_term_ei</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ei&quot;</span>]
    <span class="ruby-ivar">@_rl_term_ic</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ic&quot;</span>]
    <span class="ruby-ivar">@_rl_term_im</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;im&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kD</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kD&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kH</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kH&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kI</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kI&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kd</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kd&quot;</span>]
    <span class="ruby-ivar">@_rl_term_ke</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ke&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kh</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kh&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kl</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kl&quot;</span>]
    <span class="ruby-ivar">@_rl_term_kr</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;kr&quot;</span>]
    <span class="ruby-ivar">@_rl_term_ks</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ks&quot;</span>]
    <span class="ruby-ivar">@_rl_term_ku</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ku&quot;</span>]
    <span class="ruby-ivar">@_rl_term_backspace</span>    =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;le&quot;</span>]
    <span class="ruby-ivar">@_rl_term_mm</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;mm&quot;</span>]
    <span class="ruby-ivar">@_rl_term_mo</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;mo&quot;</span>]
    <span class="ruby-ivar">@_rl_term_forward_char</span> =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;nd&quot;</span>]
    <span class="ruby-ivar">@_rl_term_pc</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;pc&quot;</span>]
    <span class="ruby-ivar">@_rl_term_up</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;up&quot;</span>]
    <span class="ruby-ivar">@_rl_visible_bell</span>      =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;vb&quot;</span>]
    <span class="ruby-ivar">@_rl_term_vs</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;vs&quot;</span>]
    <span class="ruby-ivar">@_rl_term_ve</span>           =     <span class="ruby-identifier">hash</span>[<span class="ruby-string">&quot;ve&quot;</span>]
    <span class="ruby-ivar">@tcap_initialized</span> = <span class="ruby-keyword">true</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-get_y_or_n" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">get_y_or_n</span><span
            class="method-args">(for_pager)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The user must press y or n. Non-zero return means y pressed.</p>
          
          

          
          <div class="method-source-code" id="get_y_or_n-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6592</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">get_y_or_n</span>(<span class="ruby-identifier">for_pager</span>)
  <span class="ruby-keyword">while</span>(<span class="ruby-keyword">true</span>)

    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">rl_read_key</span>()
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;y&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Y&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39; &#39;</span>)
      <span class="ruby-keyword">return</span> (<span class="ruby-value">1</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;n&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;N&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RUBOUT</span>)
      <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">ABORT_CHAR</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">c</span>.<span class="ruby-identifier">class</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Fixnum</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>))
      <span class="ruby-identifier">_rl_abort_internal</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">for_pager</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">NEWLINE</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RETURN</span>))
      <span class="ruby-keyword">return</span> (<span class="ruby-value">2</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">for_pager</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;q&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;Q&#39;</span>))
      <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-handle_parser_directive" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">handle_parser_directive</span><span
            class="method-args">(statement)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handle a parser directive.  STATEMENT is the line of the directive</p>

<pre>without any leading `$&#39;.</pre>
          
          

          
          <div class="method-source-code" id="handle_parser_directive-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2233</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">handle_parser_directive</span>(<span class="ruby-identifier">statement</span>)

  <span class="ruby-identifier">directive</span>,<span class="ruby-identifier">args</span> = <span class="ruby-identifier">statement</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39; &#39;</span>)

  <span class="ruby-keyword">case</span> <span class="ruby-identifier">directive</span>.<span class="ruby-identifier">downcase</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;if&quot;</span>
    <span class="ruby-identifier">parser_if</span>(<span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;endif&quot;</span>
    <span class="ruby-identifier">parser_endif</span>(<span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;else&quot;</span>
    <span class="ruby-identifier">parser_else</span>(<span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;include&quot;</span>
    <span class="ruby-identifier">parser_include</span>(<span class="ruby-identifier">args</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment">#_rl_init_file_error(&quot;unknown parser directive&quot;)</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-hist_inittime" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">hist_inittime</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="hist_inittime-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6089</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">hist_inittime</span>()
  <span class="ruby-identifier">t</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-identifier">ts</span> = <span class="ruby-string">&quot;X%u&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">t</span>
  <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">ts</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-identifier">ret</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] = <span class="ruby-ivar">@history_comment_char</span>

  <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_arg_extract" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_arg_extract</span><span
            class="method-args">(first, last, string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="history_arg_extract-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7523</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_arg_extract</span>(<span class="ruby-identifier">first</span>, <span class="ruby-identifier">last</span>, <span class="ruby-identifier">string</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">first</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;$&quot;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">last</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;$&quot;</span>
    <span class="ruby-identifier">fail</span> <span class="ruby-string">&quot;RbReadline.history_arg_extract called with currently unsupported args.&quot;</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Find the last index of an unescaped quote character.</span>
  <span class="ruby-identifier">last_unescaped_quote_char</span> = <span class="ruby-value">-1</span>
  <span class="ruby-constant">RbReadline</span><span class="ruby-operator">::</span><span class="ruby-constant">HISTORY_QUOTE_CHARACTERS</span>.<span class="ruby-identifier">each_char</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">quote_char</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">quote_char</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">quote_char</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">index</span> = <span class="ruby-identifier">string</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/(?:\.|[^#{quote_char}\])#{quote_char} *$/</span>
      <span class="ruby-identifier">last_unescaped_quote_char</span> = <span class="ruby-identifier">index</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">index</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">last_unescaped_quote_char</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">last_unescaped_quote_char</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-comment"># Because of the regex used above.</span>

  <span class="ruby-comment"># Find the last index of an unescaped word delimiter.</span>
  <span class="ruby-identifier">delimiters</span> = <span class="ruby-constant">RbReadline</span><span class="ruby-operator">::</span><span class="ruby-constant">HISTORY_WORD_DELIMITERS</span>.<span class="ruby-identifier">chars</span>.<span class="ruby-identifier">to_a</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">d</span><span class="ruby-operator">|</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">d</span>) }
  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">last_unescaped_delimiter</span> = <span class="ruby-identifier">string</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/(?:\.|[^#{delimiters.join}])+? *$/</span>
    <span class="ruby-identifier">last_unescaped_delimiter</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">last_unescaped_quote_char</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">last_unescaped_delimiter</span>
    <span class="ruby-identifier">quoted_arg</span> = <span class="ruby-identifier">_extract_last_quote</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">string</span>[<span class="ruby-identifier">last_unescaped_quote_char</span>,<span class="ruby-value">1</span>])
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">quoted_arg</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">string</span>[<span class="ruby-identifier">last_unescaped_delimiter</span><span class="ruby-operator">...</span><span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_get" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_get</span><span
            class="method-args">(offset)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the history entry which is logically at OFFSET in the history array.</p>

<pre>OFFSET is relative to history_base.</pre>
          
          

          
          <div class="method-source-code" id="history_get-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6856</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_get</span>(<span class="ruby-identifier">offset</span>)
  <span class="ruby-identifier">local_index</span> = <span class="ruby-identifier">offset</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@history_base</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">local_index</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@history_length</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">local_index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">nil?</span>) <span class="ruby-operator">?</span>
    <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">local_index</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_is_stifled" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_is_stifled</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="history_is_stifled-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8492</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_is_stifled</span>()
  <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@history_stifled</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_list</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="history_list-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7212</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_list</span>()
  <span class="ruby-ivar">@the_history</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_search_pos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_search_pos</span><span
            class="method-args">(string, dir, pos)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search for STRING in the history list.  DIR is &lt; 0 for searching</p>

<pre>backwards.  POS is an absolute index into the history list at
which point to begin searching.</pre>
          
          

          
          <div class="method-source-code" id="history_search_pos-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8044</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_search_pos</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">pos</span>)
  <span class="ruby-identifier">old</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">pos</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">history_search</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">dir</span>) <span class="ruby-operator">==</span> <span class="ruby-value">-1</span>)
    <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">old</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-value">-1</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">old</span>)
  <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_search_prefix" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_search_prefix</span><span
            class="method-args">(string, direction)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Do an anchored search for string through the history in DIRECTION.</p>
          
          

          
          <div class="method-source-code" id="history_search_prefix-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8037</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_search_prefix</span> (<span class="ruby-identifier">string</span>, <span class="ruby-identifier">direction</span>)
  <span class="ruby-identifier">history_search_internal</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">direction</span>, <span class="ruby-constant">ANCHORED_SEARCH</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-history_set_pos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">history_set_pos</span><span
            class="method-args">(pos)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Make the current history item be the one at POS, an absolute index.</p>

<pre>Returns zero if POS is out of range, else non-zero.</pre>
          
          

          
          <div class="method-source-code" id="history_set_pos-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8028</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">pos</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@history_length</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@history_offset</span> = <span class="ruby-identifier">pos</span>
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-ibuffer_space" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">ibuffer_space</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the amount of space available in the buffer for stuffing</p>

<pre>characters.</pre>
          
          

          
          <div class="method-source-code" id="ibuffer_space-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4540</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">ibuffer_space</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@pop_index</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@push_index</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@pop_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@push_index</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@ibuffer_len</span> <span class="ruby-operator">-</span> (<span class="ruby-ivar">@push_index</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@pop_index</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-init_line_structures" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">init_line_structures</span><span
            class="method-args">(minsize)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Initialize the VISIBLE_LINE and INVISIBLE_LINE arrays, and their associated</p>

<pre>arrays of line break markers.  MINSIZE is the minimum size of VISIBLE_LINE
and INVISIBLE_LINE; if it is greater than LINE_SIZE, LINE_SIZE is
increased.  If the lines have already been allocated, this ensures that
they can hold at least MINSIZE characters.</pre>
          
          

          
          <div class="method-source-code" id="init_line_structures-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2578</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">init_line_structures</span>(<span class="ruby-identifier">minsize</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-comment"># initialize it</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@line_size</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">minsize</span>)
      <span class="ruby-ivar">@line_size</span> = <span class="ruby-identifier">minsize</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@visible_line</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@line_size</span>
    <span class="ruby-ivar">@invisible_line</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-ivar">@line_size</span> <span class="ruby-comment"># 1.chr</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@line_size</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">minsize</span>)  <span class="ruby-comment"># ensure it can hold MINSIZE chars</span>
    <span class="ruby-ivar">@line_size</span> <span class="ruby-operator">*=</span> <span class="ruby-value">2</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@line_size</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">minsize</span>)
      <span class="ruby-ivar">@line_size</span> = <span class="ruby-identifier">minsize</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@visible_line</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-ivar">@invisible_line</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">1</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@visible_line</span>[<span class="ruby-identifier">minsize</span>,<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-identifier">minsize</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-identifier">minsize</span>)
  <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-identifier">minsize</span>,<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-identifier">minsize</span>] = <span class="ruby-value">1</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-identifier">minsize</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@vis_lbreaks</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@inv_lbreaks</span> = []
    <span class="ruby-ivar">@vis_lbreaks</span> = []
    <span class="ruby-ivar">@_rl_wrapped_line</span> = []
    <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-value">0</span>] = <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-value">0</span>] = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-insert_all_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">insert_all_matches</span><span
            class="method-args">(matches, point, qc)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="insert_all_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6336</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">insert_all_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">point</span>, <span class="ruby-identifier">qc</span>)
  <span class="ruby-identifier">rl_begin_undo_group</span>()
  <span class="ruby-comment"># remove any opening quote character; make_quoted_replacement will add</span>
  <span class="ruby-comment">#   it back.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">qc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">qc</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">qc</span>)
    <span class="ruby-identifier">point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">point</span>, <span class="ruby-ivar">@rl_point</span>)
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">point</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span>])
    <span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>
    <span class="ruby-keyword">while</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
      <span class="ruby-identifier">rp</span> = <span class="ruby-identifier">make_quoted_replacement</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>], <span class="ruby-constant">SINGLE_MATCH</span>, <span class="ruby-identifier">qc</span>)
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">rp</span>)
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-string">&quot; &quot;</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rp</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
        <span class="ruby-identifier">rp</span> = <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rp</span> = <span class="ruby-identifier">make_quoted_replacement</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>], <span class="ruby-constant">SINGLE_MATCH</span>, <span class="ruby-identifier">qc</span>)
    <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">rp</span>)
    <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-string">&quot; &quot;</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rp</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>])
      <span class="ruby-identifier">rp</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_end_undo_group</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-insert_match" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">insert_match</span><span
            class="method-args">(match, start, mtype, qc)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="insert_match-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6408</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">insert_match</span>(<span class="ruby-identifier">match</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">mtype</span>, <span class="ruby-identifier">qc</span>)
  <span class="ruby-identifier">oqc</span> = <span class="ruby-identifier">qc</span>
  <span class="ruby-identifier">replacement</span> = <span class="ruby-identifier">make_quoted_replacement</span>(<span class="ruby-identifier">match</span>, <span class="ruby-identifier">mtype</span>, <span class="ruby-identifier">qc</span>)

  <span class="ruby-comment"># Now insert the match.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">replacement</span>)
    <span class="ruby-comment"># Don&#39;t double an opening quote character.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">qc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">qc</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">start!</span>=<span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">qc</span> <span class="ruby-operator">&amp;&amp;</span>
        <span class="ruby-identifier">replacement</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">qc</span>)
      <span class="ruby-identifier">start</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
      <span class="ruby-comment"># If make_quoted_replacement changed the quoting character, remove</span>
      <span class="ruby-comment"># the opening quote and insert the (fully-quoted) replacement.</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">qc</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">qc</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">oqc</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">start!</span>=<span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">oqc</span> <span class="ruby-operator">&amp;&amp;</span>
           <span class="ruby-identifier">replacement</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">oqc</span>)
      <span class="ruby-identifier">start</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">_rl_replace_text</span>(<span class="ruby-identifier">replacement</span>, <span class="ruby-identifier">start</span>, <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">replacement</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">match</span>)
      <span class="ruby-identifier">replacement</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-insert_some_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">insert_some_chars</span><span
            class="method-args">(string, count, col)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Insert COUNT characters from STRING to the output stream at column COL.</p>
          
          

          
          <div class="method-source-code" id="insert_some_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8502</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">insert_some_chars</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">count</span>, <span class="ruby-identifier">col</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@hConsoleHandle</span>
    <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">string</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># DEBUGGING</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_byte_oriented</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">col</span>)
        <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">write</span>(<span class="ruby-node">&quot;readline: debug: insert_some_chars: count (#{count}) != col (#{col})\n&quot;</span>);
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># If IC is defined, then we do not have to &quot;enter&quot; insert mode.</span>
    <span class="ruby-comment">#if (@_rl_term_IC)</span>
    <span class="ruby-comment">#   buffer = tgoto(@_rl_term_IC, 0, col)</span>
    <span class="ruby-comment">#   @_rl_out_stream.write(buffer)</span>
    <span class="ruby-comment">#   _rl_output_some_chars(string,0,count)</span>
    <span class="ruby-comment">#else</span>
    <span class="ruby-comment"># If we have to turn on insert-mode, then do so.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_im</span>)
      <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_im</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment"># If there is a special command for inserting characters, then</span>
    <span class="ruby-comment"># use that first to open up the space.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_ic</span>)
      <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_ic</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">count</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Print the text.</span>
    <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">string</span>,<span class="ruby-value">0</span>, <span class="ruby-identifier">count</span>)

    <span class="ruby-comment"># If there is a string to turn off insert mode, we had best use</span>
    <span class="ruby-comment"># it now.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_ei</span>)
      <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_ei</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-comment">#end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-inv_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inv_line</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="inv_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2650</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inv_line</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">line</span>] <span class="ruby-operator">..</span> <span class="ruby-value">-1</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-inv_llen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">inv_llen</span><span
            class="method-args">(l)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="inv_llen-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2634</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">inv_llen</span>(<span class="ruby-identifier">l</span>)
  (<span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">l</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">l</span>])
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-isascii" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">isascii</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="isascii-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7962</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">isascii</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">int_val</span> = <span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span> <span class="ruby-comment"># 1.8 + 1.9 compat.</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">int_val</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">128</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">int_val</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-isprint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">isprint</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="isprint-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2618</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">isprint</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">c</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-string">&quot;\x20&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-string">&quot;\x7f&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-m_offset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">m_offset</span><span
            class="method-args">(margin, offset)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="m_offset-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2654</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">m_offset</span>(<span class="ruby-identifier">margin</span>, <span class="ruby-identifier">offset</span>)
  ((<span class="ruby-identifier">margin</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">offset</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-make_history_line_current" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">make_history_line_current</span><span
            class="method-args">(entry)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Make the data from the history entry ENTRY be the contents of the</p>

<pre>current line.  This doesn&#39;t do anything with rl_point; the caller
must set it.</pre>
          
          

          
          <div class="method-source-code" id="make_history_line_current-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8011</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">make_history_line_current</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-identifier">_rl_replace_text</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">line</span>, <span class="ruby-value">0</span>, <span class="ruby-ivar">@rl_end</span>)
  <span class="ruby-identifier">_rl_fix_point</span>(<span class="ruby-value">1</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-comment"># POSIX.2 says that the `U&#39; command doesn&#39;t affect the copy of any</span>
    <span class="ruby-comment">#   command lines to the edit line.  We&#39;re going to implement that by</span>
    <span class="ruby-comment">#   making the undo list start after the matching line is copied to the</span>
    <span class="ruby-comment">#   current editing buffer.</span>
    <span class="ruby-identifier">rl_free_undo_list</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_saved_line_for_history</span>)
    <span class="ruby-ivar">@_rl_saved_line_for_history</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-make_quoted_replacement" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">make_quoted_replacement</span><span
            class="method-args">(match, mtype, qc)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="make_quoted_replacement-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6367</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">make_quoted_replacement</span>(<span class="ruby-identifier">match</span>, <span class="ruby-identifier">mtype</span>, <span class="ruby-identifier">qc</span>)
  <span class="ruby-comment"># If we are doing completion on quoted substrings, and any matches</span>
  <span class="ruby-comment">#   contain any of the completer_word_break_characters, then auto-</span>
  <span class="ruby-comment">#   matically prepend the substring with a quote character (just pick</span>
  <span class="ruby-comment">#   the first one from the list of such) if it does not already begin</span>
  <span class="ruby-comment">#   with a quote string.  FIXME: Need to remove any such automatically</span>
  <span class="ruby-comment">#   inserted quote character when it no longer is necessary, such as</span>
  <span class="ruby-comment">#   if we change the string we are completing on and the new set of</span>
  <span class="ruby-comment">#   matches don&#39;t require a quoted substring.</span>
  <span class="ruby-identifier">replacement</span> = <span class="ruby-identifier">match</span>

  <span class="ruby-identifier">should_quote</span> = <span class="ruby-identifier">match</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_completer_quote_characters</span> <span class="ruby-operator">&amp;&amp;</span>
    <span class="ruby-ivar">@rl_filename_completion_desired</span> <span class="ruby-operator">&amp;&amp;</span>
    <span class="ruby-ivar">@rl_filename_quoting_desired</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">should_quote</span>)
    <span class="ruby-identifier">should_quote</span> = <span class="ruby-identifier">should_quote</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">qc</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">qc</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">||</span>
                                    (<span class="ruby-ivar">@rl_completer_quote_characters</span> <span class="ruby-operator">&amp;&amp;</span>
                                     <span class="ruby-ivar">@rl_completer_quote_characters</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">qc</span>)))
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">should_quote</span>)

    <span class="ruby-comment"># If there is a single match, see if we need to quote it.</span>
    <span class="ruby-comment">#   This also checks whether the common prefix of several</span>
    <span class="ruby-comment"># matches needs to be quoted.</span>
    <span class="ruby-identifier">should_quote</span> = <span class="ruby-ivar">@rl_filename_quote_characters</span> <span class="ruby-operator">?</span>
      <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">match</span>[<span class="ruby-ivar">@rl_filename_quote_characters</span>] <span class="ruby-operator">:</span>
      <span class="ruby-keyword">false</span>

    <span class="ruby-identifier">do_replace</span> = <span class="ruby-identifier">should_quote</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">mtype</span> <span class="ruby-operator">:</span> <span class="ruby-constant">NO_MATCH</span>
    <span class="ruby-comment"># Quote the replacement, since we found an embedded</span>
    <span class="ruby-comment"># word break character in a potential match.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">do_replace</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">NO_MATCH</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_filename_quoting_function</span>)
      <span class="ruby-identifier">replacement</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_filename_quoting_function</span>,<span class="ruby-identifier">match</span>, <span class="ruby-identifier">do_replace</span>, <span class="ruby-identifier">qc</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">replacement</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-meta_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">meta_char</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="meta_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2610</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">meta_char</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">c</span> <span class="ruby-operator">&gt;</span> <span class="ruby-string">&quot;\x7f&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-string">&quot;\xff&quot;</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-next_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">next_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move history_offset forward to the next history entry, and return</p>

<pre>a pointer to that entry.  If there is no next entry then return a
NULL pointer.</pre>
          
          

          
          <div class="method-source-code" id="next_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5392</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">next_history</span>()
  (<span class="ruby-ivar">@history_offset</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@history_length</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@the_history</span>[<span class="ruby-ivar">@history_offset</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-noninc_dosearch" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">noninc_dosearch</span><span
            class="method-args">(string, dir)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search for a line in the history containing STRING.  If DIR is &lt; 0, the</p>

<pre>search is backwards through previous entries, else through subsequent
entries.  Returns 1 if the search was successful, 0 otherwise.</pre>
          
          

          
          <div class="method-source-code" id="noninc_dosearch-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8085</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">noninc_dosearch</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">dir</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">string</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">string</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@noninc_history_pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">noninc_search_from_pos</span>(<span class="ruby-identifier">string</span>, <span class="ruby-ivar">@noninc_history_pos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">dir</span>, <span class="ruby-identifier">dir</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">==</span> <span class="ruby-value">-1</span>)
    <span class="ruby-comment"># Search failed, current history position unchanged.</span>
    <span class="ruby-identifier">rl_maybe_unsave_line</span>()
    <span class="ruby-identifier">rl_clear_message</span>()
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@noninc_history_pos</span> = <span class="ruby-identifier">pos</span>

  <span class="ruby-identifier">oldpos</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-ivar">@noninc_history_pos</span>)
  <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">current_history</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">oldpos</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">make_history_line_current</span>(<span class="ruby-identifier">entry</span>)
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-identifier">rl_clear_message</span>()
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-noninc_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">noninc_search</span><span
            class="method-args">(dir, pchar)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search non-interactively through the history list.  DIR &lt; 0 means to</p>

<pre>search backwards through the history of previous commands; otherwise
the search is for commands subsequent to the current position in the
history list.  PCHAR is the character to use for prompting when reading
the search string; if not specified (0), it defaults to `:&#39;.</pre>
          
          

          
          <div class="method-source-code" id="noninc_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7972</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">noninc_search</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">pchar</span>)
  <span class="ruby-identifier">cxt</span> = <span class="ruby-identifier">_rl_nsearch_init</span>(<span class="ruby-identifier">dir</span>, <span class="ruby-identifier">pchar</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_CALLBACK</span>))
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Read the search string.</span>
  <span class="ruby-identifier">r</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-keyword">true</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_search_getchar</span>(<span class="ruby-identifier">cxt</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">_rl_nsearch_dispatch</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">r</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">r</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">_rl_nsearch_dosearch</span>(<span class="ruby-identifier">cxt</span>)
  (<span class="ruby-identifier">r</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">_rl_nsearch_cleanup</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">r</span>) <span class="ruby-operator">:</span> (<span class="ruby-identifier">r</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-noninc_search_from_pos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">noninc_search_from_pos</span><span
            class="method-args">(string, pos, dir)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search the history list for STRING starting at absolute history position</p>

<pre>POS.  If STRING begins with `^&#39;, the search must match STRING at the
beginning of a history line, otherwise a full substring match is performed
for STRING.  DIR &lt; 0 means to search backwards through the history list,
DIR &gt;= 0 means to search forward.</pre>
          
          

          
          <div class="method-source-code" id="noninc_search_from_pos-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8061</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">noninc_search_from_pos</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">dir</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)

  <span class="ruby-identifier">old</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">pos</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)

  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_SEARCH</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;^&#39;</span>)
    <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">history_search_prefix</span>(<span class="ruby-identifier">string</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">dir</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">history_search</span>(<span class="ruby-identifier">string</span>, <span class="ruby-identifier">dir</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_SEARCH</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ret</span> <span class="ruby-operator">!=</span> <span class="ruby-value">-1</span>)
    <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">old</span>)
  <span class="ruby-identifier">ret</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_else" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_else</span><span
            class="method-args">(args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Invert the current parser state if there is anything on the stack.</p>
          
          

          
          <div class="method-source-code" id="parser_else-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2189</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_else</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@if_stack</span>.<span class="ruby-identifier">empty?</span>
    <span class="ruby-comment">#_rl_init_file_error (&quot;$else found without matching $if&quot;)</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Check the previous (n) levels of the stack to make sure that</span>
  <span class="ruby-comment">#   we haven&#39;t previously turned off parsing.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@if_stack</span>.<span class="ruby-identifier">detect</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span> }

  <span class="ruby-comment"># Invert the state of parsing if at top level.</span>
  <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_parsing_conditionalized_out</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_endif" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_endif</span><span
            class="method-args">(args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Terminate a conditional, popping the value of</p>

<pre>_rl_parsing_conditionalized_out from the stack.</pre>
          
          

          
          <div class="method-source-code" id="parser_endif-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2206</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_endif</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@if_stack</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = <span class="ruby-ivar">@if_stack</span>.<span class="ruby-identifier">pop</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment">#_rl_init_file_error (&quot;$endif without matching $if&quot;)</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_if" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_if</span><span
            class="method-args">(args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Push _rl_parsing_conditionalized_out, and set parser state based</p>

<pre>on ARGS.</pre>
          
          

          
          <div class="method-source-code" id="parser_if-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2146</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_if</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-comment"># Push parser state.</span>
  <span class="ruby-ivar">@if_stack</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span>

  <span class="ruby-comment"># If parsing is turned off, then nothing can turn it back on except</span>
  <span class="ruby-comment">#   for finding the matching endif.  In that case, return right now.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">args</span>.<span class="ruby-identifier">downcase!</span>
  <span class="ruby-comment"># Handle &quot;$if term=foo&quot; and &quot;$if mode=emacs&quot; constructs.  If this</span>
  <span class="ruby-comment">#   isn&#39;t term=foo, or mode=emacs, then check to see if the first</span>
  <span class="ruby-comment">#   word in ARGS is the same as the value stored in rl_readline_name.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_terminal_name</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^term=/</span>)
    <span class="ruby-comment"># Terminals like &quot;aaa-60&quot; are equivalent to &quot;aaa&quot;.</span>
    <span class="ruby-identifier">tname</span> = <span class="ruby-ivar">@rl_terminal_name</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/-.*$/</span>,<span class="ruby-string">&#39;&#39;</span>)

    <span class="ruby-comment"># Test the `long&#39; and `short&#39; forms of the terminal name so that</span>
    <span class="ruby-comment">#if someone has a `sun-cmd&#39; and does not want to have bindings</span>
    <span class="ruby-comment">#that will be executed if the terminal is a `sun&#39;, they can put</span>
    <span class="ruby-comment">#`$if term=sun-cmd&#39; into their .inputrc.</span>
    <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = (<span class="ruby-identifier">args</span>[<span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">!=</span> <span class="ruby-identifier">tname</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">!=</span> <span class="ruby-ivar">@rl_terminal_name</span>.<span class="ruby-identifier">downcase</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">args</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^mode=/</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;emacs&quot;</span>
      <span class="ruby-identifier">mode</span> = <span class="ruby-ivar">@emacs_mode</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">args</span>[<span class="ruby-value">5</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;vi&quot;</span>
      <span class="ruby-identifier">mode</span> = <span class="ruby-ivar">@vi_mode</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">mode</span> = <span class="ruby-ivar">@no_mode</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = (<span class="ruby-identifier">mode</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@rl_editing_mode</span>)
  <span class="ruby-comment"># Check to see if the first word in ARGS is the same as the</span>
  <span class="ruby-comment">#   value stored in rl_readline_name.</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">args</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_readline_name</span>)
    <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-parser_include" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">parser_include</span><span
            class="method-args">(args)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="parser_include-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2215</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">parser_include</span>(<span class="ruby-identifier">args</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_parsing_conditionalized_out</span>)

  <span class="ruby-identifier">old_init_file</span> = <span class="ruby-ivar">@current_readline_init_file</span>
  <span class="ruby-identifier">old_line_number</span> = <span class="ruby-ivar">@current_readline_init_lineno</span>
  <span class="ruby-identifier">old_include_level</span> = <span class="ruby-ivar">@current_readline_init_include_level</span>

  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">_rl_read_init_file</span>(<span class="ruby-identifier">args</span>, <span class="ruby-identifier">old_include_level</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)

  <span class="ruby-ivar">@current_readline_init_file</span> = <span class="ruby-identifier">old_init_file</span>
  <span class="ruby-ivar">@current_readline_init_lineno</span> = <span class="ruby-identifier">old_line_number</span>
  <span class="ruby-ivar">@current_readline_init_include_level</span> = <span class="ruby-identifier">old_include_level</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-path_isdir" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">path_isdir</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="path_isdir-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6502</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">path_isdir</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">filename</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-postprocess_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">postprocess_matches</span><span
            class="method-args">(matchesp, matching_filenames)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="postprocess_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6300</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">postprocess_matches</span>(<span class="ruby-identifier">matchesp</span>, <span class="ruby-identifier">matching_filenames</span>)
  <span class="ruby-identifier">matches</span> = <span class="ruby-identifier">matchesp</span>

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">nil?</span>

  <span class="ruby-comment"># It seems to me that in all the cases we handle we would like</span>
  <span class="ruby-comment">#   to ignore duplicate possiblilities.  Scan for the text to</span>
  <span class="ruby-comment">#   insert being identical to the other completions.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_ignore_completion_duplicates</span>)
    <span class="ruby-identifier">remove_duplicate_matches</span>(<span class="ruby-identifier">matches</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we are matching filenames, then here is our chance to</span>
  <span class="ruby-comment">#   do clever processing by re-examining the list.  Call the</span>
  <span class="ruby-comment">#   ignore function with the array as a parameter.  It can</span>
  <span class="ruby-comment">#   munge the array, deleting matches as it desires.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_ignore_some_completions_function</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">matching_filenames</span>)
    <span class="ruby-identifier">nmatch</span> = <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_ignore_some_completions_function</span>,<span class="ruby-identifier">matches</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">nil?</span>)
      <span class="ruby-identifier">matches</span> = <span class="ruby-keyword">nil</span>
      <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># If we removed some matches, recompute the common prefix.</span>
      <span class="ruby-identifier">i</span> = <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">nmatch</span>)
        <span class="ruby-identifier">t</span> = <span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">compute_lcd_of_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">i</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>, <span class="ruby-identifier">t</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">matchesp</span> = <span class="ruby-identifier">matches</span>
  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-prepare_terminal_settings" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">prepare_terminal_settings</span><span
            class="method-args">(meta_flag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="prepare_terminal_settings-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6946</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">prepare_terminal_settings</span>(<span class="ruby-identifier">meta_flag</span>)
  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@readline_echoing_p</span> = (<span class="ruby-value">%xstty -a`</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/-*echo\b/</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;echo&#39;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># First, the basic settings to put us into character-at-a-time, no-echo</span>
  <span class="ruby-comment">#   input mode.</span>
  <span class="ruby-identifier">setting</span> = <span class="ruby-string">&quot; -echo -icrnl cbreak&quot;</span>

  <span class="ruby-comment"># If this terminal doesn&#39;t care how the 8th bit is used, then we can</span>
  <span class="ruby-comment">#   use it for the meta-key.  If only one of even or odd parity is</span>
  <span class="ruby-comment">#  specified, then the terminal is using parity, and we cannot.</span>
  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-value">%xstty -a`</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/-parenb\b/</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;-parenb&#39;</span>)
      <span class="ruby-identifier">setting</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; pass8&quot;</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">setting</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot; -ixoff&quot;</span>

  <span class="ruby-identifier">rl_bind_key</span>(<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_start</span>, <span class="ruby-value">:rl_restart_output</span>)
  <span class="ruby-ivar">@_rl_eof_char</span> = <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_eof</span>

  <span class="ruby-comment">#setting &lt;&lt; &quot; -isig&quot;</span>

  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-node">%xstty #{setting}`</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-previous_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">previous_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Back up history_offset to the previous history entry, and return</p>

<pre>a pointer to that entry.  If there is no previous entry then return
a NULL pointer.</pre>
          
          

          
          <div class="method-source-code" id="previous_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5385</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">previous_history</span>()
  <span class="ruby-ivar">@history_offset</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@the_history</span>[<span class="ruby-ivar">@history_offset</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-print_filename" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">print_filename</span><span
            class="method-args">(to_print, full_pathname)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Output TO_PRINT to rl_outstream.  If VISIBLE_STATS is defined and we</p>

<pre>are using it, check for and output a single character for `special&#39;
filenames.  Return the number of characters we output.</pre>
          
          

          
          <div class="method-source-code" id="print_filename-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6531</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">print_filename</span>(<span class="ruby-identifier">to_print</span>, <span class="ruby-identifier">full_pathname</span>)
  <span class="ruby-identifier">printed_len</span> = <span class="ruby-identifier">fnprint</span>(<span class="ruby-identifier">to_print</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_filename_completion_desired</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-ivar">@rl_visible_stats</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_complete_mark_directories</span>))

    <span class="ruby-comment"># If to_print != full_pathname, to_print is the basename of the</span>
    <span class="ruby-comment"># path passed.  In this case, we try to expand the directory</span>
    <span class="ruby-comment"># name before checking for the stat character.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">to_print</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">full_pathname</span>)

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">full_pathname</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">full_pathname</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>
        <span class="ruby-identifier">dn</span> = <span class="ruby-string">&#39;/&#39;</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">dn</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-identifier">full_pathname</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">s</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">dn</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_directory_completion_hook</span>)
        <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_directory_completion_hook</span>,<span class="ruby-identifier">s</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">slen</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-identifier">new_full_pathname</span> = <span class="ruby-identifier">s</span>.<span class="ruby-identifier">dup</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">s</span>[<span class="ruby-value">-1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;/&#39;</span> )
        <span class="ruby-identifier">slen</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">new_full_pathname</span>[<span class="ruby-identifier">slen</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39;/&#39;</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">new_full_pathname</span>[<span class="ruby-identifier">slen</span> <span class="ruby-operator">..</span> <span class="ruby-value">-1</span>] = <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">to_print</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_visible_stats</span>)
        <span class="ruby-identifier">extension_char</span> = <span class="ruby-identifier">stat_char</span>(<span class="ruby-identifier">new_full_pathname</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">path_isdir</span>(<span class="ruby-identifier">new_full_pathname</span>))
          <span class="ruby-identifier">extension_char</span> = <span class="ruby-string">&#39;/&#39;</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">new_full_pathname</span> = <span class="ruby-keyword">nil</span>

    <span class="ruby-keyword">else</span>

      <span class="ruby-identifier">s</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">full_pathname</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_visible_stats</span>)
        <span class="ruby-identifier">extension_char</span> = <span class="ruby-identifier">stat_char</span>(<span class="ruby-identifier">s</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">path_isdir</span>(<span class="ruby-identifier">s</span>))
          <span class="ruby-identifier">extension_char</span> = <span class="ruby-string">&#39;/&#39;</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">s</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">extension_char</span>)
      <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">extension_char</span>)
      <span class="ruby-identifier">printed_len</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">printed_len</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-printable_part" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">printable_part</span><span
            class="method-args">(pathname)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the portion of PATHNAME that should be output when listing</p>

<pre>possible completions.  If we are hacking filename completion, we
are only interested in the basename, the portion following the
final slash.  Otherwise, we return what we were passed.  Since
printing empty strings is not very informative, if we&#39;re doing
filename completion, and the basename is the empty string, we look
for the previous slash and return the portion following that.  If
there&#39;s no previous slash, we just return what we were passed.</pre>
          
          

          
          <div class="method-source-code" id="printable_part-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6439</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">printable_part</span>(<span class="ruby-identifier">pathname</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_filename_completion_desired</span>)  <span class="ruby-comment"># don&#39;t need to do anything</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">pathname</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">pathname</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-string">&#39;/&#39;</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-identifier">pathname</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">nil?</span>
  <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-identifier">pathname</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-prompt_ending_index" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">prompt_ending_index</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ul><li>
<p>_rl_last_c_pos is an absolute cursor position in multibyte locales and a</p>

<pre>buffer index in others.  This macro is used when deciding whether the
current cursor position is in the middle of a prompt string containing
invisible characters.</pre>
</li></ul>
          
          

          
          <div class="method-source-code" id="prompt_ending_index-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2565</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">prompt_ending_index</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-ivar">@prompt_physical_chars</span>
  <span class="ruby-keyword">else</span>
    (<span class="ruby-ivar">@prompt_last_invisible</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline_default_bindings" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline_default_bindings</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If this system allows us to look at the values of the regular</p>

<pre>input editing characters, then bind them to their readline
equivalents, iff the characters are not bound to keymaps.</pre>
          
          

          
          <div class="method-source-code" id="readline_default_bindings-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2071</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline_default_bindings</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_bind_stty_chars</span>
    <span class="ruby-identifier">rl_tty_set_default_bindings</span>(<span class="ruby-ivar">@_rl_keymap</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline_initialize_everything" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline_initialize_everything</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Initialize the entire state of the world.</p>
          
          

          
          <div class="method-source-code" id="readline_initialize_everything-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2494</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline_initialize_everything</span>()
  <span class="ruby-comment"># Set up input and output if they are not already set up.</span>
  <span class="ruby-ivar">@rl_instream</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">$stdin</span>

  <span class="ruby-ivar">@rl_outstream</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">$stdout</span>

  <span class="ruby-comment"># Bind _rl_in_stream and _rl_out_stream immediately.  These values</span>
  <span class="ruby-comment">#   may change, but they may also be used before readline_internal ()</span>
  <span class="ruby-comment">#   is called.</span>
  <span class="ruby-ivar">@_rl_in_stream</span> = <span class="ruby-ivar">@rl_instream</span>
  <span class="ruby-ivar">@_rl_out_stream</span> = <span class="ruby-ivar">@rl_outstream</span>

  <span class="ruby-comment"># Allocate data structures.</span>
  <span class="ruby-ivar">@rl_line_buffer</span> = <span class="ruby-string">&quot;&quot;</span>

  <span class="ruby-comment"># Initialize the terminal interface.</span>
  <span class="ruby-ivar">@rl_terminal_name</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;TERM&quot;</span>]
  <span class="ruby-identifier">_rl_init_terminal_io</span>(<span class="ruby-ivar">@rl_terminal_name</span>)

  <span class="ruby-comment"># Bind tty characters to readline functions.</span>
  <span class="ruby-identifier">readline_default_bindings</span>()

  <span class="ruby-comment"># Decide whether we should automatically go into eight-bit mode.</span>
  <span class="ruby-identifier">_rl_init_eightbit</span>()

  <span class="ruby-comment"># Read in the init file.</span>
  <span class="ruby-identifier">rl_read_init_file</span>(<span class="ruby-keyword">nil</span>)

  <span class="ruby-comment"># XXX</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_autowrap</span>)
    <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-ivar">@_rl_screenchars</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@_rl_screenheight</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Override the effect of any `set keymap&#39; assignments in the</span>
  <span class="ruby-comment">#   inputrc file.</span>
  <span class="ruby-identifier">rl_set_keymap_from_edit_mode</span>()

  <span class="ruby-comment"># Try to bind a common arrow key prefix, if not already bound.</span>
  <span class="ruby-identifier">bind_arrow_keys</span>()

  <span class="ruby-comment"># Enable the meta key, if this terminal has one.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_enable_meta</span>
    <span class="ruby-identifier">_rl_enable_meta_key</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If the completion parser&#39;s default word break characters haven&#39;t</span>
  <span class="ruby-comment">#   been set yet, then do so now.</span>
  <span class="ruby-ivar">@rl_completer_word_break_characters</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@rl_basic_word_break_characters</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline_internal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline_internal</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Read a line of input from the global <a
href="RbReadline.html#attribute-i-rl_instream">#rl_instream</a>, doing
output on</p>

<pre>the global rl_outstream.
If rl_prompt is non-null, then that is our prompt.</pre>
          
          

          
          <div class="method-source-code" id="readline_internal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4798</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline_internal</span>()
  <span class="ruby-identifier">readline_internal_setup</span>()
  <span class="ruby-identifier">eof</span> = <span class="ruby-identifier">readline_internal_charloop</span>()
  <span class="ruby-identifier">readline_internal_teardown</span>(<span class="ruby-identifier">eof</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline_internal_charloop" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline_internal_charloop</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="readline_internal_charloop-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4687</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline_internal_charloop</span>()
  <span class="ruby-identifier">lastc</span> = <span class="ruby-value">-1</span>
  <span class="ruby-identifier">eof_found</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-keyword">while</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_done</span>)
    <span class="ruby-identifier">lk</span> = <span class="ruby-ivar">@_rl_last_command_was_kill</span>

    <span class="ruby-comment">#  send(rl_redisplay_function)</span>
    <span class="ruby-comment">#  @_rl_want_redisplay = false</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_pending_input</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-comment"># Then initialize the argument and number of keys read.</span>
      <span class="ruby-identifier">_rl_reset_argument</span>()
      <span class="ruby-ivar">@rl_key_sequence_length</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_READCMD</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">rl_read_key</span>()
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_READCMD</span>)
    <span class="ruby-comment"># look at input.c:rl_getc() for the circumstances under which this will</span>
    <span class="ruby-comment">#be returned; punt immediately on read error without converting it to</span>
    <span class="ruby-comment">#a newline.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">READERR</span>)
      <span class="ruby-identifier">eof_found</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># EOF typed to a non-blank line is a &lt;NL&gt;.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EOF</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_end</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">c</span> = <span class="ruby-constant">NEWLINE</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># The character _rl_eof_char typed to blank line, and not as the</span>
    <span class="ruby-comment">#previous character is interpreted as EOF.</span>
    <span class="ruby-keyword">if</span> (((<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_eof_char</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lastc</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">c</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EOF</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_end</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">eof_found</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">lastc</span> = <span class="ruby-identifier">c</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">_rl_dispatch</span>(<span class="ruby-identifier">c</span>, <span class="ruby-ivar">@_rl_keymap</span>)<span class="ruby-operator">==</span> <span class="ruby-value">-1</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># If there was no change in _rl_last_command_was_kill, then no kill</span>
    <span class="ruby-comment">#has taken place.  Note that if input is pending we are reading</span>
    <span class="ruby-comment">#a prefix command, so nothing has changed yet.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_pending_input</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lk</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_last_command_was_kill</span>)
      <span class="ruby-ivar">@_rl_last_command_was_kill</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">_rl_internal_char_cleanup</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">eof_found</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline_internal_setup" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline_internal_setup</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="readline_internal_setup-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3929</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline_internal_setup</span>()
  <span class="ruby-ivar">@_rl_in_stream</span> = <span class="ruby-ivar">@rl_instream</span>
  <span class="ruby-ivar">@_rl_out_stream</span> = <span class="ruby-ivar">@rl_outstream</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_startup_hook</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_startup_hook</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we&#39;re not echoing, we still want to at least print a prompt, because</span>
  <span class="ruby-comment">#   rl_redisplay will not do it for us.  If the calling application has a</span>
  <span class="ruby-comment">#   custom redisplay function, though, let that function handle it.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@readline_echoing_p</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_redisplay_function</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_redisplay</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_already_prompted</span>)
      <span class="ruby-identifier">nprompt</span> = <span class="ruby-identifier">_rl_strip_prompt</span>(<span class="ruby-ivar">@rl_prompt</span>)
      <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">nprompt</span>)
      <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">flush</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_already_prompted</span>)
      <span class="ruby-identifier">rl_on_new_line_with_prompt</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_on_new_line</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-identifier">rl_vi_insertion_mode</span>(<span class="ruby-value">1</span>, <span class="ruby-string">&#39;i&#39;</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_pre_input_hook</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_pre_input_hook</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline_internal_teardown" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline_internal_teardown</span><span
            class="method-args">(eof)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="readline_internal_teardown-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4769</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline_internal_teardown</span>(<span class="ruby-identifier">eof</span>)
  <span class="ruby-comment"># Restore the original of this history line, iff the line that we</span>
  <span class="ruby-comment">#   are editing was originally in the history, AND the line has changed.</span>
  <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">current_history</span>()

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">entry</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_undo_list</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>).<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">rl_revert_line</span>(<span class="ruby-value">1</span>, <span class="ruby-value">0</span>)
    <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">replace_history_entry</span>(<span class="ruby-identifier">where_history</span>(), <span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-keyword">nil</span>)
    <span class="ruby-identifier">entry</span> = <span class="ruby-keyword">nil</span>

    <span class="ruby-ivar">@rl_line_buffer</span> = <span class="ruby-identifier">temp</span><span class="ruby-operator">+</span><span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-identifier">temp</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># At any rate, it is highly likely that this line has an undo list.  Get</span>
  <span class="ruby-comment">#   rid of it now.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_undo_list</span>)
    <span class="ruby-identifier">rl_free_undo_list</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Restore normal cursor, if available.</span>
  <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-constant">RL_IM_INSERT</span>, <span class="ruby-value">0</span>)

  (<span class="ruby-identifier">eof</span> <span class="ruby-operator">?</span> <span class="ruby-keyword">nil</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-redraw_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">redraw_prompt</span><span
            class="method-args">(t)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Redraw the last line of a multi-line prompt that may possibly contain
terminal escape sequences.  Called with the cursor at column 0 of the line
to draw the prompt on.</p>
          
          

          
          <div class="method-source-code" id="redraw_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8781</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">redraw_prompt</span>(<span class="ruby-identifier">t</span>)
  <span class="ruby-identifier">oldp</span> = <span class="ruby-ivar">@rl_display_prompt</span>
  <span class="ruby-identifier">rl_save_prompt</span>()

  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-identifier">t</span>
  <span class="ruby-ivar">@local_prompt</span>,<span class="ruby-ivar">@prompt_visible_length</span>,<span class="ruby-ivar">@prompt_last_invisible</span>,<span class="ruby-ivar">@prompt_invis_chars_first_line</span>,<span class="ruby-ivar">@prompt_physical_chars</span> =
    <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">t</span>)
  <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-ivar">@local_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@local_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>

  <span class="ruby-identifier">rl_forced_update_display</span>()

  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-identifier">oldp</span>
  <span class="ruby-identifier">rl_restore_prompt</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-release_sigint" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">release_sigint</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="release_sigint-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6895</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">release_sigint</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@sigint_blocked</span>
  <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">trap</span>(<span class="ruby-string">&quot;INT&quot;</span>, <span class="ruby-ivar">@sigint_proc</span>)
  <span class="ruby-ivar">@sigint_blocked</span> = <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_duplicate_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_duplicate_matches</span><span
            class="method-args">(matches)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Filter out duplicates in MATCHES.  This frees up the strings in</p>

<pre>MATCHES.</pre>
          
          

          
          <div class="method-source-code" id="remove_duplicate_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6290</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_duplicate_matches</span>(<span class="ruby-identifier">matches</span>)
  <span class="ruby-comment"># Sort the items.</span>
  <span class="ruby-comment"># Sort the array without matches[0], since we need it to</span>
  <span class="ruby-comment">#   stay in place no matter what.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
    <span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>] = <span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-2</span>].<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">uniq</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">matches</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-remove_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">remove_history</span><span
            class="method-args">(which)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Remove history element WHICH from the history.  The removed</p>

<pre>element is returned to you so you can free the line, data,
and containing structure.</pre>
          
          

          
          <div class="method-source-code" id="remove_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6879</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">remove_history</span>(<span class="ruby-identifier">which</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">which</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">which</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@history_length</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@history_length</span> <span class="ruby-operator">==</span>  <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">return_value</span> = <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">which</span>]
  <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">delete_at</span>(<span class="ruby-identifier">which</span>)
  <span class="ruby-ivar">@history_length</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-identifier">return_value</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-replace_history_data" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">replace_history_data</span><span
            class="method-args">(which,old, new)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Replace the DATA in the specified history entries, replacing OLD with</p>

<pre>NEW.  WHICH says which one(s) to replace:  WHICH == -1 means to replace
all of the history entries where entry-&gt;data == OLD; WHICH == -2 means
to replace the `newest&#39; history entry where entry-&gt;data == OLD; and
WHICH &gt;= 0 means to replace that particular history entry&#39;s data, as
long as it matches OLD.</pre>
          
          

          
          <div class="method-source-code" id="replace_history_data-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5005</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">replace_history_data</span>(<span class="ruby-identifier">which</span>,<span class="ruby-identifier">old</span>, <span class="ruby-identifier">new</span>)
  <span class="ruby-identifier">new</span> = <span class="ruby-identifier">new</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">new</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">which</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">-2</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">which</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@history_length</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@history_length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">which</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">entry</span> = <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">which</span>]
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">entry</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">data</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">old</span>)
      <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">data</span> = <span class="ruby-identifier">new</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">last</span> = <span class="ruby-value">-1</span>
  <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-ivar">@history_length</span>
    <span class="ruby-identifier">entry</span> = <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">i</span>]
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">data</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">old</span>)
      <span class="ruby-identifier">last</span> = <span class="ruby-identifier">i</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">which</span> <span class="ruby-operator">==</span> <span class="ruby-value">-1</span>)
        <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">data</span> = <span class="ruby-identifier">new</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">which</span> <span class="ruby-operator">==</span> <span class="ruby-value">-2</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">last</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">entry</span> = <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">last</span>]
    <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">data</span> = <span class="ruby-identifier">new</span>  <span class="ruby-comment"># XXX - we don&#39;t check entry-&gt;old</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-replace_history_entry" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">replace_history_entry</span><span
            class="method-args">(which, line, data)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Make the history entry at WHICH have LINE and DATA.  This returns</p>

<pre>the old entry so you can dispose of the data.  In the case of an
invalid WHICH, a NULL pointer is returned.</pre>
          
          

          
          <div class="method-source-code" id="replace_history_entry-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5359</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">replace_history_entry</span> (<span class="ruby-identifier">which</span>, <span class="ruby-identifier">line</span>, <span class="ruby-identifier">data</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">which</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">which</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@history_length</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">temp</span> = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:line</span>,<span class="ruby-value">:timestamp</span>,<span class="ruby-value">:data</span>).<span class="ruby-identifier">new</span>
  <span class="ruby-identifier">old_value</span> = <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">which</span>]
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">line</span> = <span class="ruby-identifier">line</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">data</span> = <span class="ruby-identifier">data</span>
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">old_value</span>.<span class="ruby-identifier">timestamp</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-ivar">@the_history</span>[<span class="ruby-identifier">which</span>] = <span class="ruby-identifier">temp</span>
  <span class="ruby-identifier">old_value</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-retry_if_interrupted" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">retry_if_interrupted</span><span
            class="method-args">() { |block| ... }</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="retry_if_interrupted-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6901</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">retry_if_interrupted</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
  <span class="ruby-identifier">tries</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">yield</span> <span class="ruby-identifier">block</span>
  <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EINTR</span>
    <span class="ruby-identifier">tries</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">retry</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">tries</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">10</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_abort" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_abort</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_abort-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4758</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_abort</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_abort_internal</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_add_undo" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_add_undo</span><span
            class="method-args">(what, start, _end, text)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <ul><li>
<p>Remember how to undo something.  Concatenate some undos if that</p>

<pre>seems right.</pre>
</li></ul>
          
          

          
          <div class="method-source-code" id="rl_add_undo-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4889</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-identifier">what</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">text</span>)
  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">alloc_undo_entry</span>(<span class="ruby-identifier">what</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">text</span>)
  <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">next</span> = <span class="ruby-ivar">@rl_undo_list</span>
  <span class="ruby-ivar">@rl_undo_list</span> = <span class="ruby-identifier">temp</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_alphabetic" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_alphabetic</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_alphabetic-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5157</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_alphabetic</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\w/</span>
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-ivar">@_rl_allow_pathname_alphabetic_chars</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-ivar">@pathname_alphabetic_chars</span>[<span class="ruby-identifier">c</span>])
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_arrow_keys" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_arrow_keys</span><span
            class="method-args">(count, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_arrow_keys-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5488</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_arrow_keys</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>)
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)
  <span class="ruby-identifier">ch</span> = <span class="ruby-identifier">rl_read_key</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_MOREINPUT</span>)

  <span class="ruby-keyword">case</span> (<span class="ruby-identifier">ch</span>.<span class="ruby-identifier">upcase</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;A&#39;</span>
    <span class="ruby-identifier">rl_get_previous_history</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ch</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;B&#39;</span>
    <span class="ruby-identifier">rl_get_next_history</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ch</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;C&#39;</span>
    <span class="ruby-identifier">rl_forward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ch</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;D&#39;</span>
    <span class="ruby-identifier">rl_backward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ch</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Backwards compatibility.</p>
          
          

          
          <div class="method-source-code" id="rl_backward-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5134</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_backward_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward_byte" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward_byte</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move backward COUNT bytes.</p>
          
          

          
          <div class="method-source-code" id="rl_backward_byte-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5089</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_forward_byte</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">count</span>)
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">count</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward_char</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move backward COUNT characters.</p>
          
          

          
          <div class="method-source-code" id="rl_backward_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5109</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_backward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_forward_char</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">point</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">point</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
      <span class="ruby-identifier">count</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward_char_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward_char_search</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_backward_char_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7728</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward_char_search</span> (<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_char_search</span>(<span class="ruby-identifier">count</span>, <span class="ruby-constant">BFIND</span>, <span class="ruby-constant">FFIND</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward_kill_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward_kill_line</span><span
            class="method-args">(direction, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Kill backwards to the start of the line.  If DIRECTION is negative, kill</p>

<pre>forwards to the line end instead.</pre>
          
          

          
          <div class="method-source-code" id="rl_backward_kill_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7103</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward_kill_line</span>(<span class="ruby-identifier">direction</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">direction</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_kill_line</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">ignore</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
      <span class="ruby-identifier">rl_beg_of_line</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">ignore</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">orig_point</span>)
        <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
        <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward_kill_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward_kill_word</span><span
            class="method-args">(count, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Rubout the word before point, placing it on the kill ring.</p>
          
          

          
          <div class="method-source-code" id="rl_backward_kill_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7697</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward_kill_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_kill_word</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-identifier">rl_backward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">orig_point</span>)
      <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
      <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_backward_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_backward_word</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move backward a word.  We do what Emacs does.  Handles multibyte chars.</p>
          
          

          
          <div class="method-source-code" id="rl_backward_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5226</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_backward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_forward_word</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)

    <span class="ruby-comment"># Like rl_forward_word (), except that we look at the characters</span>
    <span class="ruby-comment"># just before point.</span>
    <span class="ruby-identifier">_p</span> =  <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)<span class="ruby-operator">:</span>(<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">_p</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_p</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">_p</span> = <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)<span class="ruby-operator">:</span>(<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)
        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">_p</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_p</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
      <span class="ruby-identifier">_p</span> = <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)<span class="ruby-operator">:</span>(<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>)
      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">_p</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_p</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_beg_of_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_beg_of_line</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move to the beginning of the line.</p>
          
          

          
          <div class="method-source-code" id="rl_beg_of_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5139</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_beg_of_line</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_begin_undo_group" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_begin_undo_group</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Begin a group.  Subsequent undos are undone as an atomic operation.</p>
          
          

          
          <div class="method-source-code" id="rl_begin_undo_group-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4956</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_begin_undo_group</span>()
  <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-constant">UNDO_BEGIN</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>, <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@_rl_undo_group_level</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_beginning_of_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_beginning_of_history</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Meta-&lt; goes to the start of the history.</p>
          
          

          
          <div class="method-source-code" id="rl_beginning_of_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7863</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_beginning_of_history</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_get_previous_history</span>(<span class="ruby-value">1</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">where_history</span>(), <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_bind_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_bind_key</span><span
            class="method-args">(key, function)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bind KEY to FUNCTION.  Returns non-zero if KEY is out of range.</p>
          
          

          
          <div class="method-source-code" id="rl_bind_key-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2389</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_bind_key</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">function</span>)
  <span class="ruby-ivar">@_rl_keymap</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">function</span>
  <span class="ruby-ivar">@rl_binding_keymap</span> = <span class="ruby-ivar">@_rl_keymap</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_bind_keyseq_if_unbound" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_bind_keyseq_if_unbound</span><span
            class="method-args">(keyseq, default_func)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_bind_keyseq_if_unbound-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1946</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_bind_keyseq_if_unbound</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">default_func</span>)
  <span class="ruby-identifier">rl_bind_keyseq_if_unbound_in_map</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">default_func</span>, <span class="ruby-ivar">@_rl_keymap</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_bind_keyseq_if_unbound_in_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_bind_keyseq_if_unbound_in_map</span><span
            class="method-args">(keyseq, default_func, kmap)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bind key sequence KEYSEQ to DEFAULT_FUNC if KEYSEQ is unbound.  Right</p>

<pre>now, this is always used to attempt to bind the arrow keys, hence the
check for rl_vi_movement_mode.</pre>
          
          

          
          <div class="method-source-code" id="rl_bind_keyseq_if_unbound_in_map-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1934</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_bind_keyseq_if_unbound_in_map</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">default_func</span>, <span class="ruby-identifier">kmap</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">keyseq</span>)
    <span class="ruby-identifier">func</span> = <span class="ruby-identifier">rl_function_of_keyseq</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">kmap</span>, <span class="ruby-keyword">nil</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">func</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">func</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_vi_movement_mode</span>)
      <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_bind_keyseq_in_map</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">default_func</span>, <span class="ruby-identifier">kmap</span>))
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_bind_keyseq_in_map" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_bind_keyseq_in_map</span><span
            class="method-args">(keyseq, function, map)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bind the key sequence represented by the string KEYSEQ to</p>

<pre>FUNCTION.  This makes new keymaps as necessary.  The initial
place to do bindings is in MAP.</pre>
          
          

          
          <div class="method-source-code" id="rl_bind_keyseq_in_map-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1926</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_bind_keyseq_in_map</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">function</span>, <span class="ruby-identifier">map</span>)
  <span class="ruby-identifier">rl_generic_bind</span>(<span class="ruby-constant">ISFUNC</span>, <span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">function</span>, <span class="ruby-identifier">map</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_capitalize_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_capitalize_word</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Upcase the first letter, downcase the rest.</p>
          
          

          
          <div class="method-source-code" id="rl_capitalize_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7886</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_capitalize_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_change_case</span>(<span class="ruby-identifier">count</span>, <span class="ruby-constant">CapCase</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_change_case" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_change_case</span><span
            class="method-args">(count, op)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The meaty function.</p>

<pre>Change the case of COUNT words, performing OP on them.
OP is one of UpCase, DownCase, or CapCase.
If a negative argument is given, leave point where it started,
otherwise, leave it where it moves to.</pre>
          
          

          
          <div class="method-source-code" id="rl_change_case-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7911</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_change_case</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">op</span>)
  <span class="ruby-identifier">start</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">rl_forward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-value">0</span>)
  <span class="ruby-identifier">_end</span> = <span class="ruby-ivar">@rl_point</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">op</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">UpCase</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">op</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">DownCase</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">op</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">CapCase</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">start</span>,<span class="ruby-identifier">_end</span> = <span class="ruby-identifier">_end</span>,<span class="ruby-identifier">start</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># We are going to modify some text, so let&#39;s prepare to undo it.</span>
  <span class="ruby-identifier">rl_modifying</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)

  <span class="ruby-identifier">inword</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">start</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">_end</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">start</span>)
    <span class="ruby-comment">#  This assumes that the upper and lower case versions are the same width.</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-identifier">_next</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-identifier">start</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_next</span> = <span class="ruby-identifier">start</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
      <span class="ruby-identifier">inword</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">start</span> = <span class="ruby-identifier">_next</span>
      <span class="ruby-keyword">next</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">op</span> <span class="ruby-operator">==</span> <span class="ruby-constant">CapCase</span>)
      <span class="ruby-identifier">nop</span> = <span class="ruby-identifier">inword</span> <span class="ruby-operator">?</span> <span class="ruby-constant">DownCase</span> <span class="ruby-operator">:</span> <span class="ruby-constant">UpCase</span>
      <span class="ruby-identifier">inword</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">nop</span> = <span class="ruby-identifier">op</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">isascii</span>(<span class="ruby-identifier">c</span>))
      <span class="ruby-identifier">nc</span> = (<span class="ruby-identifier">nop</span> <span class="ruby-operator">==</span> <span class="ruby-constant">UpCase</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">downcase</span>
      <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span>] = <span class="ruby-identifier">nc</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">start</span> = <span class="ruby-identifier">_next</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_char_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_char_search</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_char_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7598</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_char_search</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_char_search</span>(<span class="ruby-identifier">count</span>, <span class="ruby-constant">FFIND</span>, <span class="ruby-constant">BFIND</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_character_len" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_character_len</span><span
            class="method-args">(c, pos)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_character_len-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5740</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_character_len</span>(<span class="ruby-identifier">c</span>, <span class="ruby-identifier">pos</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">meta_char</span>(<span class="ruby-identifier">c</span>))
    <span class="ruby-keyword">return</span> ((<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_output_meta_chars</span>) <span class="ruby-operator">?</span> <span class="ruby-value">4</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\t&quot;</span>)
    <span class="ruby-keyword">return</span> (((<span class="ruby-identifier">pos</span> <span class="ruby-operator">|</span> <span class="ruby-value">7</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">pos</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RUBOUT</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-value">2</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> ((<span class="ruby-identifier">isprint</span>(<span class="ruby-identifier">c</span>)) <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-value">2</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_cleanup_after_signal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_cleanup_after_signal</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clean up the terminal and readline state after catching a signal, before</p>

<pre>resending it to the calling application.</pre>
          
          

          
          <div class="method-source-code" id="rl_cleanup_after_signal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1507</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_cleanup_after_signal</span>()
  <span class="ruby-identifier">_rl_clean_up_for_exit</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_deprep_term_function</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_deprep_term_function</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_clear_pending_input</span>()
  <span class="ruby-identifier">rl_clear_signals</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_clear_message" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_clear_message</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>How to clear things from the echo-area.</p>
          
          

          
          <div class="method-source-code" id="rl_clear_message-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4248</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_clear_message</span>()
  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-ivar">@rl_prompt</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@msg_saved_prompt</span>)
    <span class="ruby-identifier">rl_restore_prompt</span>()
    <span class="ruby-ivar">@msg_saved_prompt</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_clear_pending_input" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_clear_pending_input</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clear any pending input pushed with <a
href="RbReadline.html#method-i-rl_execute_next">#rl_execute_next</a>()</p>
          
          

          
          <div class="method-source-code" id="rl_clear_pending_input-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1646</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_clear_pending_input</span>()
  <span class="ruby-ivar">@rl_pending_input</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_INPUTPENDING</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_clear_screen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_clear_screen</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>C-l typed to a line without quoting clears the screen, and then reprints</p>

<pre>the prompt and the current input line.  Given a numeric arg, redraw only
the current line.</pre>
          
          

          
          <div class="method-source-code" id="rl_clear_screen-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5312</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_clear_screen</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-identifier">rl_refresh_line</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">_rl_clear_screen</span>()      <span class="ruby-comment"># calls termcap function to clear screen</span>
  <span class="ruby-identifier">rl_forced_update_display</span>()
  <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_clear_signals" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_clear_signals</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_clear_signals-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1656</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_clear_signals</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>[<span class="ruby-string">&#39;WINCH&#39;</span>]
    <span class="ruby-identifier">trap</span> <span class="ruby-string">&quot;WINCH&quot;</span>,<span class="ruby-ivar">@def_proc</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_complete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_complete</span><span
            class="method-args">(ignore, invoking_key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Complete the word at or before point.  You have supplied the function</p>

<pre>that does the initial simple matching selection algorithm (see
rl_completion_matches ()).  The default is to do filename completion.</pre>
          
          

          
          <div class="method-source-code" id="rl_complete-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6840</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_complete</span>(<span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">invoking_key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_inhibit_completion</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">invoking_key</span>))
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_last_func</span> <span class="ruby-operator">==</span> <span class="ruby-value">:rl_complete</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@completion_changed_buffer</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-string">&#39;?&#39;</span>))
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@_rl_complete_show_all</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-string">&#39;!&#39;</span>))
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@_rl_complete_show_unmodified</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-string">&#39;@&#39;</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-constant">TAB</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_complete_internal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_complete_internal</span><span
            class="method-args">(what_to_do)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Complete the word at or before point.</p>

<pre>WHAT_TO_DO says what to do with the completion.
`?&#39; means list the possible completions.
TAB means do standard completion.
`*&#39; means insert all of the possible completions.
`!&#39; means to do standard completion, and list all possible completions if
there is more than one.
`@&#39; means to do standard completion, and list all possible completions if
there is more than one and partial completion is not possible.</pre>
          
          

          
          <div class="method-source-code" id="rl_complete_internal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6737</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-identifier">what_to_do</span>)
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_COMPLETING</span>)
  <span class="ruby-identifier">set_completion_defaults</span>(<span class="ruby-identifier">what_to_do</span>)

  <span class="ruby-identifier">saved_line_buffer</span> = <span class="ruby-ivar">@rl_line_buffer</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">our_func</span> = <span class="ruby-ivar">@rl_completion_entry_function</span> <span class="ruby-operator">?</span>
    <span class="ruby-ivar">@rl_completion_entry_function</span> <span class="ruby-operator">:</span> <span class="ruby-value">:rl_filename_completion_function</span>
  <span class="ruby-comment"># We now look backwards for the start of a filename/variable word.</span>
  <span class="ruby-identifier">_end</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">found_quote</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">delimiter</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-identifier">quote_char</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
    <span class="ruby-comment"># This (possibly) changes rl_point.  If it returns a non-zero char,</span>
    <span class="ruby-comment">#   we know we have an open quote.</span>
    <span class="ruby-identifier">quote_char</span>,<span class="ruby-identifier">found_quote</span>,<span class="ruby-identifier">delimiter</span> = <span class="ruby-identifier">_rl_find_completion_word</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">start</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_end</span>

  <span class="ruby-identifier">text</span> = <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
  <span class="ruby-identifier">matches</span> = <span class="ruby-identifier">gen_completion_matches</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">our_func</span>, <span class="ruby-identifier">found_quote</span>, <span class="ruby-identifier">quote_char</span>)
  <span class="ruby-comment"># nontrivial_lcd is set if the common prefix adds something to the word</span>
  <span class="ruby-comment">#   being completed.</span>
  <span class="ruby-identifier">nontrivial_lcd</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">matches</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">text</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>])
  <span class="ruby-identifier">text</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">matches</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">saved_line_buffer</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@completion_changed_buffer</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_COMPLETING</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we are matching filenames, the attempted completion function will</span>
  <span class="ruby-comment">#   have set rl_filename_completion_desired to a non-zero value.  The basic</span>
  <span class="ruby-comment">#   rl_filename_completion_function does this.</span>
  <span class="ruby-identifier">i</span> = <span class="ruby-ivar">@rl_filename_completion_desired</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">postprocess_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">i</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">saved_line_buffer</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@completion_changed_buffer</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_COMPLETING</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">case</span> (<span class="ruby-identifier">what_to_do</span>)

  <span class="ruby-keyword">when</span> <span class="ruby-constant">TAB</span>,<span class="ruby-string">&#39;!&#39;</span>,<span class="ruby-string">&#39;@&#39;</span>
    <span class="ruby-comment"># Insert the first match with proper quoting.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>])
      <span class="ruby-identifier">insert_match</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">start</span>, <span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">?</span> <span class="ruby-constant">MULT_MATCH</span> <span class="ruby-operator">:</span> <span class="ruby-constant">SINGLE_MATCH</span>, <span class="ruby-identifier">quote_char</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># If there are more matches, ring the bell to indicate.</span>
  <span class="ruby-comment"># If we are in vi mode, Posix.2 says to not ring the bell.</span>
  <span class="ruby-comment"># If the `show-all-if-ambiguous&#39; variable is set, display</span>
  <span class="ruby-comment"># all the matches immediately.  Otherwise, if this was the</span>
  <span class="ruby-comment"># only match, and we are hacking files, check the file to</span>
  <span class="ruby-comment"># see if it was a directory.  If so, and the `mark-directories&#39;</span>
  <span class="ruby-comment"># variable is set, add a &#39;/&#39; to the name.  If not, and we</span>
  <span class="ruby-comment"># are at the end of the line, then add a space.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span>])
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">what_to_do</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;!&#39;</span>)
      <span class="ruby-identifier">display_matches</span>(<span class="ruby-identifier">matches</span>)
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">what_to_do</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;@&#39;</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">nontrivial_lcd</span>)
        <span class="ruby-identifier">display_matches</span>(<span class="ruby-identifier">matches</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@vi_mode</span>)
      <span class="ruby-identifier">rl_ding</span>()   <span class="ruby-comment"># There are other matches remaining.</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">append_to_match</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">delimiter</span>, <span class="ruby-identifier">quote_char</span>, <span class="ruby-identifier">nontrivial_lcd</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;*&#39;</span>
    <span class="ruby-identifier">insert_all_matches</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">quote_char</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;?&#39;</span>
    <span class="ruby-identifier">display_matches</span>(<span class="ruby-identifier">matches</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">write</span>(<span class="ruby-node">&quot;\r\nreadline: bad value #{what_to_do} for what_to_do in rl_complete\n&quot;</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">saved_line_buffer</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_COMPLETING</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">matches</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Check to see if the line has changed through all of this manipulation.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">saved_line_buffer</span>)
    <span class="ruby-ivar">@completion_changed_buffer</span> = <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>) <span class="ruby-operator">!=</span> <span class="ruby-identifier">saved_line_buffer</span>
    <span class="ruby-identifier">saved_line_buffer</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_COMPLETING</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_completion_matches" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_completion_matches</span><span
            class="method-args">(text, entry_function)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return an array of (char *) which is a list of completions for TEXT.</p>

<pre>If there are no completions, return a NULL pointer.
The first entry in the returned array is the substitution for TEXT.
The remaining entries are the possible completions.
The array is terminated with a NULL pointer.

ENTRY_FUNCTION is a function of two args, and returns a (char *).
  The first argument is TEXT.
  The second is a state argument it should be zero on the first call, and
  non-zero on subsequent calls.  It returns a NULL pointer to the caller
  when there are no more matches.</pre>
          
          

          
          <div class="method-source-code" id="rl_completion_matches-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1291</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_completion_matches</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">entry_function</span>)
  <span class="ruby-identifier">matches</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">match_list</span> = []
  <span class="ruby-identifier">match_list</span>[<span class="ruby-value">1</span>] = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">string</span> = <span class="ruby-identifier">send</span>(<span class="ruby-identifier">entry_function</span>, <span class="ruby-identifier">text</span>, <span class="ruby-identifier">matches</span>))
    <span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">matches</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">string</span>
    <span class="ruby-identifier">match_list</span>[<span class="ruby-identifier">matches</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If there were any matches, then look through them finding out the</span>
  <span class="ruby-comment"># lowest common denominator.  That then becomes match_list[0].</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches!</span>=<span class="ruby-value">0</span>)
    <span class="ruby-identifier">compute_lcd_of_matches</span>(<span class="ruby-identifier">match_list</span>, <span class="ruby-identifier">matches</span>, <span class="ruby-identifier">text</span>)
  <span class="ruby-keyword">else</span>                <span class="ruby-comment"># There were no matches.</span>
    <span class="ruby-identifier">match_list</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">match_list</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_copy_text" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_copy_text</span><span
            class="method-args">(from, to)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_copy_text-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4930</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">from</span><span class="ruby-operator">...</span><span class="ruby-identifier">to</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_crlf" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_crlf</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move to the start of the next line.</p>
          
          

          
          <div class="method-source-code" id="rl_crlf-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4638</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_crlf</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_delete</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete the character under the cursor.  Given a numeric argument,</p>

<pre>kill that many characters instead.</pre>
          
          

          
          <div class="method-source-code" id="rl_delete-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5850</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_delete</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_rubout_char</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-identifier">xpoint</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-identifier">rl_forward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)

    <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">xpoint</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">xpoint</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-identifier">xpoint</span> =<span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">xpoint</span> = <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-identifier">xpoint</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_delete_horizontal_space" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_delete_horizontal_space</span><span
            class="method-args">(count, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete all spaces and tabs around point.</p>
          
          

          
          <div class="method-source-code" id="rl_delete_horizontal_space-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6022</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_delete_horizontal_space</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-identifier">start</span> = <span class="ruby-ivar">@rl_point</span>

  <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>]))
    <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">start</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>]))
    <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">start</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">start</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">start</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_delete_or_show_completions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_delete_or_show_completions</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Like the tcsh editing function delete-char-or-list.  The eof character</p>

<pre>is caught before this is invoked, so this really does the same thing as
delete-char-or-list-or-eof, as long as it&#39;s bound to the eof character.</pre>
          
          

          
          <div class="method-source-code" id="rl_delete_or_show_completions-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6050</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_delete_or_show_completions</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_possible_completions</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_delete</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_delete_text" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_delete_text</span><span
            class="method-args">(from, to)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete the string between FROM and TO.  FROM is inclusive, TO is not.</p>

<pre>Returns the number of characters deleted.</pre>
          
          

          
          <div class="method-source-code" id="rl_delete_text-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4898</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)

  <span class="ruby-comment"># Fix it if the caller is confused.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">from</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">to</span>)
    <span class="ruby-identifier">from</span>,<span class="ruby-identifier">to</span> = <span class="ruby-identifier">to</span>,<span class="ruby-identifier">from</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># fix boundaries</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">to</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-identifier">to</span> = <span class="ruby-ivar">@rl_end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">from</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">to</span>)
      <span class="ruby-identifier">from</span> = <span class="ruby-identifier">to</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">from</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">from</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">text</span> = <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)
  <span class="ruby-identifier">diff</span> = <span class="ruby-identifier">to</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">from</span>
  <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">from</span><span class="ruby-operator">...</span><span class="ruby-identifier">to</span>] = <span class="ruby-string">&#39;&#39;</span>
  <span class="ruby-ivar">@rl_line_buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">diff</span>
  <span class="ruby-comment"># Remember how to undo this delete.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_doing_an_undo</span>)
    <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-constant">UNDO_DELETE</span>, <span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>, <span class="ruby-identifier">text</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">text</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">diff</span>
  <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_end</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">diff</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_deprep_terminal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_deprep_terminal</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Restore the terminal&#39;s normal settings and modes.</p>
          
          

          
          <div class="method-source-code" id="rl_deprep_terminal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7046</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_deprep_terminal</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;TERM&quot;</span>].<span class="ruby-identifier">nil?</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@terminal_prepped</span>)

  <span class="ruby-comment"># Try to keep this function from being interrupted.</span>
  <span class="ruby-identifier">block_sigint</span>()

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_enable_keypad</span>)
    <span class="ruby-identifier">_rl_control_keypad</span>(<span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>

  <span class="ruby-comment"># restore terminal setting</span>
  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-node">%xstty #{@otio}`</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@terminal_prepped</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_TERMPREPPED</span>)

  <span class="ruby-identifier">release_sigint</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_digit_argument" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_digit_argument</span><span
            class="method-args">(ignore, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Start a numeric argument with initial value KEY</p>
          
          

          
          <div class="method-source-code" id="rl_digit_argument-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7843</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_digit_argument</span>(<span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_arg_init</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_CALLBACK</span>))
    <span class="ruby-identifier">_rl_arg_dispatch</span>(<span class="ruby-ivar">@_rl_argcxt</span>, <span class="ruby-identifier">key</span>)
    <span class="ruby-identifier">rl_message</span>(<span class="ruby-node">&quot;(arg: #{@rl_arg_sign * @rl_numeric_arg}) &quot;</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_execute_next</span>(<span class="ruby-identifier">key</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_digit_loop</span>())
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_digit_loop" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_digit_loop</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Handle C-u style numeric args, as well as M, and M-digits.</p>
          
          

          
          <div class="method-source-code" id="rl_digit_loop-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7827</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_digit_loop</span>()
  <span class="ruby-keyword">while</span> (<span class="ruby-keyword">true</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">_rl_arg_overflow</span>()<span class="ruby-operator">!=</span><span class="ruby-value">0</span>
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_arg_getchar</span>()
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-string">&quot;\xFE&quot;</span>)
      <span class="ruby-identifier">_rl_abort_internal</span>()
      <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">_rl_arg_dispatch</span>(<span class="ruby-ivar">@_rl_argcxt</span>, <span class="ruby-identifier">c</span>)
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">r</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_NUMERICARG</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_ding" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_ding</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Ring the terminal bell.</p>
          
          

          
          <div class="method-source-code" id="rl_ding-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3971</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@MessageBeep</span>
    <span class="ruby-ivar">@MessageBeep</span>.<span class="ruby-constant">Call</span>(<span class="ruby-value">0</span>)
  <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@readline_echoing_p</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_bell_preference</span> <span class="ruby-operator">==</span> <span class="ruby-constant">VISIBLE_BELL</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_visible_bell</span>)
        <span class="ruby-ivar">@_rl_out_stream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_visible_bell</span>.<span class="ruby-identifier">chr</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;\007&quot;</span>)
        <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">flush</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-ivar">@_rl_bell_preference</span> <span class="ruby-operator">==</span> <span class="ruby-constant">AUDIBLE_BELL</span>
      <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&quot;\007&quot;</span>)
      <span class="ruby-identifier">$stderr</span>.<span class="ruby-identifier">flush</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_display_match_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_display_match_list</span><span
            class="method-args">(matches, len, max)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A convenience function for displaying a list of strings in</p>

<pre>columnar format on readline&#39;s output stream.  MATCHES is the list
of strings, in argv format, LEN is the number of strings in MATCHES,
and MAX is the length of the longest string in MATCHES.</pre>
          
          

          
          <div class="method-source-code" id="rl_display_match_list-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8330</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_display_match_list</span>(<span class="ruby-identifier">matches</span>, <span class="ruby-identifier">len</span>, <span class="ruby-identifier">max</span>)
  <span class="ruby-comment"># How many items of MAX length can we fit in the screen window?</span>
  <span class="ruby-identifier">max</span> <span class="ruby-operator">+=</span> <span class="ruby-value">2</span>
  <span class="ruby-identifier">limit</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">max</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">limit</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">limit</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">max</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_screenwidth</span>))
    <span class="ruby-identifier">limit</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Avoid a possible floating exception.  If max &gt; _rl_screenwidth,</span>
  <span class="ruby-comment">#   limit will be 0 and a divide-by-zero fault will result.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">limit</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">limit</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># How many iterations of the printing loop?</span>
  <span class="ruby-identifier">count</span> = (<span class="ruby-identifier">len</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">limit</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)) <span class="ruby-operator">/</span> <span class="ruby-identifier">limit</span>

  <span class="ruby-comment"># Watch out for special case.  If LEN is less than LIMIT, then</span>
  <span class="ruby-comment">#   just do the inner printing loop.</span>
  <span class="ruby-comment">#     0 &lt; len &lt;= limit  implies  count = 1.</span>

  <span class="ruby-comment"># Sort the items if they are not already sorted.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_ignore_completion_duplicates</span>)
    <span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span>,<span class="ruby-identifier">len</span>] = <span class="ruby-identifier">matches</span>[<span class="ruby-value">1</span>,<span class="ruby-identifier">len</span>].<span class="ruby-identifier">sort</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_crlf</span>()

  <span class="ruby-identifier">lines</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_print_completions_horizontally</span>)
    <span class="ruby-comment"># Print the sorted items, up-and-down alphabetically, like ls.</span>
    <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">1</span> <span class="ruby-operator">..</span> <span class="ruby-identifier">count</span>
      <span class="ruby-identifier">l</span> = <span class="ruby-identifier">i</span>
      <span class="ruby-keyword">for</span> <span class="ruby-identifier">j</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">limit</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">l</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">len</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">matches</span>[<span class="ruby-identifier">l</span>].<span class="ruby-identifier">nil?</span>)
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">printable_part</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">l</span>])
          <span class="ruby-identifier">printed_len</span> = <span class="ruby-identifier">print_filename</span>(<span class="ruby-identifier">temp</span>, <span class="ruby-identifier">matches</span>[<span class="ruby-identifier">l</span>])

          <span class="ruby-keyword">if</span> (<span class="ruby-identifier">j</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">limit</span>)
            <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39; &#39;</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">max</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">printed_len</span>))
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">l</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">count</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">rl_crlf</span>()
      <span class="ruby-identifier">lines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_page_completions</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lines</span> <span class="ruby-operator">&gt;=</span> (<span class="ruby-ivar">@_rl_screenheight</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">count</span>)
        <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">_rl_internal_pager</span>(<span class="ruby-identifier">lines</span>)
        <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># Print the sorted items, across alphabetically, like ls -x.</span>
    <span class="ruby-identifier">i</span> = <span class="ruby-value">1</span>
    <span class="ruby-keyword">while</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">printable_part</span>(<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
      <span class="ruby-identifier">printed_len</span> = <span class="ruby-identifier">print_filename</span>(<span class="ruby-identifier">temp</span>, <span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span>])
      <span class="ruby-comment"># Have we reached the end of this line?</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">matches</span>[<span class="ruby-identifier">i</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>])
        <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">limit</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">limit</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
          <span class="ruby-identifier">rl_crlf</span>()
          <span class="ruby-identifier">lines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
          <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_page_completions</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lines</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenheight</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
            <span class="ruby-identifier">lines</span> = <span class="ruby-identifier">_rl_internal_pager</span>(<span class="ruby-identifier">lines</span>)
            <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lines</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39; &#39;</span><span class="ruby-operator">*</span>(<span class="ruby-identifier">max</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">printed_len</span>))
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">rl_crlf</span>()
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_display_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_display_search</span><span
            class="method-args">(search_string, reverse_p, where)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Display the current state of the search in the echo-area.</p>

<pre>SEARCH_STRING contains the string that is being searched for,
DIRECTION is zero for forward, or non-zero for reverse,
WHERE is the history list number of the current line.  If it is
-1, then this line is the starting one.</pre>
          
          

          
          <div class="method-source-code" id="rl_display_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7327</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_display_search</span>(<span class="ruby-identifier">search_string</span>, <span class="ruby-identifier">reverse_p</span>, <span class="ruby-identifier">where</span>)
  <span class="ruby-identifier">message</span> = <span class="ruby-string">&#39;(&#39;</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">reverse_p</span>)
    <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;reverse-&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;i-search)`&quot;</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">search_string</span>)
    <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">search_string</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">message</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-string">&quot;&#39;: &quot;</span>

  <span class="ruby-identifier">rl_message</span>(<span class="ruby-identifier">message</span>)
  <span class="ruby-identifier">message</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_do_lowercase_version" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_do_lowercase_version</span><span
            class="method-args">(ignore1, ignore2)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>What to do for some uppercase characters, like meta characters,</p>

<pre>and some characters appearing in emacs_ctlx_keymap.  This function
is just a stub, you bind keys to it and the code in _rl_dispatch ()
is special cased.</pre>
          
          

          
          <div class="method-source-code" id="rl_do_lowercase_version-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5736</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_do_lowercase_version</span>(<span class="ruby-identifier">ignore1</span>, <span class="ruby-identifier">ignore2</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_do_undo" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_do_undo</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_do_undo-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7608</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_do_undo</span>()
  <span class="ruby-identifier">start</span> = <span class="ruby-identifier">_end</span> = <span class="ruby-identifier">waiting_for_begin</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">nil?</span>

    <span class="ruby-ivar">@_rl_doing_an_undo</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_UNDOING</span>)

    <span class="ruby-comment"># To better support vi-mode, a start or end value of -1 means</span>
    <span class="ruby-comment"># rl_point, and a value of -2 means rl_end.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">what</span> <span class="ruby-operator">==</span> <span class="ruby-constant">UNDO_DELETE</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">what</span> <span class="ruby-operator">==</span> <span class="ruby-constant">UNDO_INSERT</span>)
      <span class="ruby-identifier">start</span> = <span class="ruby-identifier">trans</span>(<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">start</span>)
      <span class="ruby-identifier">_end</span> = <span class="ruby-identifier">trans</span>(<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">end</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">case</span> (<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">what</span>)
      <span class="ruby-comment"># Undoing deletes means inserting some text.</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">UNDO_DELETE</span>
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">start</span>
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">text</span>)
      <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">text</span> = <span class="ruby-keyword">nil</span>

      <span class="ruby-comment"># Undoing inserts means deleting some text.</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">UNDO_INSERT</span>
      <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">start</span>
      <span class="ruby-comment"># Undoing an END means undoing everything &#39;til we get to a BEGIN.</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">UNDO_END</span>
      <span class="ruby-identifier">waiting_for_begin</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-comment"># Undoing a BEGIN means that we are done with this group.</span>
    <span class="ruby-keyword">when</span> <span class="ruby-constant">UNDO_BEGIN</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">waiting_for_begin!</span>=<span class="ruby-value">0</span>)
        <span class="ruby-identifier">waiting_for_begin</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">rl_ding</span>()
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@_rl_doing_an_undo</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_UNDOING</span>)

    <span class="ruby-identifier">release</span> = <span class="ruby-ivar">@rl_undo_list</span>
    <span class="ruby-ivar">@rl_undo_list</span> = <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">next</span>
    <span class="ruby-identifier">replace_history_data</span>(<span class="ruby-value">-1</span>, <span class="ruby-identifier">release</span>, <span class="ruby-ivar">@rl_undo_list</span>)
    <span class="ruby-identifier">release</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span> (<span class="ruby-identifier">waiting_for_begin!</span>=<span class="ruby-value">0</span>)

  <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_downcase_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_downcase_word</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Lowercase the word at point.</p>
          
          

          
          <div class="method-source-code" id="rl_downcase_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7881</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_downcase_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_change_case</span>(<span class="ruby-identifier">count</span>, <span class="ruby-constant">DownCase</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_emacs_editing_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_emacs_editing_mode</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_emacs_editing_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1439</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_emacs_editing_mode</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-ivar">@rl_editing_mode</span> = <span class="ruby-ivar">@emacs_mode</span>
  <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-constant">RL_IM_INSERT</span>, <span class="ruby-value">1</span>) <span class="ruby-comment"># emacs mode default is insert mode</span>
  <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-ivar">@emacs_standard_keymap</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_end_of_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_end_of_history</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Meta-&gt; goes to the end of the history.  (The current line).</p>
          
          

          
          <div class="method-source-code" id="rl_end_of_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7868</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_end_of_history</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_maybe_replace_line</span>()
  <span class="ruby-identifier">using_history</span>()
  <span class="ruby-identifier">rl_maybe_unsave_line</span>()
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_end_of_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_end_of_line</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move to the end of the line.</p>
          
          

          
          <div class="method-source-code" id="rl_end_of_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5145</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_end_of_line</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_end_undo_group" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_end_undo_group</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>End an undo group started with <a
href="RbReadline.html#method-i-rl_begin_undo_group">#rl_begin_undo_group</a>
().</p>
          
          

          
          <div class="method-source-code" id="rl_end_undo_group-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4963</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-constant">UNDO_END</span>, <span class="ruby-value">0</span>, <span class="ruby-value">0</span>, <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@_rl_undo_group_level</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_exchange_point_and_mark" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_exchange_point_and_mark</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Exchange the position of mark and point.</p>
          
          

          
          <div class="method-source-code" id="rl_exchange_point_and_mark-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8313</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_exchange_point_and_mark</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_mark</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_mark</span> <span class="ruby-operator">==</span> <span class="ruby-value">-1</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_point</span>, <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_mark</span>, <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_execute_next" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_execute_next</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Make C be the next command to be executed.</p>
          
          

          
          <div class="method-source-code" id="rl_execute_next-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7856</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_execute_next</span>(<span class="ruby-identifier">c</span>)
  <span class="ruby-ivar">@rl_pending_input</span> = <span class="ruby-identifier">c</span>
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_INPUTPENDING</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_expand_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_expand_prompt</span><span
            class="method-args">(prompt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>*</p>
<ul><li>
<p>Expand the prompt string into the various display components, if</p>
</li><li>
<p>necessary.</p>
</li></ul>

<p>*</p>
<ul><li>
<p>local_prompt = expanded last line of string in rl_display_prompt</p>
</li><li>
<p>(portion after the final newline)</p>
</li><li>
<p>local_prompt_prefix = portion before last newline of rl_display_prompt,</p>
</li><li>
<p>expanded via <a
href="RbReadline.html#method-i-expand_prompt">#expand_prompt</a></p>
</li><li>
<p>prompt_visible_length = number of visible characters in local_prompt</p>
</li><li>
<p>prompt_prefix_length = number of visible characters in local_prompt_prefix</p>
</li></ul>

<p>*</p>
<ul><li>
<p>This function is called once per call to readline().  It may also be</p>
</li><li>
<p>called arbitrarily to expand the primary prompt.</p>
</li></ul>

<p>*</p>
<ul><li>
<p>The return value is the number of visible characters on the last line</p>
</li><li>
<p>of the (possibly multi-line) prompt.</p>
</li></ul>

<p>*</p>
          
          

          
          <div class="method-source-code" id="rl_expand_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1769</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_expand_prompt</span>(<span class="ruby-identifier">prompt</span>)
  <span class="ruby-ivar">@local_prompt</span> = <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@prompt_last_invisible</span> = <span class="ruby-ivar">@prompt_invis_chars_first_line</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@prompt_visible_length</span> = <span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">prompt</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">prompt</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">pi</span> = <span class="ruby-identifier">prompt</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">pi</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-comment"># The prompt is only one logical line, though it might wrap.</span>
    <span class="ruby-ivar">@local_prompt</span>,<span class="ruby-ivar">@prompt_visible_length</span>,<span class="ruby-ivar">@prompt_last_invisible</span>,<span class="ruby-ivar">@prompt_invis_chars_first_line</span>,<span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">prompt</span>)
    <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-ivar">@local_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@local_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@prompt_visible_length</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># The prompt spans multiple lines.</span>
    <span class="ruby-identifier">pi</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">prompt</span>.<span class="ruby-identifier">length!</span>=<span class="ruby-identifier">pi</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>
    <span class="ruby-identifier">t</span> = <span class="ruby-identifier">pi</span>
    <span class="ruby-ivar">@local_prompt</span>,<span class="ruby-ivar">@prompt_visible_length</span>,<span class="ruby-ivar">@prompt_last_invisible</span>,<span class="ruby-ivar">@prompt_invis_chars_first_line</span>,<span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">prompt</span>[<span class="ruby-identifier">pi</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>])
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">prompt</span>[<span class="ruby-identifier">t</span>]
    <span class="ruby-identifier">prompt</span>[<span class="ruby-identifier">t</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-comment"># The portion of the prompt string up to and including the</span>
    <span class="ruby-comment">#final newline is now null-terminated.</span>
    <span class="ruby-ivar">@local_prompt_prefix</span>,<span class="ruby-ivar">@prompt_prefix_length</span>,<span class="ruby-identifier">_</span>,<span class="ruby-identifier">_</span>, = <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">prompt</span>)
    <span class="ruby-identifier">prompt</span>[<span class="ruby-identifier">t</span>] = <span class="ruby-identifier">c</span>
    <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-ivar">@local_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@local_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@prompt_prefix_length</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_extend_line_buffer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_extend_line_buffer</span><span
            class="method-args">(len)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Increase the size of RL_LINE_BUFFER until it has enough space to hold</p>

<pre>LEN characters.</pre>
          
          

          
          <div class="method-source-code" id="rl_extend_line_buffer-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4834</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_extend_line_buffer</span>(<span class="ruby-identifier">len</span>)
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">len</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-ivar">@rl_line_buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-constant">DEFAULT_BUFFER_SIZE</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@the_line</span> = <span class="ruby-ivar">@rl_line_buffer</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_filename_completion_function" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_filename_completion_function</span><span
            class="method-args">(text, state)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Okay, now we write the entry_function for filename completion.  In the
general case.  Note that completion in the shell is a little different
because of all the pathnames that must be followed when looking up the
completion for a command.</p>
          
          

          
          <div class="method-source-code" id="rl_filename_completion_function-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1117</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_filename_completion_function</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-comment"># If we don&#39;t have any state, then do some initialization.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-comment"># If we were interrupted before closing the directory or reading</span>
    <span class="ruby-comment">#all of its contents, close it.</span>
    <span class="ruby-keyword">if</span>(<span class="ruby-ivar">@directory</span>)
      <span class="ruby-ivar">@directory</span>.<span class="ruby-identifier">close</span>
      <span class="ruby-ivar">@directory</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">text</span>.<span class="ruby-identifier">delete!</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
      <span class="ruby-ivar">@dirname</span> = <span class="ruby-string">&quot;.&quot;</span>
      <span class="ruby-ivar">@filename</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>) <span class="ruby-operator">==</span> <span class="ruby-identifier">text</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">-</span><span class="ruby-value">1</span>
      <span class="ruby-ivar">@dirname</span> = <span class="ruby-identifier">text</span>
      <span class="ruby-ivar">@filename</span> = <span class="ruby-string">&quot;&quot;</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@dirname</span>, <span class="ruby-ivar">@filename</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">text</span>)

      <span class="ruby-comment"># This preserves the &quot;./&quot; when the user types &quot;./dirname&lt;tab&gt;&quot;.</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@dirname</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;.&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">text</span>[<span class="ruby-value">0</span>,<span class="ruby-value">2</span>] <span class="ruby-operator">==</span> <span class="ruby-node">&quot;.#{File::SEPARATOR}&quot;</span>
        <span class="ruby-ivar">@dirname</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># We aren&#39;t done yet.  We also support the &quot;~user&quot; syntax.</span>

    <span class="ruby-comment"># Save the version of the directory that the user typed.</span>
    <span class="ruby-ivar">@users_dirname</span> = <span class="ruby-ivar">@dirname</span>.<span class="ruby-identifier">dup</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@dirname</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;~&#39;</span>)
      <span class="ruby-ivar">@dirname</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-ivar">@dirname</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># The directory completion hook should perform any necessary</span>
    <span class="ruby-comment">#   dequoting.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_directory_completion_hook</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">send</span>(<span class="ruby-identifier">rl_directory_completion_hook</span>,<span class="ruby-ivar">@dirname</span>))
      <span class="ruby-ivar">@users_dirname</span> = <span class="ruby-ivar">@dirname</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_completion_found_quote</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_filename_dequoting_function</span>)
      <span class="ruby-comment"># delete single and double quotes</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_filename_dequoting_function</span>, <span class="ruby-ivar">@users_dirname</span>, <span class="ruby-ivar">@rl_completion_quote_character</span>)
      <span class="ruby-ivar">@users_dirname</span> = <span class="ruby-identifier">temp</span>
      <span class="ruby-ivar">@dirname</span> = <span class="ruby-ivar">@users_dirname</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">begin</span>
      <span class="ruby-ivar">@directory</span> = <span class="ruby-constant">Dir</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@dirname</span>)
    <span class="ruby-keyword">rescue</span> <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ENOENT</span>, <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ENOTDIR</span>, <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">EACCES</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Now dequote a non-null filename.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@filename</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@filename</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_completion_found_quote</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_filename_dequoting_function</span>)
      <span class="ruby-comment"># delete single and double quotes</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_filename_dequoting_function</span>, <span class="ruby-ivar">@filename</span>, <span class="ruby-ivar">@rl_completion_quote_character</span>)
      <span class="ruby-ivar">@filename</span> = <span class="ruby-identifier">temp</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@filename_len</span> = <span class="ruby-ivar">@filename</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-ivar">@rl_filename_completion_desired</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># At this point we should entertain the possibility of hacking wildcarded</span>
  <span class="ruby-comment">#   filenames, like /usr/man/man&lt;WILD&gt;/te&lt;TAB&gt;.  If the directory name</span>
  <span class="ruby-comment">#   contains globbing characters, then build an array of directories, and</span>
  <span class="ruby-comment">#   then map over that list while completing.</span>
  <span class="ruby-comment"># *** UNIMPLEMENTED ***</span>

  <span class="ruby-comment"># Now that we have some state, we can read the directory.</span>
  <span class="ruby-identifier">entry</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">while</span>(<span class="ruby-ivar">@directory</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">entry</span> = <span class="ruby-ivar">@directory</span>.<span class="ruby-identifier">read</span>))
    <span class="ruby-identifier">d_name</span> = <span class="ruby-identifier">entry</span>
    <span class="ruby-comment"># Special case for no filename.  If the user has disabled the</span>
    <span class="ruby-comment">#   `match-hidden-files&#39; variable, skip filenames beginning with `.&#39;.</span>
    <span class="ruby-comment">#All other entries except &quot;.&quot; and &quot;..&quot; match.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@filename_len</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_match_hidden_files</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">d_name</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;.&#39;</span>)
      <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">d_name</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;.&#39;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">d_name</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;..&#39;</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># Otherwise, if these match up to the length of filename, then</span>
      <span class="ruby-comment">#   it is a match.</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_completion_case_fold</span>)
        <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">d_name</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^#{Regexp.escape(@filename)}/i</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">d_name</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^#{Regexp.escape(@filename)}/</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@directory</span>
      <span class="ruby-ivar">@directory</span>.<span class="ruby-identifier">close</span>
      <span class="ruby-ivar">@directory</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@dirname</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@filename</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@users_dirname</span> = <span class="ruby-keyword">nil</span>

    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@dirname</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;.&#39;</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_complete_with_tilde_expansion</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@users_dirname</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;~&quot;</span>)
        <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@dirname</span>
        <span class="ruby-keyword">if</span>(<span class="ruby-identifier">temp</span>[<span class="ruby-value">-1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>)
          <span class="ruby-identifier">temp</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@users_dirname</span>
        <span class="ruby-keyword">if</span>(<span class="ruby-identifier">temp</span>[<span class="ruby-value">-1</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>)
          <span class="ruby-identifier">temp</span> <span class="ruby-operator">+=</span> <span class="ruby-constant">File</span><span class="ruby-operator">::</span><span class="ruby-constant">SEPARATOR</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">temp</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">entry</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">temp</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_forced_update_display" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_forced_update_display</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Actually update the display, period.</p>
          
          

          
          <div class="method-source-code" id="rl_forced_update_display-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5283</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_forced_update_display</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@visible_line</span>)
    <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/[^\x00]/</span>,<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_on_new_line</span>()
  <span class="ruby-ivar">@forced_display</span>=<span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@forced_display</span>
  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_forward" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_forward</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Backwards compatibility.</p>
          
          

          
          <div class="method-source-code" id="rl_forward-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5084</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_forward</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_forward_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_forward_byte" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_forward_byte</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move forward COUNT bytes.</p>
          
          

          
          <div class="method-source-code" id="rl_forward_byte-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5038</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_forward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_backward_byte</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_end</span> = <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">count</span>
    <span class="ruby-identifier">lend</span> = <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> ((<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)<span class="ruby-operator">?</span><span class="ruby-value">1</span><span class="ruby-operator">:</span><span class="ruby-value">0</span>) <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_end</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">lend</span>)
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">lend</span>
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@rl_end</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_forward_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_forward_char</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move forward COUNT characters.</p>
          
          

          
          <div class="method-source-code" id="rl_forward_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5060</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_forward_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_forward_byte</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_backward_char</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">point</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-identifier">count</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">point</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
      <span class="ruby-identifier">point</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_end</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">point</span>)
      <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">point</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@rl_end</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_forward_search_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_forward_search_history</span><span
            class="method-args">(sign, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search forwards through the history looking for a string which is typed</p>

<pre>interactively.  Start with the current line.</pre>
          
          

          
          <div class="method-source-code" id="rl_forward_search_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7141</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_forward_search_history</span>(<span class="ruby-identifier">sign</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_search_history</span>(<span class="ruby-identifier">sign</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_forward_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_forward_word</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move forward a word.  We do what Emacs does.  Handles multibyte chars.</p>
          
          

          
          <div class="method-source-code" id="rl_forward_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5171</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_forward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_backward_word</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)

    <span class="ruby-comment"># If we are not in a word, move forward until we are in one.</span>
    <span class="ruby-comment"># Then, move forward until we hit a non-alphabetic character.</span>
    <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)
        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)

    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)
      <span class="ruby-identifier">c</span> = <span class="ruby-identifier">_rl_char_value</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_walphabetic</span>(<span class="ruby-identifier">c</span>))
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_free_undo_list" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_free_undo_list</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_free_undo_list-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4969</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_free_undo_list</span>()
  <span class="ruby-identifier">replace_history_data</span>(<span class="ruby-value">-1</span>, <span class="ruby-ivar">@rl_undo_list</span>, <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@rl_undo_list</span> = <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_function_of_keyseq" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_function_of_keyseq</span><span
            class="method-args">(keyseq, map, type)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the function (or macro) definition which would be invoked via</p>

<pre>KEYSEQ if executed in MAP.  If MAP is NULL, then the current keymap is
used.  TYPE, if non-NULL, is a pointer to an int which will receive the
type of the object pointed to.  One of ISFUNC (function), ISKMAP (keymap),
or ISMACR (macro).</pre>
          
          

          
          <div class="method-source-code" id="rl_function_of_keyseq-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1908</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_function_of_keyseq</span>(<span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">map</span>, <span class="ruby-identifier">type</span>)
  <span class="ruby-identifier">map</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@_rl_keymap</span>
  <span class="ruby-identifier">map</span>[<span class="ruby-identifier">keyseq</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_gather_tyi" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_gather_tyi</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_gather_tyi-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4459</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_gather_tyi</span>()
  <span class="ruby-identifier">chars_avail</span> = <span class="ruby-ivar">@kbhit</span>.<span class="ruby-constant">Call</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span>(<span class="ruby-identifier">chars_avail</span><span class="ruby-operator">&lt;=</span><span class="ruby-value">0</span>)
  <span class="ruby-identifier">k</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_getc_function</span>,<span class="ruby-ivar">@rl_instream</span>)
  <span class="ruby-identifier">rl_stuff_char</span>(<span class="ruby-identifier">k</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_generic_bind" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_generic_bind</span><span
            class="method-args">(type, keyseq, data, map)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Bind the key sequence represented by the string KEYSEQ to</p>

<pre>the arbitrary pointer DATA.  TYPE says what kind of data is
pointed to by DATA, right now this can be a function (ISFUNC),
a macro (ISMACR), or a keymap (ISKMAP).  This makes new keymaps
as necessary.  The initial place to do bindings is in MAP.</pre>
          
          

          
          <div class="method-source-code" id="rl_generic_bind-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1918</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_generic_bind</span>(<span class="ruby-identifier">type</span>, <span class="ruby-identifier">keyseq</span>, <span class="ruby-identifier">data</span>, <span class="ruby-identifier">map</span>)
  <span class="ruby-identifier">map</span>[<span class="ruby-identifier">keyseq</span>] = <span class="ruby-identifier">data</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_get_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_get_char</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get a key from the buffer of characters to be read.</p>

<pre>Return the key in KEY.
Result is KEY if there was a key, or 0 if there wasn&#39;t.</pre>
          
          

          
          <div class="method-source-code" id="rl_get_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4551</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_get_char</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@push_index</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@pop_index</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">key</span> = <span class="ruby-ivar">@ibuffer</span>[<span class="ruby-ivar">@pop_index</span>]
  <span class="ruby-ivar">@pop_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@pop_index</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@ibuffer_len</span>)
    <span class="ruby-ivar">@pop_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-identifier">key</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_get_keymap_name_from_edit_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_get_keymap_name_from_edit_mode</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_get_keymap_name_from_edit_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2439</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_get_keymap_name_from_edit_mode</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
    <span class="ruby-string">&quot;emacs&quot;</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-string">&quot;vi&quot;</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-string">&quot;none&quot;</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_get_next_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_get_next_history</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Move down to the next history line.</p>
          
          

          
          <div class="method-source-code" id="rl_get_next_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5457</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_get_next_history</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_get_previous_history</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_maybe_replace_line</span>()

  <span class="ruby-comment"># either not saved by rl_newline or at end of line, so set appropriately.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_history_saved_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">-1</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_end</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>))
    <span class="ruby-ivar">@_rl_history_saved_point</span> = (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>) <span class="ruby-operator">?</span> <span class="ruby-value">-1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">temp</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">next_history</span>()
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">rl_maybe_unsave_line</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_replace_from_history</span>(<span class="ruby-identifier">temp</span>, <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_history_set_point</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_get_previous_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_get_previous_history</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Get the previous item out of our interactive history, making it the current</p>

<pre>line.  If there is no previous history, just ding.</pre>
          
          

          
          <div class="method-source-code" id="rl_get_previous_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5398</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_get_previous_history</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_get_next_history</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># either not saved by rl_newline or at end of line, so set appropriately.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_history_saved_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">-1</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_end</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>))
    <span class="ruby-ivar">@_rl_history_saved_point</span> = (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>) <span class="ruby-operator">?</span> <span class="ruby-value">-1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we don&#39;t have a line saved, then save this one.</span>
  <span class="ruby-identifier">rl_maybe_save_line</span>()

  <span class="ruby-comment"># If the current line has changed, save the changes.</span>
  <span class="ruby-identifier">rl_maybe_replace_line</span>()

  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">old_temp</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">previous_history</span>()
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">old_temp</span> = <span class="ruby-identifier">temp</span>
    <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If there was a large argument, and we moved back to the start of the</span>
  <span class="ruby-comment">#   history, that is not an error.  So use the last value found.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">old_temp</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">old_temp</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_replace_from_history</span>(<span class="ruby-identifier">temp</span>, <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_history_set_point</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_getc" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_getc</span><span
            class="method-args">(stream)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_getc-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4439</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_getc</span>(<span class="ruby-identifier">stream</span>)
  <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@kbhit</span>.<span class="ruby-constant">Call</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-comment"># If there is no input, yield the processor for other threads</span>
    <span class="ruby-identifier">sleep</span>(<span class="ruby-ivar">@_keyboard_input_timeout</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@getch</span>.<span class="ruby-constant">Call</span>
  <span class="ruby-identifier">alt</span> = (<span class="ruby-ivar">@GetKeyState</span>.<span class="ruby-identifier">call</span>(<span class="ruby-constant">VK_LMENU</span>) <span class="ruby-operator">&amp;</span> <span class="ruby-value">0x80</span>) <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">c</span><span class="ruby-operator">==</span><span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span><span class="ruby-operator">==</span><span class="ruby-value">0xE0</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@kbhit</span>.<span class="ruby-constant">Call</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-comment"># If there is no input, yield the processor for other threads</span>
      <span class="ruby-identifier">sleep</span>(<span class="ruby-ivar">@_keyboard_input_timeout</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@getch</span>.<span class="ruby-constant">Call</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">c</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">r</span> = <span class="ruby-string">&quot;\e&quot;</span><span class="ruby-operator">+</span><span class="ruby-identifier">r</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">alt</span>
  <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_initialize" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_initialize</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Initialize readline (and terminal if not already).</p>
          
          

          
          <div class="method-source-code" id="rl_initialize-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3791</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_initialize</span>()
  <span class="ruby-comment"># If we have never been called before, initialize the</span>
  <span class="ruby-comment">#   terminal and data structures.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_initialized</span>)
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_INITIALIZING</span>)
    <span class="ruby-identifier">readline_initialize_everything</span>()
    <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_INITIALIZING</span>)
    <span class="ruby-ivar">@rl_initialized</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_INITIALIZED</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Initalize the current line information.</span>
  <span class="ruby-identifier">_rl_init_line_state</span>()

  <span class="ruby-comment"># We aren&#39;t done yet.  We haven&#39;t even gotten started yet!</span>
  <span class="ruby-ivar">@rl_done</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_DONE</span>)

  <span class="ruby-comment"># Tell the history routines what is going on.</span>
  <span class="ruby-identifier">_rl_start_using_history</span>()

  <span class="ruby-comment"># Make the display buffer match the state of the line.</span>
  <span class="ruby-identifier">rl_reset_line_state</span>()

  <span class="ruby-comment"># No such function typed yet.</span>
  <span class="ruby-ivar">@rl_last_func</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-comment"># Parsing of key-bindings begins in an enabled state.</span>
  <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-identifier">_rl_vi_initialize_line</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># Each line starts in insert mode (the default).</span>
  <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-constant">RL_IM_DEFAULT</span>, <span class="ruby-value">1</span>)

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_insert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_insert</span><span
            class="method-args">(count, c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_insert-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5598</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_insert</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>)
  ((<span class="ruby-ivar">@rl_insert_mode</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RL_IM_INSERT</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>) <span class="ruby-operator">:</span>
   <span class="ruby-identifier">_rl_overwrite_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">c</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_insert_comment" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_insert_comment</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Turn the current line into a comment in shell history.</p>

<pre>A K*rn shell style function.</pre>
          
          

          
          <div class="method-source-code" id="rl_insert_comment-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6060</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_insert_comment</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_beg_of_line</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-ivar">@rl_comment_text</span> = <span class="ruby-ivar">@_rl_comment_begin</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@_rl_comment_begin</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39;#&#39;</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-ivar">@rl_comment_text</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_comment_len</span> = <span class="ruby-ivar">@rl_comment_text</span>.<span class="ruby-identifier">length</span>
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_comment_text</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@rl_comment_len</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@rl_comment_len</span>]
      <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@rl_comment_len</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-ivar">@rl_comment_text</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-identifier">rl_newline</span>(<span class="ruby-value">1</span>, <span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_insert_completions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_insert_completions</span><span
            class="method-args">(ignore, invoking_key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_insert_completions-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7732</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_insert_completions</span>(<span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">invoking_key</span>)
  <span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-string">&#39;*&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_insert_text" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_insert_text</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Insert a string of text into the line at point.  This is the only</p>

<pre>way that you should do insertion.  _rl_insert_char () calls this
function.  Returns the number of characters inserted.</pre>
          
          

          
          <div class="method-source-code" id="rl_insert_text-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4844</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">string</span>)
  <span class="ruby-identifier">string</span>.<span class="ruby-identifier">delete!</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
  <span class="ruby-identifier">l</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">l</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">l</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-identifier">rl_extend_line_buffer</span>(<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">l</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">0</span>] = <span class="ruby-identifier">string</span>

  <span class="ruby-comment"># Remember how to undo this if we aren&#39;t undoing something.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_doing_an_undo</span>)
    <span class="ruby-comment"># If possible and desirable, concatenate the undos.</span>
    <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">l</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>) <span class="ruby-operator">&amp;&amp;</span>
        <span class="ruby-ivar">@rl_undo_list</span> <span class="ruby-operator">&amp;&amp;</span>
        (<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">what</span> <span class="ruby-operator">==</span> <span class="ruby-constant">UNDO_INSERT</span>) <span class="ruby-operator">&amp;&amp;</span>
        (<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">end</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_point</span>) <span class="ruby-operator">&amp;&amp;</span>
        (<span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">end</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">start</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">20</span>))
      <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">end</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-constant">UNDO_INSERT</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">l</span>, <span class="ruby-keyword">nil</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">l</span>
  <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">l</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@rl_end</span>
    <span class="ruby-ivar">@rl_line_buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_end</span>] = <span class="ruby-string">&quot;\0&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">l</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_isstate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_isstate</span><span
            class="method-args">(x)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_isstate-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1641</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_isstate</span>(<span class="ruby-identifier">x</span>)
  (<span class="ruby-ivar">@rl_readline_state</span> <span class="ruby-operator">&amp;</span> (<span class="ruby-identifier">x</span>))<span class="ruby-operator">!=</span><span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_kill_full_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_kill_full_line</span><span
            class="method-args">(count, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Kill the whole line, no matter where point is.</p>
          
          

          
          <div class="method-source-code" id="rl_kill_full_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7124</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_kill_full_line</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-identifier">rl_begin_undo_group</span>()
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-ivar">@rl_end</span>)
  <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_kill_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_kill_line</span><span
            class="method-args">(direction, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Kill from here to the end of the line.  If DIRECTION is negative, kill</p>

<pre>back to the line start instead.</pre>
          
          

          
          <div class="method-source-code" id="rl_kill_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7084</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_kill_line</span> (<span class="ruby-identifier">direction</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">direction</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_backward_kill_line</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">ignore</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-identifier">rl_end_of_line</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">ignore</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">orig_point</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@rl_point</span>)
      <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">orig_point</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
      <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_kill_text" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_kill_text</span><span
            class="method-args">(from, to)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>The way to kill something.  This appends or prepends to the last</p>

<pre>kill, if the last command was a kill command.  if FROM is less
than TO, then the text is appended, otherwise prepended.  If the
last command was not a kill command, then a new slot is made for
this kill.</pre>
          
          

          
          <div class="method-source-code" id="rl_kill_text-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5930</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)
  <span class="ruby-comment"># Is there anything to kill?</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">from</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">to</span>)
    <span class="ruby-ivar">@_rl_last_command_was_kill</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_last_command_was_kill</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">text</span> = <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)

  <span class="ruby-comment"># Delete the copied text from the line.</span>
  <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">from</span>, <span class="ruby-identifier">to</span>)
  <span class="ruby-identifier">_rl_copy_to_kill_ring</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">from</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">to</span>)
  <span class="ruby-ivar">@_rl_last_command_was_kill</span> = <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_last_command_was_kill</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_kill_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_kill_word</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete the word at point, saving the text in the kill ring.</p>
          
          

          
          <div class="method-source-code" id="rl_kill_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7677</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_kill_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_backward_kill_word</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-identifier">rl_forward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">orig_point</span>)
      <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">orig_point</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
      <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_line_buffer" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_line_buffer</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_line_buffer-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3760</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_line_buffer</span>
  <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_maybe_replace_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_maybe_replace_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Perhaps put back the current line if it has changed.</p>
          
          

          
          <div class="method-source-code" id="rl_maybe_replace_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5373</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_maybe_replace_line</span>()
  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">current_history</span>()
  <span class="ruby-comment"># If the current line has changed, save the changes.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">temp</span>.<span class="ruby-identifier">data</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@rl_undo_list</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">replace_history_entry</span>(<span class="ruby-identifier">where_history</span>(), <span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_undo_list</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_maybe_save_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_maybe_save_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save the current line in _rl_saved_line_for_history.</p>
          
          

          
          <div class="method-source-code" id="rl_maybe_save_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5340</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_maybe_save_line</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-ivar">@_rl_saved_line_for_history</span> = <span class="ruby-constant">Struct</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:line</span>,<span class="ruby-value">:timestamp</span>,<span class="ruby-value">:data</span>).<span class="ruby-identifier">new</span>
    <span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">line</span> = <span class="ruby-ivar">@rl_line_buffer</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">timestamp</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">data</span> = <span class="ruby-ivar">@rl_undo_list</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_maybe_unsave_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_maybe_unsave_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Restore the _rl_saved_line_for_history if there is one.</p>
          
          

          
          <div class="method-source-code" id="rl_maybe_unsave_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5325</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_maybe_unsave_line</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_saved_line_for_history</span>)
    <span class="ruby-comment"># Can&#39;t call with `1&#39; because rl_undo_list might point to an undo</span>
    <span class="ruby-comment"># list from a history entry, as in rl_replace_from_history() below.</span>
    <span class="ruby-identifier">rl_replace_line</span>(<span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">line</span>, <span class="ruby-keyword">false</span>)
    <span class="ruby-ivar">@rl_undo_list</span> = <span class="ruby-ivar">@_rl_saved_line_for_history</span>.<span class="ruby-identifier">data</span>
    <span class="ruby-ivar">@_rl_saved_line_for_history</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-ivar">@rl_end</span>  <span class="ruby-comment"># rl_replace_line sets rl_end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_message" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_message</span><span
            class="method-args">(msg_buf)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_message-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7308</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_message</span>(<span class="ruby-identifier">msg_buf</span>)
  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-identifier">msg_buf</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@saved_local_prompt</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">rl_save_prompt</span>()
    <span class="ruby-ivar">@msg_saved_prompt</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@local_prompt</span>,<span class="ruby-ivar">@prompt_visible_length</span>,<span class="ruby-ivar">@prompt_last_invisible</span>,<span class="ruby-ivar">@prompt_invis_chars_first_line</span>,<span class="ruby-ivar">@prompt_physical_chars</span> =
    <span class="ruby-identifier">expand_prompt</span>(<span class="ruby-identifier">msg_buf</span>)
  <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-ivar">@local_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@local_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
  <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_redisplay_function</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_modifying" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_modifying</span><span
            class="method-args">(start, _end)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Save an undo entry for the text from START to END.</p>
          
          

          
          <div class="method-source-code" id="rl_modifying-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7891</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_modifying</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">start</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">_end</span>)
    <span class="ruby-identifier">start</span>,<span class="ruby-identifier">_end</span> = <span class="ruby-identifier">_end</span>,<span class="ruby-identifier">start</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">start</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">_end</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
    <span class="ruby-identifier">rl_begin_undo_group</span>()
    <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-constant">UNDO_DELETE</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-identifier">temp</span>)
    <span class="ruby-identifier">rl_add_undo</span>(<span class="ruby-constant">UNDO_INSERT</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>, <span class="ruby-keyword">nil</span>)
    <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_named_function" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_named_function</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_named_function-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2342</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_named_function</span>(<span class="ruby-identifier">name</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">name</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;accept-line&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_newline</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;arrow-key-prefix&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_arrow_keys</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;backward-delete-char&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_rubout</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;character-search&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_char_search</span>
  <span class="ruby-keyword">when</span>  <span class="ruby-string">&quot;character-search-backward&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_backward_char_search</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;copy-region-as-kill&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_copy_region_to_kill</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;delete-char&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_delete</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;delete-char-or-list&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_delete_or_show_completions</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;forward-backward-delete-char&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_rubout_or_delete</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;kill-whole-line&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_kill_full_line</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;non-incremental-forward-search-history&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_noninc_forward_search</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;non-incremental-reverse-search-history&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_noninc_reverse_search</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;non-incremental-forward-search-history-again&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_noninc_forward_search_again</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;non-incremental-reverse-search-history-again&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_noninc_reverse_search_again</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;redraw-current-line&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_refresh_line</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;self-insert&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_insert</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;undo&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_undo_command</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;beginning-of-line&quot;</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">:rl_beg_of_line</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^[-a-z]+$/</span>
      <span class="ruby-keyword">return</span> (<span class="ruby-string">&#39;rl_&#39;</span><span class="ruby-operator">+</span><span class="ruby-identifier">name</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-string">&#39;-&#39;</span>,<span class="ruby-string">&#39;_&#39;</span>)).<span class="ruby-identifier">to_sym</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_newline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_newline</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>What to do when a <a href="RbReadline.html#NEWLINE">NEWLINE</a> is pressed.
We accept the whole line.</p>

<pre>KEY is the key that invoked this command.  I guess it could have
meaning in the future.</pre>
          
          

          
          <div class="method-source-code" id="rl_newline-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5707</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_newline</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-ivar">@rl_done</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_history_preserve_point</span>)
    <span class="ruby-ivar">@_rl_history_saved_point</span> = (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>) <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_DONE</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-identifier">_rl_vi_done_inserting</span>()
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_vi_textmod_command</span>(<span class="ruby-ivar">@_rl_vi_last_command</span>).<span class="ruby-identifier">nil?</span>)   <span class="ruby-comment"># XXX</span>
      <span class="ruby-identifier">_rl_vi_reset_last</span>()
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># If we&#39;ve been asked to erase empty lines, suppress the final update,</span>
  <span class="ruby-comment">#   since _rl_update_final calls rl_crlf().</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_erase_empty_line</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@readline_echoing_p</span>
    <span class="ruby-identifier">_rl_update_final</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_noninc_forward_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_noninc_forward_search</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search forward through the history list for a string.  If the vi-mode</p>

<pre>code calls this, KEY will be `?&#39;.</pre>
          
          

          
          <div class="method-source-code" id="rl_noninc_forward_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7998</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_noninc_forward_search</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">noninc_search</span>(<span class="ruby-value">1</span>, (<span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;?&#39;</span>) <span class="ruby-operator">?</span> <span class="ruby-string">&#39;?&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_noninc_reverse_search" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_noninc_reverse_search</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Reverse search the history list for a string.  If the vi-mode code</p>

<pre>calls this, KEY will be `/&#39;.</pre>
          
          

          
          <div class="method-source-code" id="rl_noninc_reverse_search-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8004</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_noninc_reverse_search</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">noninc_search</span>(<span class="ruby-value">-1</span>, (<span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;/&#39;</span>) <span class="ruby-operator">?</span> <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_on_new_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_on_new_line</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tell the update routines that we have moved onto a new (empty) line.</p>
          
          

          
          <div class="method-source-code" id="rl_on_new_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3765</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_on_new_line</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@visible_line</span>)
    <span class="ruby-ivar">@visible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-ivar">@_rl_last_v_pos</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@_rl_vis_botlin</span> = <span class="ruby-ivar">@last_lmargin</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@vis_lbreaks</span>)
    <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-value">0</span>] = <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@visible_wrap_offset</span> = <span class="ruby-value">0</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_on_new_line_with_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_on_new_line_with_prompt</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Tell the update routines that we have moved onto a new line with the</p>

<pre>prompt already displayed.  Code originally from the version of readline
distributed with CLISP.  rl_expand_prompt must have already been called
(explicitly or implicitly).  This still doesn&#39;t work exactly right.</pre>
          
          

          
          <div class="method-source-code" id="rl_on_new_line_with_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3874</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_on_new_line_with_prompt</span>()
  <span class="ruby-comment"># Initialize visible_line and invisible_line to ensure that they can hold</span>
  <span class="ruby-comment">#   the already-displayed prompt.</span>
  <span class="ruby-identifier">prompt_size</span> = <span class="ruby-ivar">@rl_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
  <span class="ruby-identifier">init_line_structures</span>(<span class="ruby-identifier">prompt_size</span>)

  <span class="ruby-comment"># Make sure the line structures hold the already-displayed prompt for</span>
  <span class="ruby-comment">#   redisplay.</span>
  <span class="ruby-identifier">lprompt</span> = <span class="ruby-ivar">@local_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@local_prompt</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_prompt</span>
  <span class="ruby-ivar">@visible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">lprompt</span>.<span class="ruby-identifier">length</span>] = <span class="ruby-identifier">lprompt</span>
  <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">lprompt</span>.<span class="ruby-identifier">length</span>] = <span class="ruby-identifier">lprompt</span>

  <span class="ruby-comment"># If the prompt contains newlines, take the last tail.</span>
  <span class="ruby-identifier">prompt_last_line</span> = <span class="ruby-identifier">rl_prompt</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-string">&quot;\n&quot;</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">prompt_last_line</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">prompt_last_line</span> = <span class="ruby-ivar">@rl_prompt</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">prompt_last_line</span> = <span class="ruby-ivar">@rl_prompt</span>[<span class="ruby-identifier">prompt_last_line</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">l</span> = <span class="ruby-identifier">prompt_last_line</span>.<span class="ruby-identifier">length</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">prompt_last_line</span>, <span class="ruby-value">0</span>, <span class="ruby-identifier">l</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">l</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Dissect prompt_last_line into screen lines. Note that here we have</span>
  <span class="ruby-comment">#   to use the real screenwidth. Readline&#39;s notion of screenwidth might be</span>
  <span class="ruby-comment">#   one less, see terminal.c.</span>
  <span class="ruby-identifier">real_screenwidth</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">+</span> (<span class="ruby-ivar">@_rl_term_autowrap</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>)
  <span class="ruby-ivar">@_rl_last_v_pos</span> = <span class="ruby-identifier">l</span> <span class="ruby-operator">/</span> <span class="ruby-identifier">real_screenwidth</span>
  <span class="ruby-comment"># If the prompt length is a multiple of real_screenwidth, we don&#39;t know</span>
  <span class="ruby-comment">#   whether the cursor is at the end of the last line, or already at the</span>
  <span class="ruby-comment">#   beginning of the next line. Output a newline just to be safe.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">l</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">l</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">real_screenwidth</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-string">&quot;\n&quot;</span>,<span class="ruby-value">0</span>,<span class="ruby-value">1</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@last_lmargin</span> = <span class="ruby-value">0</span>

  <span class="ruby-identifier">newlines</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">i</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">i</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">l</span>)
    <span class="ruby-ivar">@_rl_vis_botlin</span> = <span class="ruby-identifier">newlines</span>
    <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">i</span>
    <span class="ruby-identifier">newlines</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">i</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">real_screenwidth</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">l</span>
  <span class="ruby-ivar">@visible_wrap_offset</span> = <span class="ruby-value">0</span>

  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-ivar">@rl_prompt</span>  <span class="ruby-comment"># XXX - make sure it&#39;s set</span>

  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_overwrite_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_overwrite_mode</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Toggle overwrite mode.  A positive explicit argument selects overwrite</p>

<pre>mode.  A negative or zero explicit argument selects insert mode.</pre>
          
          

          
          <div class="method-source-code" id="rl_overwrite_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1453</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_overwrite_mode</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_explicit_arg</span>)
    <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-ivar">@rl_insert_mode</span> <span class="ruby-operator">^</span> <span class="ruby-value">1</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-constant">RL_IM_OVERWRITE</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">_rl_set_insert_mode</span>(<span class="ruby-constant">RL_IM_INSERT</span>, <span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_parse_and_bind" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_parse_and_bind</span><span
            class="method-args">(string)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Read the binding command from STRING and perform it.</p>

<pre>A key binding command looks like: Keyname: function-name\0,
a variable binding command looks like: set variable value.
A new-style keybinding looks like &quot;\C-x\C-x&quot;: exchange-point-and-mark.</pre>
          
          

          
          <div class="method-source-code" id="rl_parse_and_bind-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2399</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_parse_and_bind</span>(<span class="ruby-identifier">string</span>)

  <span class="ruby-comment"># If this is a parser directive, act on it.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">string</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot;$&quot;</span>)
    <span class="ruby-identifier">handle_parser_directive</span>(<span class="ruby-identifier">string</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>])
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we aren&#39;t supposed to be parsing right now, then we&#39;re done.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> <span class="ruby-ivar">@_rl_parsing_conditionalized_out</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">string</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^set/i</span>
    <span class="ruby-identifier">_</span>,<span class="ruby-identifier">var</span>,<span class="ruby-identifier">value</span> = <span class="ruby-identifier">string</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39; &#39;</span>)
    <span class="ruby-identifier">rl_variable_bind</span>(<span class="ruby-identifier">var</span>, <span class="ruby-identifier">value</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">string</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/&quot;(.*)&quot;\s*:\s*(.*)$/</span>
    <span class="ruby-identifier">key</span>, <span class="ruby-identifier">funname</span> = <span class="ruby-node">$1</span>, <span class="ruby-node">$2</span>
    <span class="ruby-identifier">rl_bind_key</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">rl_named_function</span>(<span class="ruby-identifier">funname</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_possible_completions" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_possible_completions</span><span
            class="method-args">(ignore, invoking_key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>List the possible completions.  See description of <a
href="RbReadline.html#method-i-rl_complete">#rl_complete</a> ().</p>
          
          

          
          <div class="method-source-code" id="rl_possible_completions-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6043</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_possible_completions</span>(<span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">invoking_key</span>)
  <span class="ruby-identifier">rl_complete_internal</span>(<span class="ruby-string">&#39;?&#39;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_prep_terminal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_prep_terminal</span><span
            class="method-args">(meta_flag)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_prep_terminal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6998</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_prep_terminal</span>(<span class="ruby-identifier">meta_flag</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">no_terminal?</span>
    <span class="ruby-ivar">@readline_echoing_p</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@terminal_prepped</span>)

  <span class="ruby-comment"># Try to keep this function from being INTerrupted.</span>
  <span class="ruby-identifier">block_sigint</span>()

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_bind_stty_chars</span>)
    <span class="ruby-comment"># If editing in vi mode, make sure we restore the bindings in the</span>
    <span class="ruby-comment"># insertion keymap no matter what keymap we ended up in.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
      <span class="ruby-identifier">rl_tty_unset_default_bindings</span>(<span class="ruby-ivar">@vi_insertion_keymap</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_tty_unset_default_bindings</span>(<span class="ruby-ivar">@_rl_keymap</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">save_tty_chars</span>()

  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_TTYCSAVED</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_bind_stty_chars</span>)

    <span class="ruby-comment"># If editing in vi mode, make sure we set the bindings in the</span>
    <span class="ruby-comment"># insertion keymap no matter what keymap we ended up in.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
      <span class="ruby-identifier">_rl_bind_tty_special_chars</span>(<span class="ruby-ivar">@vi_insertion_keymap</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_rl_bind_tty_special_chars</span>(<span class="ruby-ivar">@_rl_keymap</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">prepare_terminal_settings</span>(<span class="ruby-identifier">meta_flag</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_enable_keypad</span>)
    <span class="ruby-identifier">_rl_control_keypad</span>(<span class="ruby-keyword">true</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>
  <span class="ruby-ivar">@terminal_prepped</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_TERMPREPPED</span>)

  <span class="ruby-identifier">release_sigint</span>()
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_quoted_insert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_quoted_insert</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_quoted_insert-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5617</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_quoted_insert</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_insert_next</span>(<span class="ruby-identifier">count</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_re_read_init_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_re_read_init_file</span><span
            class="method-args">(count, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Re-read the current keybindings file.</p>
          
          

          
          <div class="method-source-code" id="rl_re_read_init_file-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8306</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_re_read_init_file</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-identifier">r</span> = <span class="ruby-identifier">rl_read_init_file</span>(<span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">rl_set_keymap_from_edit_mode</span>()
  <span class="ruby-identifier">r</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_read_init_file" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_read_init_file</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Do key bindings from a file.  If FILENAME is NULL it defaults</p>

<pre>to the first non-null filename from this list:
  1. the filename used for the previous call
  2. the value of the shell variable `INPUTRC&#39;
  3. ~/.inputrc
  4. /etc/inputrc
If the file existed and could be opened and read, 0 is returned,
otherwise errno is returned.</pre>
          
          

          
          <div class="method-source-code" id="rl_read_init_file-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2090</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_read_init_file</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-comment"># Default the filename.</span>
  <span class="ruby-identifier">filename</span> <span class="ruby-operator">||=</span> <span class="ruby-ivar">@last_readline_init_file</span>
  <span class="ruby-identifier">filename</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;INPUTRC&quot;</span>]
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">filename</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">filename</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;&#39;</span>)
    <span class="ruby-identifier">filename</span> = <span class="ruby-constant">DEFAULT_INPUTRC</span>
    <span class="ruby-comment"># Try to read DEFAULT_INPUTRC; fall back to SYS_INPUTRC on failure</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_read_init_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">filename</span> = <span class="ruby-constant">SYS_INPUTRC</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/mswin|mingw/</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_rl_read_init_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value">0</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">filename</span> = <span class="ruby-string">&quot;~/_inputrc&quot;</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_read_init_file</span>(<span class="ruby-identifier">filename</span>, <span class="ruby-value">0</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_read_key" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_read_key</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Read a key, including pending input.</p>
          
          

          
          <div class="method-source-code" id="rl_read_key-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4505</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_read_key</span>()
  <span class="ruby-ivar">@rl_key_sequence_length</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_pending_input</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
    <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rl_pending_input</span>
    <span class="ruby-identifier">rl_clear_pending_input</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-comment"># If the user has an event function, then call it periodically.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_event_hook</span>)
      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_event_hook</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">c</span>=<span class="ruby-identifier">rl_get_char</span>()).<span class="ruby-identifier">nil?</span>)

        <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_event_hook</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_done</span>)     <span class="ruby-comment"># XXX - experimental</span>
          <span class="ruby-keyword">return</span> (<span class="ruby-string">&quot;\n&quot;</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl_gather_tyi</span>() <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)   <span class="ruby-comment"># XXX - EIO</span>
          <span class="ruby-ivar">@rl_done</span> = <span class="ruby-keyword">true</span>
          <span class="ruby-keyword">return</span> (<span class="ruby-string">&quot;\n&quot;</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">else</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">c</span>=<span class="ruby-identifier">rl_get_char</span>()).<span class="ruby-identifier">nil?</span>
        <span class="ruby-identifier">c</span> = <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_getc_function</span>,<span class="ruby-ivar">@rl_instream</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> (<span class="ruby-identifier">c</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_redisplay" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_redisplay</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Basic redisplay algorithm.</p>
          
          

          
          <div class="method-source-code" id="rl_redisplay-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3119</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_redisplay</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@readline_echoing_p</span>

  <span class="ruby-identifier">_rl_wrapped_multicolumn</span> = <span class="ruby-value">0</span>

  <span class="ruby-ivar">@rl_display_prompt</span> <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;&quot;</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@vis_lbreaks</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">init_line_structures</span>(<span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_on_new_line</span>()
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Draw the line into the buffer.</span>
  <span class="ruby-ivar">@cpos_buffer_position</span> = <span class="ruby-value">-1</span>

  <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@invisible_line</span>
  <span class="ruby-identifier">out</span> = <span class="ruby-identifier">inv_botlin</span> = <span class="ruby-value">0</span>

  <span class="ruby-comment"># Mark the line as modified or not.  We only do this for history</span>
  <span class="ruby-comment">#   lines.</span>
  <span class="ruby-identifier">modmark</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_mark_modified_lines</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_history</span>() <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_undo_list</span>)
    <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39;*&#39;</span>
    <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-identifier">modmark</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If someone thought that the redisplay was handled, but the currently</span>
  <span class="ruby-comment">#   visible line has a different modification state than the one about</span>
  <span class="ruby-comment">#   to become visible, then correct the caller&#39;s misconception.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@visible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>])
    <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If the prompt to be displayed is the `primary&#39; readline prompt (the</span>
  <span class="ruby-comment">#   one passed to readline()), use the values we have already expanded.</span>
  <span class="ruby-comment">#   If not, use what&#39;s already in rl_display_prompt.  WRAP_OFFSET is the</span>
  <span class="ruby-comment">#   number of non-visible characters in the prompt string.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_display_prompt</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@local_prompt</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@local_prompt_prefix</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@forced_display</span>)
      <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-ivar">@local_prompt_prefix</span>,<span class="ruby-value">0</span>,<span class="ruby-ivar">@local_prompt_prefix</span>.<span class="ruby-identifier">length</span>)
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@local_prompt_len</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)

      <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@local_prompt_len</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">out</span> <span class="ruby-operator">+</span> <span class="ruby-value">2</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>)
        <span class="ruby-ivar">@line_size</span> = (<span class="ruby-identifier">temp</span> <span class="ruby-operator">+</span> <span class="ruby-value">1024</span>) <span class="ruby-operator">-</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">%</span> <span class="ruby-value">1024</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>
          <span class="ruby-ivar">@visible_line</span> = <span class="ruby-ivar">@visible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@line_size</span>]
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@visible_line</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span>)
        <span class="ruby-keyword">end</span>

        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>
          <span class="ruby-ivar">@invisible_line</span> = <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@line_size</span>]
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@invisible_line</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-ivar">@encoding</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;X&#39;</span>
          <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;ASCII-8BIT&#39;</span>)
          <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;ASCII-8BIT&#39;</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@invisible_line</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-ivar">@local_prompt_len</span>] = <span class="ruby-ivar">@local_prompt</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@local_prompt_len</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-ivar">@wrap_offset</span> = <span class="ruby-ivar">@local_prompt_len</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@prompt_visible_length</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">prompt_this_line</span> = <span class="ruby-ivar">@rl_display_prompt</span>.<span class="ruby-identifier">rindex</span>(<span class="ruby-string">&quot;\n&quot;</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">prompt_this_line</span>.<span class="ruby-identifier">nil?</span>
      <span class="ruby-identifier">prompt_this_line</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">prompt_this_line</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>

      <span class="ruby-identifier">pmtlen</span> = <span class="ruby-identifier">prompt_this_line</span> <span class="ruby-comment"># temp var</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@forced_display</span>)
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-ivar">@rl_display_prompt</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">pmtlen</span>)
        <span class="ruby-comment"># Make sure we are at column zero even after a newline,</span>
        <span class="ruby-comment">#regardless of the state of terminal output processing.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">pmtlen</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_display_prompt</span>[<span class="ruby-identifier">prompt_this_line</span><span class="ruby-operator">-</span><span class="ruby-value">2</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&quot;\r&quot;</span>)
          <span class="ruby-identifier">cr</span>()
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-identifier">pmtlen</span> = <span class="ruby-ivar">@rl_display_prompt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">prompt_this_line</span>
    <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">pmtlen</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">out</span> <span class="ruby-operator">+</span> <span class="ruby-value">2</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>)
      <span class="ruby-ivar">@line_size</span> = (<span class="ruby-identifier">temp</span> <span class="ruby-operator">+</span> <span class="ruby-value">1024</span>) <span class="ruby-operator">-</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">%</span> <span class="ruby-value">1024</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>
        <span class="ruby-ivar">@visible_line</span> = <span class="ruby-ivar">@visible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@line_size</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@visible_line</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>
        <span class="ruby-ivar">@invisible_line</span> = <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@line_size</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@invisible_line</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@encoding</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;X&#39;</span>
        <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;ASCII-8BIT&#39;</span>)
        <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;ASCII-8BIT&#39;</span>)
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@invisible_line</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-identifier">pmtlen</span>] = <span class="ruby-ivar">@rl_display_prompt</span>[<span class="ruby-identifier">prompt_this_line</span>,<span class="ruby-identifier">pmtlen</span>]
    <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">pmtlen</span>
    <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
    <span class="ruby-ivar">@wrap_offset</span> = <span class="ruby-ivar">@prompt_invis_chars_first_line</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-comment"># inv_lbreaks[i] is where line i starts in the buffer.</span>
  <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span> = <span class="ruby-value">0</span>] = <span class="ruby-value">0</span>
  <span class="ruby-identifier">lpos</span> = <span class="ruby-ivar">@prompt_physical_chars</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">modmark</span>

  <span class="ruby-ivar">@_rl_wrapped_line</span> = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span>,<span class="ruby-value">0</span>)
  <span class="ruby-identifier">num</span> = <span class="ruby-value">0</span>

  <span class="ruby-comment"># prompt_invis_chars_first_line is the number of invisible characters in</span>
  <span class="ruby-comment">#   the first physical line of the prompt.</span>
  <span class="ruby-comment">#  wrap_offset - prompt_invis_chars_first_line is the number of invis</span>
  <span class="ruby-comment">#   chars on the second line.</span>

  <span class="ruby-comment"># what if lpos is already &gt;= _rl_screenwidth before we start drawing the</span>
  <span class="ruby-comment">#   contents of the command line?</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
    <span class="ruby-comment"># fix from Darin Johnson &lt;darin@acuson.com&gt; for prompt string with</span>
    <span class="ruby-comment">#   invisible characters that is longer than the screen width.  The</span>
    <span class="ruby-comment">#   prompt_invis_chars_first_line variable could be made into an array</span>
    <span class="ruby-comment">#   saying how many invisible characters there are per line, but that&#39;s</span>
    <span class="ruby-comment">#   probably too much work for the benefit gained.  How many people have</span>
    <span class="ruby-comment">#   prompts that exceed two physical lines?</span>
    <span class="ruby-comment">#   Additional logic fix from Edward Catmur &lt;ed@catmur.co.uk&gt;</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
      <span class="ruby-identifier">n0</span> = <span class="ruby-identifier">num</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@local_prompt_len</span>
      <span class="ruby-keyword">while</span> (<span class="ruby-identifier">num</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">temp</span>)
        <span class="ruby-identifier">z</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-ivar">@local_prompt</span>, <span class="ruby-identifier">n0</span>, <span class="ruby-identifier">num</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">z</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-identifier">num</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@local_prompt</span>, <span class="ruby-identifier">num</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">z</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-keyword">break</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">num</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">num</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">temp</span> = ((<span class="ruby-identifier">newlines</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>) <span class="ruby-operator">*</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># Now account for invisible characters in the current line.</span>
    <span class="ruby-identifier">temp</span> <span class="ruby-operator">+=</span> (<span class="ruby-ivar">@local_prompt_prefix</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">?</span> ((<span class="ruby-identifier">newlines</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@prompt_invis_chars_first_line</span> <span class="ruby-operator">:</span>
                                          ((<span class="ruby-identifier">newlines</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)) <span class="ruby-operator">:</span>
                                          ((<span class="ruby-identifier">newlines</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>))

    <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">temp</span>
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-identifier">lpos</span> <span class="ruby-operator">-=</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-ivar">@local_prompt</span>, <span class="ruby-identifier">n0</span>, <span class="ruby-identifier">num</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">lpos</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@_rl_screenwidth</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@prompt_last_screen_line</span> = <span class="ruby-identifier">newlines</span>

  <span class="ruby-comment"># Draw the rest of the line (after the prompt) into invisible_line, keeping</span>
  <span class="ruby-comment">#   track of where the cursor is (cpos_buffer_position), the number of the line containing</span>
  <span class="ruby-comment">#   the cursor (lb_linenum), the last line number (inv_botlin).</span>
  <span class="ruby-comment">#   It maintains an array of line breaks for display (inv_lbreaks).</span>
  <span class="ruby-comment">#   This handles expanding tabs for display and displaying meta characters.</span>
  <span class="ruby-identifier">lb_linenum</span> = <span class="ruby-value">0</span>
  <span class="ruby-identifier">_in</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_end</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>
    <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
      <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@rl_end</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
      <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@rl_end</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
      <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@rl_end</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
      <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@rl_end</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>]
      <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">bytesize</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">while</span>(<span class="ruby-identifier">_in</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)

    <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_in</span>,<span class="ruby-value">1</span>]
    <span class="ruby-keyword">if</span>(<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
      <span class="ruby-ivar">@rl_end</span> = <span class="ruby-identifier">_in</span>
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
      <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
        <span class="ruby-identifier">wc_width</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;U&#39;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
        <span class="ruby-identifier">wc_width</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">ord</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">wc_width</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">out</span> <span class="ruby-operator">+</span> <span class="ruby-value">8</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@line_size</span>)    <span class="ruby-comment"># XXX - 8 for \t</span>
      <span class="ruby-ivar">@line_size</span> <span class="ruby-operator">*=</span> <span class="ruby-value">2</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;=</span><span class="ruby-ivar">@line_size</span>
        <span class="ruby-ivar">@visible_line</span> = <span class="ruby-ivar">@visible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@line_size</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@visible_line</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-ivar">@visible_line</span>.<span class="ruby-identifier">length</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> <span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span><span class="ruby-operator">&gt;=</span><span class="ruby-ivar">@line_size</span>
        <span class="ruby-ivar">@invisible_line</span> = <span class="ruby-ivar">@invisible_line</span>[<span class="ruby-value">0</span>,<span class="ruby-ivar">@line_size</span>]
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@invisible_line</span> <span class="ruby-operator">+=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> (<span class="ruby-ivar">@line_size</span><span class="ruby-operator">-</span><span class="ruby-ivar">@invisible_line</span>.<span class="ruby-identifier">length</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">line</span> = <span class="ruby-ivar">@invisible_line</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_in</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_point</span>)
      <span class="ruby-ivar">@cpos_buffer_position</span> = <span class="ruby-identifier">out</span>
      <span class="ruby-identifier">lb_linenum</span> = <span class="ruby-identifier">newlines</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">meta_char</span>(<span class="ruby-identifier">c</span>))
      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_output_meta_chars</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">false</span>)
        <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">4</span>] = <span class="ruby-string">&quot;\\%03o&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">ord</span>

        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">+</span> <span class="ruby-value">4</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lpos</span>
          <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">temp</span>
          <span class="ruby-identifier">lpos</span> = <span class="ruby-value">4</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">temp</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">lpos</span> <span class="ruby-operator">+=</span> <span class="ruby-value">4</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">4</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-identifier">c</span>
        <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-identifier">lpos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
          <span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">_rl_wrapped_multicolumn</span>
          <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\t&quot;</span>)

      <span class="ruby-identifier">newout</span> = <span class="ruby-identifier">out</span> <span class="ruby-operator">+</span> <span class="ruby-value">8</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lpos</span> <span class="ruby-operator">%</span> <span class="ruby-value">8</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">newout</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">out</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">temp</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
        <span class="ruby-identifier">temp2</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lpos</span>
        <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">temp2</span>
        <span class="ruby-identifier">lpos</span> = <span class="ruby-identifier">temp</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">temp2</span>
        <span class="ruby-keyword">while</span> (<span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">newout</span>)
          <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39; &#39;</span>
          <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">else</span>

        <span class="ruby-keyword">while</span> (<span class="ruby-identifier">out</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">newout</span>)
          <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39; &#39;</span>
          <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">lpos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">temp</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\n&quot;</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_up</span>)
      <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-comment"># XXX - sentinel</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
      <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RUBOUT</span>)
      <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39;^&#39;</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">lpos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
        <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
        <span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">_rl_wrapped_multicolumn</span>
        <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># NOTE: c[0].ord works identically on both 1.8 and 1.9</span>
      <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-identifier">ctrl_char</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">?</span> (<span class="ruby-identifier">c</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ord</span><span class="ruby-operator">|</span><span class="ruby-value">0x40</span>).<span class="ruby-identifier">chr</span>.<span class="ruby-identifier">upcase</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39;?&#39;</span>
      <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">lpos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
        <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
        <span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">_rl_wrapped_multicolumn</span>
        <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
        <span class="ruby-identifier">_rl_wrapped_multicolumn</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">lpos</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">wc_width</span>)
          <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-identifier">lpos</span> <span class="ruby-operator">...</span> <span class="ruby-ivar">@_rl_screenwidth</span>
            <span class="ruby-comment"># The space will be removed in update_line()</span>
            <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39; &#39;</span>
            <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
            <span class="ruby-identifier">_rl_wrapped_multicolumn</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
            <span class="ruby-identifier">lpos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
            <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
              <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
              <span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">_rl_wrapped_multicolumn</span>
              <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
            <span class="ruby-keyword">end</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">_in</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_point</span>)
          <span class="ruby-ivar">@cpos_buffer_position</span> = <span class="ruby-identifier">out</span>
          <span class="ruby-identifier">lb_linenum</span> = <span class="ruby-identifier">newlines</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-identifier">wc_bytes</span>] = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_in</span>,<span class="ruby-identifier">wc_bytes</span>]
        <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">wc_bytes</span>
        <span class="ruby-keyword">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword">in</span> <span class="ruby-value">0</span> <span class="ruby-operator">...</span> <span class="ruby-identifier">wc_width</span>
          <span class="ruby-identifier">lpos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
          <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
            <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
            <span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">_rl_wrapped_multicolumn</span>
            <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-identifier">c</span>
        <span class="ruby-identifier">out</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-identifier">lpos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lpos</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
          <span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">newlines</span>] = <span class="ruby-identifier">_rl_wrapped_multicolumn</span>
          <span class="ruby-identifier">lpos</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
      <span class="ruby-identifier">_in</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">wc_bytes</span>
      <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_in</span>,<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">_in</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_in</span>,<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">_in</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_in</span>,<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">_in</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
        <span class="ruby-identifier">wc</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_in</span>,<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">_in</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>]
        <span class="ruby-identifier">wc_bytes</span> = <span class="ruby-identifier">wc</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">bytesize</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_in</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">line</span>[<span class="ruby-identifier">out</span>,<span class="ruby-value">1</span>] = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@cpos_buffer_position</span> = <span class="ruby-identifier">out</span>
    <span class="ruby-identifier">lb_linenum</span> = <span class="ruby-identifier">newlines</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">inv_botlin</span> = <span class="ruby-identifier">newlines</span>
  <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">newlines</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] = <span class="ruby-identifier">out</span>
  <span class="ruby-identifier">cursor_linenum</span> = <span class="ruby-identifier">lb_linenum</span>

  <span class="ruby-comment"># CPOS_BUFFER_POSITION == position in buffer where cursor should be placed.</span>
  <span class="ruby-comment">#   CURSOR_LINENUM == line number where the cursor should be placed.</span>

  <span class="ruby-comment"># PWP: now is when things get a bit hairy.  The visible and invisible</span>
  <span class="ruby-comment">#   line buffers are really multiple lines, which would wrap every</span>
  <span class="ruby-comment">#   (screenwidth - 1) characters.  Go through each in turn, finding</span>
  <span class="ruby-comment">#   the changed region and updating it.  The line order is top to bottom.</span>

  <span class="ruby-comment"># If we can move the cursor up and down, then use multiple lines,</span>
  <span class="ruby-comment">#   otherwise, let long lines display in a single terminal line, and</span>
  <span class="ruby-comment">#   horizontally scroll it.</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_up</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_display_fixed</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@forced_display</span>)
      <span class="ruby-ivar">@forced_display</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-comment"># If we have more than a screenful of material to display, then</span>
      <span class="ruby-comment">#   only display a screenful.  We should display the last screen,</span>
      <span class="ruby-comment">#   not the first.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">out</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_screenchars</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
          <span class="ruby-identifier">out</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-identifier">line</span>, <span class="ruby-ivar">@_rl_screenchars</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">out</span> = <span class="ruby-ivar">@_rl_screenchars</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># The first line is at character position 0 in the buffer.  The</span>
      <span class="ruby-comment">#   second and subsequent lines start at inv_lbreaks[N], offset by</span>
      <span class="ruby-comment">#   OFFSET (which has already been calculated above).</span>

      <span class="ruby-comment"># For each line in the buffer, do the updating display.</span>
      <span class="ruby-identifier">linenum</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">while</span> <span class="ruby-identifier">linenum</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">inv_botlin</span>
        <span class="ruby-comment"># This can lead us astray if we execute a program that changes</span>
        <span class="ruby-comment">#the locale from a non-multibyte to a multibyte one.</span>
        <span class="ruby-identifier">o_cpos</span> = <span class="ruby-ivar">@_rl_last_c_pos</span>
        <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">false</span>
        <span class="ruby-identifier">update_line</span>(<span class="ruby-ivar">@visible_line</span>,<span class="ruby-identifier">vis_pos</span>(<span class="ruby-identifier">linenum</span>), <span class="ruby-identifier">inv_line</span>(<span class="ruby-identifier">linenum</span>), <span class="ruby-identifier">linenum</span>,
                    <span class="ruby-identifier">vis_llen</span>(<span class="ruby-identifier">linenum</span>), <span class="ruby-identifier">inv_llen</span>(<span class="ruby-identifier">linenum</span>), <span class="ruby-identifier">inv_botlin</span>)

        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">linenum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-operator">!</span><span class="ruby-ivar">@cpos_adjusted</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">o_cpos</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-identifier">o_cpos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@prompt_last_invisible</span>)
          <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@wrap_offset</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># If this is the line with the prompt, we might need to</span>
        <span class="ruby-comment"># compensate for invisible characters in the new line. Do</span>
        <span class="ruby-comment"># this only if there is not more than one new line (which</span>
        <span class="ruby-comment"># implies that we completely overwrite the old visible line)</span>
        <span class="ruby-comment"># and the new line is shorter than the old.  Make sure we are</span>
        <span class="ruby-comment"># at the end of the new line before clearing.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">linenum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span>
            <span class="ruby-identifier">inv_botlin</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">out</span> <span class="ruby-operator">&amp;&amp;</span>
            (<span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@visible_wrap_offset</span>) <span class="ruby-operator">&amp;&amp;</span>
            (<span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@visible_first_line_len</span>))
          <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
            <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@_rl_last_c_pos</span>
          <span class="ruby-keyword">else</span>
            <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@_rl_last_c_pos</span>
          <span class="ruby-keyword">end</span>
          <span class="ruby-keyword">if</span> (<span class="ruby-identifier">nleft!</span>=<span class="ruby-value">0</span>)
            <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-identifier">nleft</span>)
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-comment"># Since the new first line is now visible, save its length.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">linenum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
          <span class="ruby-ivar">@visible_first_line_len</span> = (<span class="ruby-identifier">inv_botlin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-value">1</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">out</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@wrap_offset</span>
        <span class="ruby-keyword">end</span>

        <span class="ruby-identifier">linenum</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># We may have deleted some lines.  If so, clear the left over</span>
      <span class="ruby-comment">#   blank ones at the bottom out.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_vis_botlin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">inv_botlin</span>)
        <span class="ruby-keyword">while</span>(<span class="ruby-identifier">linenum</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@_rl_vis_botlin</span>)
          <span class="ruby-identifier">tt</span> = <span class="ruby-identifier">vis_chars</span>(<span class="ruby-identifier">linenum</span>)
          <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-identifier">linenum</span>)
          <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-value">0</span>, <span class="ruby-identifier">tt</span>)
          <span class="ruby-identifier">_rl_clear_to_eol</span>((<span class="ruby-identifier">linenum</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_vis_botlin</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">tt</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
          <span class="ruby-identifier">linenum</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@_rl_vis_botlin</span> = <span class="ruby-identifier">inv_botlin</span>

      <span class="ruby-comment"># CHANGED_SCREEN_LINE is set to 1 if we have moved to a</span>
      <span class="ruby-comment">#   different screen line during this redisplay.</span>
      <span class="ruby-identifier">changed_screen_line</span> = <span class="ruby-ivar">@_rl_last_v_pos</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">cursor_linenum</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">changed_screen_line</span>)
        <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-identifier">cursor_linenum</span>)
        <span class="ruby-comment"># If we moved up to the line with the prompt using _rl_term_up,</span>
        <span class="ruby-comment"># the physical cursor position on the screen stays the same,</span>
        <span class="ruby-comment"># but the buffer position needs to be adjusted to account</span>
        <span class="ruby-comment"># for invisible characters.</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cursor_linenum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@wrap_offset</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
          <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@wrap_offset</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># We have to reprint the prompt if it contains invisible</span>
      <span class="ruby-comment">#   characters, since it&#39;s not generally OK to just reprint</span>
      <span class="ruby-comment">#   the characters from the current cursor position.  But we</span>
      <span class="ruby-comment">#   only need to reprint it if the cursor is before the last</span>
      <span class="ruby-comment">#   invisible character in the prompt string.</span>
      <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@prompt_visible_length</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@wrap_offset</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">cursor_linenum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">prompt_ending_index</span>() <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@local_prompt</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_cr</span>)
          <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
        <span class="ruby-keyword">end</span>
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-ivar">@local_prompt</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">nleft</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-ivar">@local_prompt</span>, <span class="ruby-value">0</span>, <span class="ruby-identifier">nleft</span>) <span class="ruby-operator">-</span> <span class="ruby-ivar">@wrap_offset</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">nleft</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Where on that line?  And where does that line start</span>
      <span class="ruby-comment">#   in the buffer?</span>
      <span class="ruby-identifier">pos</span> = <span class="ruby-ivar">@inv_lbreaks</span>[<span class="ruby-identifier">cursor_linenum</span>]
      <span class="ruby-comment"># nleft == number of characters in the line buffer between the</span>
      <span class="ruby-comment">#   start of the line and the desired cursor position.</span>
      <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">pos</span>

      <span class="ruby-comment"># NLEFT is now a number of characters in a buffer.  When in a</span>
      <span class="ruby-comment">#   multibyte locale, however, _rl_last_c_pos is an absolute cursor</span>
      <span class="ruby-comment">#   position that doesn&#39;t take invisible characters in the prompt</span>
      <span class="ruby-comment">#   into account.  We use a fudge factor to compensate.</span>

      <span class="ruby-comment"># Since _rl_backspace() doesn&#39;t know about invisible characters in the</span>
      <span class="ruby-comment">#   prompt, and there&#39;s no good way to tell it, we compensate for</span>
      <span class="ruby-comment">#   those characters here and call _rl_backspace() directly.</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@wrap_offset</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">cursor_linenum</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">nleft</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@_rl_last_c_pos</span>)
        <span class="ruby-comment"># TX == new physical cursor position in multibyte locale.</span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-identifier">tx</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-ivar">@visible_line</span>, <span class="ruby-identifier">pos</span>, <span class="ruby-identifier">pos</span><span class="ruby-operator">+</span><span class="ruby-identifier">nleft</span>) <span class="ruby-operator">-</span> <span class="ruby-ivar">@visible_wrap_offset</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">tx</span> = <span class="ruby-identifier">nleft</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">tx</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">tx</span>
          <span class="ruby-identifier">_rl_backspace</span>(<span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">tx</span>) <span class="ruby-comment"># XXX</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">tx</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># We need to note that in a multibyte locale we are dealing with</span>
      <span class="ruby-comment">#   _rl_last_c_pos as an absolute cursor position, but moving to a</span>
      <span class="ruby-comment">#   point specified by a buffer position (NLEFT) that doesn&#39;t take</span>
      <span class="ruby-comment">#   invisible characters into account.</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-identifier">nleft</span>, <span class="ruby-ivar">@invisible_line</span>,<span class="ruby-identifier">pos</span>)
      <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">nleft</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@_rl_last_c_pos</span>)
        <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-identifier">nleft</span>, <span class="ruby-ivar">@invisible_line</span>,<span class="ruby-identifier">pos</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">else</span>           <span class="ruby-comment"># Do horizontal scrolling.</span>

    <span class="ruby-comment"># Always at top line.</span>
    <span class="ruby-ivar">@_rl_last_v_pos</span> = <span class="ruby-value">0</span>

    <span class="ruby-comment"># Compute where in the buffer the displayed line should start.  This</span>
    <span class="ruby-comment"># will be LMARGIN.</span>

    <span class="ruby-comment"># The number of characters that will be displayed before the cursor.</span>
    <span class="ruby-identifier">ndisp</span> = <span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@wrap_offset</span>
    <span class="ruby-identifier">nleft</span>  = <span class="ruby-ivar">@prompt_visible_length</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@wrap_offset</span>
    <span class="ruby-comment"># Where the new cursor position will be on the screen.  This can be</span>
    <span class="ruby-comment"># longer than SCREENWIDTH; if it is, lmargin will be adjusted.</span>
    <span class="ruby-identifier">phys_c_pos</span> = <span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">-</span> (<span class="ruby-ivar">@last_lmargin</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@last_lmargin</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@wrap_offset</span>)
    <span class="ruby-identifier">t</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">/</span> <span class="ruby-value">3</span>

    <span class="ruby-comment"># If the number of characters had already exceeded the screenwidth,</span>
    <span class="ruby-comment">#last_lmargin will be &gt; 0.</span>

    <span class="ruby-comment"># If the number of characters to be displayed is more than the screen</span>
    <span class="ruby-comment"># width, compute the starting offset so that the cursor is about</span>
    <span class="ruby-comment"># two-thirds of the way across the screen.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">phys_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-value">2</span>)
      <span class="ruby-identifier">lmargin</span> = <span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">-</span> (<span class="ruby-value">2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">t</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lmargin</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">lmargin</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># If the left margin would be in the middle of a prompt with</span>
      <span class="ruby-comment">#   invisible characters, don&#39;t display the prompt at all.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@wrap_offset</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">nleft</span>)
        <span class="ruby-identifier">lmargin</span> = <span class="ruby-identifier">nleft</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">ndisp</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-value">2</span>)      <span class="ruby-comment"># XXX - was -1</span>
      <span class="ruby-identifier">lmargin</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-identifier">phys_c_pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>)
      <span class="ruby-comment"># If we are moving back towards the beginning of the line and</span>
      <span class="ruby-comment">#   the last margin is no longer correct, compute a new one.</span>
      <span class="ruby-identifier">lmargin</span> = ((<span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>) <span class="ruby-operator">/</span> <span class="ruby-identifier">t</span>) <span class="ruby-operator">*</span> <span class="ruby-identifier">t</span> <span class="ruby-comment"># XXX</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@wrap_offset</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">nleft</span>)
        <span class="ruby-identifier">lmargin</span> = <span class="ruby-identifier">nleft</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">lmargin</span> = <span class="ruby-ivar">@last_lmargin</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># If the first character on the screen isn&#39;t the first character</span>
    <span class="ruby-comment">#in the display line, indicate this with a special character.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">lmargin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">line</span>[<span class="ruby-identifier">lmargin</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39;&lt;&#39;</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-comment"># If SCREENWIDTH characters starting at LMARGIN do not encompass</span>
    <span class="ruby-comment"># the whole line, indicate that with a special character at the</span>
    <span class="ruby-comment"># right edge of the screen.  If LMARGIN is 0, we need to take the</span>
    <span class="ruby-comment"># wrap offset into account.</span>
    <span class="ruby-identifier">t</span> = <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">m_offset</span>(<span class="ruby-identifier">lmargin</span>, <span class="ruby-ivar">@wrap_offset</span>) <span class="ruby-operator">+</span> <span class="ruby-ivar">@_rl_screenwidth</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">out</span>)
      <span class="ruby-identifier">line</span>[<span class="ruby-identifier">t</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>] = <span class="ruby-string">&#39;&gt;&#39;</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_display_fixed</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@forced_display</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@last_lmargin</span>)

      <span class="ruby-ivar">@forced_display</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-identifier">update_line</span>(<span class="ruby-ivar">@visible_line</span>,<span class="ruby-ivar">@last_lmargin</span>,<span class="ruby-ivar">@invisible_line</span>[<span class="ruby-identifier">lmargin</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>],
                  <span class="ruby-value">0</span>,
                  <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">+</span> <span class="ruby-ivar">@visible_wrap_offset</span>,
                  <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">+</span> (<span class="ruby-identifier">lmargin</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@wrap_offset</span>),
                  <span class="ruby-value">0</span>)
      <span class="ruby-comment"># If the visible new line is shorter than the old, but the number</span>
      <span class="ruby-comment">#   of invisible characters is greater, and we are at the end of</span>
      <span class="ruby-comment">#   the new line, we need to clear to eol.</span>
      <span class="ruby-identifier">t</span> = <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">m_offset</span>(<span class="ruby-identifier">lmargin</span>, <span class="ruby-ivar">@wrap_offset</span>)
      <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">m_offset</span>(<span class="ruby-identifier">lmargin</span>, <span class="ruby-ivar">@wrap_offset</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@visible_wrap_offset</span>) <span class="ruby-operator">&amp;&amp;</span>
          (<span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">out</span>) <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-identifier">t</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@visible_first_line_len</span>)

        <span class="ruby-identifier">nleft</span> = <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">t</span>
        <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-identifier">nleft</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@visible_first_line_len</span> = <span class="ruby-identifier">out</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lmargin</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">m_offset</span>(<span class="ruby-identifier">lmargin</span>, <span class="ruby-ivar">@wrap_offset</span>)
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@visible_first_line_len</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_screenwidth</span>)
        <span class="ruby-ivar">@visible_first_line_len</span> = <span class="ruby-ivar">@_rl_screenwidth</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-ivar">@cpos_buffer_position</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lmargin</span>, <span class="ruby-ivar">@invisible_line</span> ,<span class="ruby-identifier">lmargin</span>)
      <span class="ruby-ivar">@last_lmargin</span> = <span class="ruby-identifier">lmargin</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">flush</span>

  <span class="ruby-comment"># Swap visible and non-visible lines.</span>
  <span class="ruby-ivar">@visible_line</span>,<span class="ruby-ivar">@invisible_line</span> = <span class="ruby-ivar">@invisible_line</span>,<span class="ruby-ivar">@visible_line</span>
  <span class="ruby-ivar">@vis_lbreaks</span>,<span class="ruby-ivar">@inv_lbreaks</span> = <span class="ruby-ivar">@inv_lbreaks</span>,<span class="ruby-ivar">@vis_lbreaks</span>

  <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-comment"># If we are displaying on a single line, and last_lmargin is &gt; 0, we</span>
  <span class="ruby-comment">#   are not displaying any invisible characters, so set visible_wrap_offset</span>
  <span class="ruby-comment">#   to 0.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@last_lmargin</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
    <span class="ruby-ivar">@visible_wrap_offset</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@visible_wrap_offset</span> = <span class="ruby-ivar">@wrap_offset</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_refresh_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_refresh_line</span><span
            class="method-args">(ignore1, ignore2)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clear the current line.  Numeric argument to C-l does this.</p>
          
          

          
          <div class="method-source-code" id="rl_refresh_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5295</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_refresh_line</span>(<span class="ruby-identifier">ignore1</span>, <span class="ruby-identifier">ignore2</span>)
  <span class="ruby-identifier">curr_line</span> = <span class="ruby-identifier">_rl_current_display_line</span>()

  <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-identifier">curr_line</span>)
  <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-value">0</span>, <span class="ruby-ivar">@rl_line_buffer</span>)   <span class="ruby-comment"># XXX is this right</span>

  <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-value">0</span>)     <span class="ruby-comment"># arg of 0 means to not use spaces</span>

  <span class="ruby-identifier">rl_forced_update_display</span>()
  <span class="ruby-ivar">@rl_display_fixed</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_replace_from_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_replace_from_history</span><span
            class="method-args">(entry, flags)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_replace_from_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6862</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_replace_from_history</span>(<span class="ruby-identifier">entry</span>, <span class="ruby-identifier">flags</span>)
  <span class="ruby-comment"># Can&#39;t call with `1&#39; because rl_undo_list might point to an undo list</span>
  <span class="ruby-comment">#   from a history entry, just like we&#39;re setting up here.</span>
  <span class="ruby-identifier">rl_replace_line</span>(<span class="ruby-identifier">entry</span>.<span class="ruby-identifier">line</span>, <span class="ruby-keyword">false</span>)
  <span class="ruby-ivar">@rl_undo_list</span> = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">data</span>
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-value">0</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_replace_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_replace_line</span><span
            class="method-args">(text, clear_undo)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Replace the current line buffer contents with TEXT.  If CLEAR_UNDO is</p>

<pre>non-zero, we free the current undo list.</pre>
          
          

          
          <div class="method-source-code" id="rl_replace_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4988</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_replace_line</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">clear_undo</span>)
  <span class="ruby-identifier">len</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>).<span class="ruby-identifier">length</span>
  <span class="ruby-ivar">@rl_line_buffer</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">+</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
  <span class="ruby-ivar">@rl_end</span> = <span class="ruby-identifier">len</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">clear_undo</span>)
    <span class="ruby-identifier">rl_free_undo_list</span>()
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_rl_fix_point</span>(<span class="ruby-keyword">true</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_reset_line_state" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_reset_line_state</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_reset_line_state-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 3778</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_reset_line_state</span>()
  <span class="ruby-identifier">rl_on_new_line</span>()

  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-ivar">@forced_display</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_resize_terminal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_resize_terminal</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_resize_terminal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8827</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_resize_terminal</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@readline_echoing_p</span>
    <span class="ruby-identifier">_rl_get_screen_size</span>(<span class="ruby-ivar">@rl_instream</span>.<span class="ruby-identifier">fileno</span>, <span class="ruby-value">1</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_redisplay_function</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:rl_redisplay</span>
      <span class="ruby-identifier">rl_forced_update_display</span>()
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">_rl_redisplay_after_sigwinch</span>()
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_restart_output" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_restart_output</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_restart_output-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1652</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_restart_output</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_restore_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_restore_prompt</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_restore_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7288</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_restore_prompt</span>()
  <span class="ruby-ivar">@local_prompt</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-ivar">@local_prompt</span> = <span class="ruby-ivar">@saved_local_prompt</span>
  <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-ivar">@saved_local_prefix</span>
  <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-ivar">@saved_local_length</span>
  <span class="ruby-ivar">@prompt_prefix_length</span> = <span class="ruby-ivar">@saved_prefix_length</span>
  <span class="ruby-ivar">@prompt_last_invisible</span> = <span class="ruby-ivar">@saved_last_invisible</span>
  <span class="ruby-ivar">@prompt_visible_length</span> = <span class="ruby-ivar">@saved_visible_length</span>
  <span class="ruby-ivar">@prompt_invis_chars_first_line</span> = <span class="ruby-ivar">@saved_invis_chars_first_line</span>
  <span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-ivar">@saved_physical_chars</span>

  <span class="ruby-comment"># can test saved_local_prompt to see if prompt info has been saved.</span>
  <span class="ruby-ivar">@saved_local_prompt</span> = <span class="ruby-ivar">@saved_local_prefix</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@saved_local_length</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@saved_last_invisible</span> = <span class="ruby-ivar">@saved_visible_length</span> = <span class="ruby-ivar">@saved_prefix_length</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@saved_invis_chars_first_line</span> = <span class="ruby-ivar">@saved_physical_chars</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_reverse_search_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_reverse_search_history</span><span
            class="method-args">(sign, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search backwards through the history looking for a string which is typed</p>

<pre>interactively.  Start with the current line.</pre>
          
          

          
          <div class="method-source-code" id="rl_reverse_search_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7135</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_reverse_search_history</span>(<span class="ruby-identifier">sign</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_search_history</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">sign</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_revert_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_revert_line</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Revert the current line to its previous state.</p>
          
          

          
          <div class="method-source-code" id="rl_revert_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7714</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_revert_line</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_undo_list</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_undo_list</span>)
      <span class="ruby-identifier">rl_do_undo</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-value">0</span>      <span class="ruby-comment"># rl_end should be set correctly</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_rubout" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_rubout</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Rubout the character behind point.</p>
          
          

          
          <div class="method-source-code" id="rl_rubout-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5792</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_rubout</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_delete</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_insert_mode</span> <span class="ruby-operator">==</span> <span class="ruby-constant">RL_IM_OVERWRITE</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_overwrite_rubout</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_rl_rubout_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_rubout_or_delete" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_rubout_or_delete</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Delete the character under the cursor, unless the insertion</p>

<pre>point is at the end of the line, in which case the character
behind the cursor is deleted.  COUNT is obeyed and may be used
to delete forward or backward that many characters.</pre>
          
          

          
          <div class="method-source-code" id="rl_rubout_or_delete-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6013</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_rubout_or_delete</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">_rl_rubout_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">rl_delete</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>))
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_save_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_save_prompt</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_save_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7272</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_save_prompt</span>()
  <span class="ruby-ivar">@saved_local_prompt</span> = <span class="ruby-ivar">@local_prompt</span>
  <span class="ruby-ivar">@saved_local_prefix</span> = <span class="ruby-ivar">@local_prompt_prefix</span>
  <span class="ruby-ivar">@saved_prefix_length</span> = <span class="ruby-ivar">@prompt_prefix_length</span>
  <span class="ruby-ivar">@saved_local_length</span> = <span class="ruby-ivar">@local_prompt_len</span>
  <span class="ruby-ivar">@saved_last_invisible</span> = <span class="ruby-ivar">@prompt_last_invisible</span>
  <span class="ruby-ivar">@saved_visible_length</span> = <span class="ruby-ivar">@prompt_visible_length</span>
  <span class="ruby-ivar">@saved_invis_chars_first_line</span> = <span class="ruby-ivar">@prompt_invis_chars_first_line</span>
  <span class="ruby-ivar">@saved_physical_chars</span> = <span class="ruby-ivar">@prompt_physical_chars</span>

  <span class="ruby-ivar">@local_prompt</span> = <span class="ruby-ivar">@local_prompt_prefix</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@local_prompt_len</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@prompt_last_invisible</span> = <span class="ruby-ivar">@prompt_visible_length</span> = <span class="ruby-ivar">@prompt_prefix_length</span> = <span class="ruby-value">0</span>
  <span class="ruby-ivar">@prompt_invis_chars_first_line</span> = <span class="ruby-ivar">@prompt_physical_chars</span> = <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_search_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_search_history</span><span
            class="method-args">(direction, invoking_key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Search through the history looking for an interactively typed string.</p>

<pre>This is analogous to i-search.  We start the search in the current line.
DIRECTION is which direction to search; &gt;= 0 means forward, &lt; 0 means
backwards.</pre>
          
          

          
          <div class="method-source-code" id="rl_search_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7149</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_search_history</span>(<span class="ruby-identifier">direction</span>, <span class="ruby-identifier">invoking_key</span>)
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_ISEARCH</span>)
  <span class="ruby-identifier">cxt</span> = <span class="ruby-identifier">_rl_isearch_init</span>(<span class="ruby-identifier">direction</span>)

  <span class="ruby-identifier">rl_display_search</span>(<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">search_string</span>, (<span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">sflags</span> <span class="ruby-operator">&amp;</span> <span class="ruby-constant">SF_REVERSE</span>)<span class="ruby-operator">!=</span><span class="ruby-value">0</span>, <span class="ruby-value">-1</span>)

  <span class="ruby-comment"># If we are using the callback interface, all we do is set up here and</span>
  <span class="ruby-comment">#    return.  The key is that we leave RL_STATE_ISEARCH set.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_CALLBACK</span>))
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">r</span> = <span class="ruby-value">-1</span>
  <span class="ruby-keyword">while</span>(<span class="ruby-keyword">true</span>)
    <span class="ruby-identifier">_rl_search_getchar</span>(<span class="ruby-identifier">cxt</span>)
    <span class="ruby-comment"># We might want to handle EOF here (c == 0)</span>
    <span class="ruby-identifier">r</span> = <span class="ruby-identifier">_rl_isearch_dispatch</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">cxt</span>.<span class="ruby-identifier">lastc</span>)
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">r</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># The searching is over.  The user may have found the string that she</span>
  <span class="ruby-comment">#   was looking for, or else she may have exited a failing search.  If</span>
  <span class="ruby-comment">#   LINE_INDEX is -1, then that shows that the string searched for was</span>
  <span class="ruby-comment">#   not found.  We use this to determine where to place rl_point.</span>
  <span class="ruby-identifier">_rl_isearch_cleanup</span>(<span class="ruby-identifier">cxt</span>, <span class="ruby-identifier">r</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_set_keymap_from_edit_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_set_keymap_from_edit_mode</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_set_keymap_from_edit_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2431</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_set_keymap_from_edit_mode</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
    <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-ivar">@emacs_standard_keymap</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-ivar">@vi_insertion_keymap</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_set_mark" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_set_mark</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A bindable command to set the mark.</p>
          
          

          
          <div class="method-source-code" id="rl_set_mark-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7078</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_set_mark</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_set_mark_at_pos</span>(<span class="ruby-ivar">@rl_explicit_arg</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">count</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@rl_point</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_set_prompt" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_set_prompt</span><span
            class="method-args">(prompt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set up the prompt and expand it.  Called from readline() and</p>

<pre>rl_callback_handler_install ().</pre>
          
          

          
          <div class="method-source-code" id="rl_set_prompt-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1804</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_set_prompt</span>(<span class="ruby-identifier">prompt</span>)
  <span class="ruby-ivar">@rl_prompt</span> = <span class="ruby-identifier">prompt</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">prompt</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-ivar">@rl_display_prompt</span> = <span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_prompt</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;&quot;</span>
  <span class="ruby-ivar">@rl_visible_prompt_length</span> = <span class="ruby-identifier">rl_expand_prompt</span>(<span class="ruby-ivar">@rl_prompt</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_set_signals" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_set_signals</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_set_signals-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1662</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_set_signals</span>()
  <span class="ruby-keyword">if</span> <span class="ruby-constant">Signal</span>.<span class="ruby-identifier">list</span>[<span class="ruby-string">&#39;WINCH&#39;</span>]
    <span class="ruby-ivar">@def_proc</span> = <span class="ruby-identifier">trap</span> <span class="ruby-string">&quot;WINCH&quot;</span>,<span class="ruby-constant">Proc</span>.<span class="ruby-identifier">new</span>{<span class="ruby-identifier">rl_sigwinch_handler</span>(<span class="ruby-value">0</span>)}
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_setstate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_setstate</span><span
            class="method-args">(x)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_setstate-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1633</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-identifier">x</span>)
  (<span class="ruby-ivar">@rl_readline_state</span> <span class="ruby-operator">|=</span> (<span class="ruby-identifier">x</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_sigwinch_handler" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_sigwinch_handler</span><span
            class="method-args">(sig)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_sigwinch_handler-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8838</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_sigwinch_handler</span>(<span class="ruby-identifier">sig</span>)
  <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_SIGHANDLER</span>)
  <span class="ruby-identifier">rl_resize_terminal</span>()
  <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-constant">RL_STATE_SIGHANDLER</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_stuff_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_stuff_char</span><span
            class="method-args">(key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Add KEY to the buffer of characters to be read.  Returns 1 if the</p>

<pre>character was stuffed correctly; 0 otherwise.</pre>
          
          

          
          <div class="method-source-code" id="rl_stuff_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4347</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_stuff_char</span>(<span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ibuffer_space</span>() <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">key</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EOF</span>)
    <span class="ruby-identifier">key</span> = <span class="ruby-constant">NEWLINE</span>
    <span class="ruby-ivar">@rl_pending_input</span> = <span class="ruby-constant">EOF</span>
    <span class="ruby-identifier">rl_setstate</span>(<span class="ruby-constant">RL_STATE_INPUTPENDING</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@ibuffer</span>[<span class="ruby-ivar">@push_index</span>] = <span class="ruby-identifier">key</span>
  <span class="ruby-ivar">@push_index</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@push_index</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@ibuffer_len</span>)
    <span class="ruby-ivar">@push_index</span> = <span class="ruby-value">0</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">return</span> <span class="ruby-value">1</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_tab_insert" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_tab_insert</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Insert a tab character.</p>
          
          

          
          <div class="method-source-code" id="rl_tab_insert-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5622</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_tab_insert</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_rl_insert_char</span>(<span class="ruby-identifier">count</span>, <span class="ruby-string">&quot;\t&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_tilde_expand" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_tilde_expand</span><span
            class="method-args">(ignore, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A function for simple tilde expansion.</p>
          
          

          
          <div class="method-source-code" id="rl_tilde_expand-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1466</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_tilde_expand</span>(<span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">_end</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">start</span> = <span class="ruby-identifier">_end</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;~&#39;</span> )
    <span class="ruby-identifier">homedir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-string">&quot;~&quot;</span>)
    <span class="ruby-identifier">_rl_replace_text</span>(<span class="ruby-identifier">homedir</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
    <span class="ruby-keyword">return</span> (<span class="ruby-value">0</span>)
  <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;~&#39;</span>)
    <span class="ruby-keyword">while</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span>,<span class="ruby-value">1</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">start</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">start</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">start</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">_end</span> = <span class="ruby-identifier">start</span>
  <span class="ruby-keyword">begin</span>
    <span class="ruby-identifier">_end</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span> <span class="ruby-keyword">while</span>(<span class="ruby-operator">!</span><span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_end</span>,<span class="ruby-value">1</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">_end</span> <span class="ruby-operator">&lt;</span> <span class="ruby-ivar">@rl_end</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">_end</span>,<span class="ruby-value">1</span>]) <span class="ruby-operator">||</span> <span class="ruby-identifier">_end</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-identifier">_end</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If the first character of the current word is a tilde, perform</span>
  <span class="ruby-comment">#tilde expansion and insert the result.  If not a tilde, do</span>
  <span class="ruby-comment">#   nothing.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&#39;~&#39;</span>)

    <span class="ruby-identifier">len</span> = <span class="ruby-identifier">_end</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">start</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>
    <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">start</span>,<span class="ruby-identifier">len</span>]
    <span class="ruby-identifier">homedir</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">expand_path</span>(<span class="ruby-identifier">temp</span>)
    <span class="ruby-identifier">temp</span> = <span class="ruby-keyword">nil</span>

    <span class="ruby-identifier">_rl_replace_text</span>(<span class="ruby-identifier">homedir</span>, <span class="ruby-identifier">start</span>, <span class="ruby-identifier">_end</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_transpose_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_transpose_chars</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Transpose the characters at point.  If point is at the end of the line,</p>

<pre>then transpose the characters before point.</pre>
          
          

          
          <div class="method-source-code" id="rl_transpose_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7346</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_transpose_chars</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">==</span><span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_begin_undo_group</span>()

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">count</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">prev_point</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-ivar">@rl_line_buffer</span>, <span class="ruby-ivar">@rl_point</span>, <span class="ruby-constant">MB_FIND_NONZERO</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">char_length</span> = <span class="ruby-identifier">prev_point</span> <span class="ruby-operator">-</span> <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">dummy</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span>,<span class="ruby-identifier">char_length</span>]

  <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">char_length</span>)

  <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">count</span>
  <span class="ruby-identifier">_rl_fix_point</span>(<span class="ruby-value">0</span>)
  <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">dummy</span>)
  <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-identifier">dummy</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_transpose_words" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_transpose_words</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Transpose the words at point.  If point is at the end of the line,</p>

<pre>transpose the two words before point.</pre>
          
          

          
          <div class="method-source-code" id="rl_transpose_words-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8253</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_transpose_words</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>

  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>)

  <span class="ruby-comment"># Find the two words.</span>
  <span class="ruby-identifier">rl_forward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">w2_end</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">rl_backward_word</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">w2_beg</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">rl_backward_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">w1_beg</span> = <span class="ruby-ivar">@rl_point</span>
  <span class="ruby-identifier">rl_forward_word</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">w1_end</span> = <span class="ruby-ivar">@rl_point</span>

  <span class="ruby-comment"># Do some check to make sure that there really are two words.</span>
  <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">w1_beg</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">w2_beg</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">w2_beg</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">w1_end</span>))
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">orig_point</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Get the text of the words.</span>
  <span class="ruby-identifier">word1</span> = <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">w1_beg</span>, <span class="ruby-identifier">w1_end</span>)
  <span class="ruby-identifier">word2</span> = <span class="ruby-identifier">rl_copy_text</span>(<span class="ruby-identifier">w2_beg</span>, <span class="ruby-identifier">w2_end</span>)

  <span class="ruby-comment"># We are about to do many insertions and deletions.  Remember them</span>
  <span class="ruby-comment">#   as one operation.</span>
  <span class="ruby-identifier">rl_begin_undo_group</span>()

  <span class="ruby-comment"># Do the stuff at word2 first, so that we don&#39;t have to worry</span>
  <span class="ruby-comment">#   about word1 moving.</span>
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">w2_beg</span>
  <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">w2_beg</span>, <span class="ruby-identifier">w2_end</span>)
  <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">word1</span>)

  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">w1_beg</span>
  <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">w1_beg</span>, <span class="ruby-identifier">w1_end</span>)
  <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">word2</span>)

  <span class="ruby-comment"># This is exactly correct since the text before this point has not</span>
  <span class="ruby-comment">#   changed in length.</span>
  <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">w2_end</span>

  <span class="ruby-comment"># I think that does it.</span>
  <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-identifier">word1</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">word2</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_tty_set_default_bindings" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_tty_set_default_bindings</span><span
            class="method-args">(kmap)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>New public way to set the system default editing chars to their readline</p>

<pre>equivalents.</pre>
          
          

          
          <div class="method-source-code" id="rl_tty_set_default_bindings-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2056</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_tty_set_default_bindings</span>(<span class="ruby-identifier">kmap</span>)
  <span class="ruby-identifier">h</span> = {}
  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">h</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-value">%xstty -a`</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/(\w+) = ([^;]+);/</span>).<span class="ruby-identifier">flatten</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">h</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\^(.)/</span>){(<span class="ruby-node">$1</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ord</span> <span class="ruby-operator">^</span> ((<span class="ruby-value">?a</span><span class="ruby-operator">..</span><span class="ruby-value">?z</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-node">$1</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">?</span> <span class="ruby-value">0x60</span> <span class="ruby-operator">:</span> <span class="ruby-value">0x40</span>)).<span class="ruby-identifier">chr</span>}}
  <span class="ruby-identifier">kmap</span>[<span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;erase&#39;</span>]] = <span class="ruby-value">:rl_rubout</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;kill&#39;</span>]] = <span class="ruby-value">:rl_unix_line_discard</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;werase&#39;</span>]] = <span class="ruby-value">:rl_unix_word_rubout</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;lnext&#39;</span>]] = <span class="ruby-value">:rl_quoted_insert</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_tty_unset_default_bindings" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_tty_unset_default_bindings</span><span
            class="method-args">(kmap)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Rebind all of the tty special chars that readline worries about back</p>

<pre>to self-insert.  Call this before saving the current terminal special
chars with save_tty_chars().  This only works on POSIX termios or termio
systems.</pre>
          
          

          
          <div class="method-source-code" id="rl_tty_unset_default_bindings-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6988</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_tty_unset_default_bindings</span>(<span class="ruby-identifier">kmap</span>)
  <span class="ruby-comment"># Don&#39;t bother before we&#39;ve saved the tty special chars at least once.</span>
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">rl_isstate</span>(<span class="ruby-constant">RL_STATE_TTYCSAVED</span>))

  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_erase</span>] = <span class="ruby-value">:rl_insert</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_kill</span>] = <span class="ruby-value">:rl_insert</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_lnext</span>] = <span class="ruby-value">:rl_insert</span>
  <span class="ruby-identifier">kmap</span>[<span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_werase</span>] = <span class="ruby-value">:rl_insert</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_undo_command" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_undo_command</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Do some undoing of things that were done.</p>
          
          

          
          <div class="method-source-code" id="rl_undo_command-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7661</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_undo_command</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span> <span class="ruby-comment"># Nothing to do.</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">rl_do_undo</span>())
      <span class="ruby-identifier">count</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">rl_ding</span>()
      <span class="ruby-keyword">break</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_unix_filename_rubout" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_unix_filename_rubout</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This deletes one filename component in a Unix pathname.  That is, it</p>

<pre>deletes backward to directory separator (`/&#39;) or whitespace.</pre>
          
          

          
          <div class="method-source-code" id="rl_unix_filename_rubout-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5977</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_unix_filename_rubout</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">count</span> = <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)

      <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>]
      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">whitespace</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;/&#39;</span>))
        <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
        <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>]
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">whitespace</span>(<span class="ruby-identifier">c</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">!=</span> <span class="ruby-string">&#39;/&#39;</span>)
        <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
        <span class="ruby-identifier">c</span> = <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>]
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
      <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_unix_line_discard" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_unix_line_discard</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Here is C-u doing what Unix does.  You don&#39;t <strong>have</strong> to
use these key-bindings.  We have a choice of killing the entire line, or
killing from where we are to the start of the line.  We choose the latter,
because if you are a Unix weenie, then you haven&#39;t backspaced into the
line at all, and if you aren&#39;t, then you know what you are doing.</p>
          
          

          
          <div class="method-source-code" id="rl_unix_line_discard-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7391</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_unix_line_discard</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-ivar">@rl_point</span>, <span class="ruby-value">0</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
      <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_unix_word_rubout" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_unix_word_rubout</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This does what C-w does in Unix.  We can&#39;t prevent people from</p>

<pre>using behaviour that they expect.</pre>
          
          

          
          <div class="method-source-code" id="rl_unix_word_rubout-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5947</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_unix_word_rubout</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
    <span class="ruby-identifier">rl_ding</span>()
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">orig_point</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">count</span> = <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">while</span> (<span class="ruby-identifier">count</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>]))
        <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">while</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">whitespace</span>(<span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>,<span class="ruby-value">1</span>]))
        <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">count</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-identifier">rl_kill_text</span>(<span class="ruby-identifier">orig_point</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@emacs_mode</span>)
      <span class="ruby-ivar">@rl_mark</span> = <span class="ruby-ivar">@rl_point</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_unsetstate" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_unsetstate</span><span
            class="method-args">(x)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_unsetstate-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1637</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_unsetstate</span>(<span class="ruby-identifier">x</span>)
  (<span class="ruby-ivar">@rl_readline_state</span> <span class="ruby-operator">&amp;=</span> <span class="ruby-operator">~</span>(<span class="ruby-identifier">x</span>))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_upcase_word" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_upcase_word</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Uppercase the word at point.</p>
          
          

          
          <div class="method-source-code" id="rl_upcase_word-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7876</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_upcase_word</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-identifier">rl_change_case</span>(<span class="ruby-identifier">count</span>, <span class="ruby-constant">UpCase</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_username_completion_function" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_username_completion_function</span><span
            class="method-args">(text, state)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>A completion function for usernames.</p>

<pre>TEXT contains a partial username preceded by a random
character (usually `~&#39;).</pre>
          
          

          
          <div class="method-source-code" id="rl_username_completion_function-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1241</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_username_completion_function</span>(<span class="ruby-identifier">text</span>, <span class="ruby-identifier">state</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/mswin|mingw/</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">state</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>)
      <span class="ruby-identifier">first_char</span> = <span class="ruby-identifier">text</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>]
      <span class="ruby-identifier">first_char_loc</span> = (<span class="ruby-identifier">first_char</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;~&#39;</span> <span class="ruby-operator">?</span> <span class="ruby-value">1</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)

      <span class="ruby-identifier">username</span> = <span class="ruby-identifier">text</span>[<span class="ruby-identifier">first_char_loc</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>]
      <span class="ruby-identifier">namelen</span> = <span class="ruby-identifier">username</span>.<span class="ruby-identifier">length</span>
      <span class="ruby-constant">Etc</span>.<span class="ruby-identifier">setpwent</span>()
    <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">while</span> (<span class="ruby-identifier">entry</span> = <span class="ruby-constant">Etc</span>.<span class="ruby-identifier">getpwent</span>())
    <span class="ruby-comment"># Null usernames should result in all users as possible completions.</span>
    <span class="ruby-keyword">break</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">namelen</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^#{username}/</span> )
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-constant">Etc</span>.<span class="ruby-identifier">endpwent</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">value</span> = <span class="ruby-identifier">text</span>.<span class="ruby-identifier">dup</span>
    <span class="ruby-identifier">value</span>[<span class="ruby-identifier">first_char_loc</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>] = <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">name</span>

    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">first_char</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;~&#39;</span>)
      <span class="ruby-ivar">@rl_filename_completion_desired</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">return</span> (<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_variable_bind" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_variable_bind</span><span
            class="method-args">(name,value)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_variable_bind-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2257</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_variable_bind</span>(<span class="ruby-identifier">name</span>,<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">case</span> <span class="ruby-identifier">name</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;bind-tty-special-chars&quot;</span>
    <span class="ruby-ivar">@_rl_bind_stty_chars</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;blink-matching-paren&quot;</span>
    <span class="ruby-ivar">@rl_blink_matching_paren</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;byte-oriented&quot;</span>
    <span class="ruby-ivar">@rl_byte_oriented</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;completion-ignore-case&quot;</span>
    <span class="ruby-ivar">@_rl_completion_case_fold</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;convert-meta&quot;</span>
    <span class="ruby-ivar">@_rl_convert_meta_chars_to_ascii</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;disable-completion&quot;</span>
    <span class="ruby-ivar">@rl_inhibit_completion</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;enable-keypad&quot;</span>
    <span class="ruby-ivar">@_rl_enable_keypad</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;expand-tilde&quot;</span>
    <span class="ruby-ivar">@rl_complete_with_tilde_expansion</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;history-preserve-point&quot;</span>
    <span class="ruby-ivar">@_rl_history_preserve_point</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;horizontal-scroll-mode&quot;</span>
    <span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;input-meta&quot;</span>
    <span class="ruby-ivar">@_rl_meta_flag</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;mark-directories&quot;</span>
    <span class="ruby-ivar">@_rl_complete_mark_directories</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;mark-modified-lines&quot;</span>
    <span class="ruby-ivar">@_rl_mark_modified_lines</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;mark-symlinked-directories&quot;</span>
    <span class="ruby-ivar">@_rl_complete_mark_symlink_dirs</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;match-hidden-files&quot;</span>
    <span class="ruby-ivar">@_rl_match_hidden_files</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;meta-flag&quot;</span>
    <span class="ruby-ivar">@_rl_meta_flag</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;output-meta&quot;</span>
    <span class="ruby-ivar">@_rl_output_meta_chars</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;page-completions&quot;</span>
    <span class="ruby-ivar">@_rl_page_completions</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;prefer-visible-bell&quot;</span>
    <span class="ruby-ivar">@_rl_prefer_visible_bell</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;print-completions-horizontally&quot;</span>
    <span class="ruby-ivar">@_rl_print_completions_horizontally</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;show-all-if-ambiguous&quot;</span>
    <span class="ruby-ivar">@_rl_complete_show_all</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;show-all-if-unmodified&quot;</span>
    <span class="ruby-ivar">@_rl_complete_show_unmodified</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;visible-stats&quot;</span>
    <span class="ruby-ivar">@rl_visible_stats</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;1&#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;on&#39;</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;bell-style&quot;</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;none&quot;</span>,<span class="ruby-string">&quot;off&quot;</span>
      <span class="ruby-ivar">@_rl_bell_preference</span> = <span class="ruby-constant">NO_BELL</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;audible&quot;</span>, <span class="ruby-string">&quot;on&quot;</span>
      <span class="ruby-ivar">@_rl_bell_preference</span> = <span class="ruby-constant">AUDIBLE_BELL</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;visible&quot;</span>
      <span class="ruby-ivar">@_rl_bell_preference</span> = <span class="ruby-constant">VISIBLE_BELL</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@_rl_bell_preference</span> = <span class="ruby-constant">AUDIBLE_BELL</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;comment-begin&quot;</span>
    <span class="ruby-ivar">@_rl_comment_begin</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">dup</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;completion-query-items&quot;</span>
    <span class="ruby-ivar">@rl_completion_query_items</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_i</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;editing-mode&quot;</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;vi&quot;</span>
      <span class="ruby-comment"># This is a NOOP until the rest of Vi-mode is working.</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;emacs&quot;</span>
      <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-ivar">@emacs_standard_keymap</span>
      <span class="ruby-ivar">@rl_editing_mode</span> = <span class="ruby-ivar">@emacs_mode</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;isearch-terminators&quot;</span>
    <span class="ruby-ivar">@_rl_isearch_terminators</span> = <span class="ruby-identifier">instance_eval</span>(<span class="ruby-identifier">value</span>)
  <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;keymap&quot;</span>
    <span class="ruby-keyword">case</span> <span class="ruby-identifier">value</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;emacs&quot;</span>,<span class="ruby-string">&quot;emacs-standard&quot;</span>,<span class="ruby-string">&quot;emacs-meta&quot;</span>,<span class="ruby-string">&quot;emacs-ctlx&quot;</span>
      <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-ivar">@emacs_standard_keymap</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;vi&quot;</span>,<span class="ruby-string">&quot;vi-move&quot;</span>,<span class="ruby-string">&quot;vi-command&quot;</span>
      <span class="ruby-comment"># This is a NOOP until the rest of Vi-mode is working.</span>
    <span class="ruby-keyword">when</span> <span class="ruby-string">&quot;vi-insert&quot;</span>
      <span class="ruby-comment"># This is a NOOP until the rest of Vi-mode is working.</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_vi_check" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_vi_check</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_vi_check-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4762</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_vi_check</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_point</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_end</span>)
    <span class="ruby-ivar">@rl_point</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_vi_editing_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_vi_editing_mode</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>This is a NOOP until the rest of Vi-mode is working.</p>
          
          

          
          <div class="method-source-code" id="rl_vi_editing_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1427</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_vi_editing_mode</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_vi_insertion_mode" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_vi_insertion_mode</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Switching from one mode to the other really just involves</p>

<pre>switching keymaps.</pre>
          
          

          
          <div class="method-source-code" id="rl_vi_insertion_mode-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1433</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_vi_insertion_mode</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-ivar">@_rl_keymap</span> = <span class="ruby-ivar">@vi_insertion_keymap</span>
  <span class="ruby-ivar">@_rl_vi_last_key_before_insert</span> = <span class="ruby-identifier">key</span>
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_yank" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_yank</span><span
            class="method-args">(count, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Yank back the last killed text.  This ignores arguments.</p>
          
          

          
          <div class="method-source-code" id="rl_yank-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7405</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_yank</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@rl_kill_ring</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">_rl_abort_internal</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">_rl_set_mark_at_pos</span>(<span class="ruby-ivar">@rl_point</span>)
  <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-ivar">@rl_kill_index</span>])
  <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_yank_last_arg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_yank_last_arg</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="rl_yank_last_arg-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7495</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_yank_last_arg</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_last_func</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:rl_yank_last_arg</span>)
    <span class="ruby-ivar">@history_skip</span> = <span class="ruby-value">0</span>
    <span class="ruby-ivar">@explicit_arg_p</span> = <span class="ruby-ivar">@rl_explicit_arg</span>
    <span class="ruby-ivar">@count_passed</span> = <span class="ruby-identifier">count</span>
    <span class="ruby-ivar">@direction</span> = <span class="ruby-value">1</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@undo_needed</span>)
      <span class="ruby-identifier">rl_do_undo</span>()
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">count</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">1</span>)
      <span class="ruby-ivar">@direction</span> = <span class="ruby-operator">-</span><span class="ruby-ivar">@direction</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-ivar">@history_skip</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@direction</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@history_skip</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@history_skip</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@explicit_arg_p</span>)
    <span class="ruby-identifier">retval</span> = <span class="ruby-identifier">rl_yank_nth_arg_internal</span>(<span class="ruby-ivar">@count_passed</span>, <span class="ruby-identifier">key</span>, <span class="ruby-ivar">@history_skip</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">retval</span> = <span class="ruby-identifier">rl_yank_nth_arg_internal</span>(<span class="ruby-string">&#39;$&#39;</span>, <span class="ruby-identifier">key</span>, <span class="ruby-ivar">@history_skip</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@undo_needed</span> = <span class="ruby-identifier">retval</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
  <span class="ruby-identifier">retval</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_yank_nth_arg" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_yank_nth_arg</span><span
            class="method-args">(count, ignore)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Yank the COUNTth argument from the previous history line.</p>
          
          

          
          <div class="method-source-code" id="rl_yank_nth_arg-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7482</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_yank_nth_arg</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>)
  <span class="ruby-identifier">rl_yank_nth_arg_internal</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>, <span class="ruby-value">0</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_yank_nth_arg_internal" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_yank_nth_arg_internal</span><span
            class="method-args">(count, ignore, history_skip)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Yank the COUNTh argument from the previous history line, skipping</p>

<pre>HISTORY_SKIP lines before looking for the `previous line&#39;.</pre>
          
          

          
          <div class="method-source-code" id="rl_yank_nth_arg_internal-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7445</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_yank_nth_arg_internal</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">ignore</span>, <span class="ruby-identifier">history_skip</span>)
  <span class="ruby-identifier">pos</span> = <span class="ruby-identifier">where_history</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">history_skip</span><span class="ruby-operator">&gt;</span><span class="ruby-value">0</span>)
    <span class="ruby-identifier">history_skip</span>.<span class="ruby-identifier">times</span> { <span class="ruby-identifier">previous_history</span>() }
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">entry</span> = <span class="ruby-identifier">previous_history</span>()
  <span class="ruby-identifier">history_set_pos</span>(<span class="ruby-identifier">pos</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">nil?</span>
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">arg</span> = <span class="ruby-identifier">history_arg_extract</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">count</span>, <span class="ruby-identifier">entry</span>.<span class="ruby-identifier">line</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">arg</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">arg</span><span class="ruby-operator">==</span><span class="ruby-string">&#39;&#39;</span>)
    <span class="ruby-identifier">rl_ding</span>()
    <span class="ruby-identifier">arg</span> = <span class="ruby-keyword">nil</span>
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_begin_undo_group</span>()

  <span class="ruby-identifier">_rl_set_mark_at_pos</span>(<span class="ruby-ivar">@rl_point</span>)

  <span class="ruby-comment"># Vi mode always inserts a space before yanking the argument, and it</span>
  <span class="ruby-comment">#   inserts it right *after* rl_point.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_editing_mode</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@vi_mode</span>)
    <span class="ruby-identifier">rl_vi_append_mode</span>(<span class="ruby-value">1</span>, <span class="ruby-identifier">ignore</span>)
    <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-string">&quot; &quot;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_insert_text</span>(<span class="ruby-identifier">arg</span>)
  <span class="ruby-identifier">arg</span> = <span class="ruby-keyword">nil</span>
  <span class="ruby-identifier">rl_end_undo_group</span>()
  <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-rl_yank_pop" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">rl_yank_pop</span><span
            class="method-args">(count, key)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>If the last command was yank, or yank_pop, and the text just</p>

<pre>before point is identical to the current kill item, then
delete that text from the line, rotate the index down, and
yank back some other text.</pre>
          
          

          
          <div class="method-source-code" id="rl_yank_pop-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7419</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">rl_yank_pop</span>(<span class="ruby-identifier">count</span>, <span class="ruby-identifier">key</span>)
  <span class="ruby-keyword">if</span> (((<span class="ruby-ivar">@rl_last_func</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:rl_yank_pop</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-ivar">@rl_last_func</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:rl_yank</span>)) <span class="ruby-operator">||</span>
      <span class="ruby-ivar">@rl_kill_ring</span>.<span class="ruby-identifier">nil?</span>)
    <span class="ruby-identifier">_rl_abort_internal</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">l</span> = <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-ivar">@rl_kill_index</span>].<span class="ruby-identifier">length</span>
  <span class="ruby-identifier">n</span> = <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">l</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">n</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@rl_line_buffer</span>[<span class="ruby-identifier">n</span>,<span class="ruby-identifier">l</span>] <span class="ruby-operator">==</span> <span class="ruby-ivar">@rl_kill_ring</span>[<span class="ruby-ivar">@rl_kill_index</span>][<span class="ruby-value">0</span>,<span class="ruby-identifier">l</span>])
    <span class="ruby-identifier">rl_delete_text</span>(<span class="ruby-identifier">n</span>, <span class="ruby-ivar">@rl_point</span>)
    <span class="ruby-ivar">@rl_point</span> = <span class="ruby-identifier">n</span>
    <span class="ruby-ivar">@rl_kill_index</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_kill_index</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)
      <span class="ruby-ivar">@rl_kill_index</span> = <span class="ruby-ivar">@rl_kill_ring_length</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-identifier">rl_yank</span>(<span class="ruby-value">1</span>, <span class="ruby-value">0</span>)
    <span class="ruby-keyword">return</span> <span class="ruby-value">0</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">_rl_abort_internal</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-value">-1</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-save_tty_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">save_tty_chars</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="save_tty_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6911</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">save_tty_chars</span>()
  <span class="ruby-ivar">@_rl_last_tty_chars</span> = <span class="ruby-ivar">@_rl_tty_chars</span>
  <span class="ruby-identifier">h</span> = {}
  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">h</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-operator">*</span><span class="ruby-value">%xstty -a`</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/(\w+) = ([^;]+);/</span>).<span class="ruby-identifier">flatten</span>]
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">h</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">k</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp">/\^(.)/</span>){(<span class="ruby-node">$1</span>[<span class="ruby-value">0</span>].<span class="ruby-identifier">ord</span> <span class="ruby-operator">^</span> ((<span class="ruby-value">?a</span><span class="ruby-operator">..</span><span class="ruby-value">?z</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-node">$1</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">?</span> <span class="ruby-value">0x60</span> <span class="ruby-operator">:</span> <span class="ruby-value">0x40</span>)).<span class="ruby-identifier">chr</span>}}
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_erase</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;erase&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_kill</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;kill&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_intr</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;intr&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_quit</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;quit&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_start</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;start&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_stop</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;stop&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_eof</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;eof&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_eol</span> = <span class="ruby-string">&quot;\n&quot;</span>
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_eol2</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;eol2&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_susp</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;susp&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_dsusp</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;dsusp&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_reprint</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;rprnt&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_flush</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;flush&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_werase</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;werase&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_lnext</span> = <span class="ruby-identifier">h</span>[<span class="ruby-string">&#39;lnext&#39;</span>]
  <span class="ruby-ivar">@_rl_tty_chars</span>.<span class="ruby-identifier">t_status</span> = <span class="ruby-value">-1</span>
  <span class="ruby-identifier">retry_if_interrupted</span> <span class="ruby-keyword">do</span>
    <span class="ruby-ivar">@otio</span> = <span class="ruby-value">%xstty -g`</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-set_completion_defaults" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">set_completion_defaults</span><span
            class="method-args">(what_to_do)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set default values for readline word completion.  These are the variables</p>

<pre>that application completion functions can change or inspect.</pre>
          
          

          
          <div class="method-source-code" id="set_completion_defaults-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6126</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">set_completion_defaults</span>(<span class="ruby-identifier">what_to_do</span>)
  <span class="ruby-comment"># Only the completion entry function can change these.</span>
  <span class="ruby-ivar">@rl_filename_completion_desired</span> = <span class="ruby-keyword">false</span>
  <span class="ruby-ivar">@rl_filename_quoting_desired</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@rl_completion_type</span> = <span class="ruby-identifier">what_to_do</span>
  <span class="ruby-ivar">@rl_completion_suppress_append</span> = <span class="ruby-ivar">@rl_completion_suppress_quote</span> = <span class="ruby-keyword">false</span>

  <span class="ruby-comment"># The completion entry function may optionally change this.</span>
  <span class="ruby-ivar">@rl_completion_mark_symlink_dirs</span> = <span class="ruby-ivar">@_rl_complete_mark_symlink_dirs</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-sh_set_lines_and_columns" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">sh_set_lines_and_columns</span><span
            class="method-args">(lines, cols)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Set the environment variables LINES and COLUMNS to lines and cols,</p>

<pre>respectively.</pre>
          
          

          
          <div class="method-source-code" id="sh_set_lines_and_columns-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1848</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">sh_set_lines_and_columns</span>(<span class="ruby-identifier">lines</span>, <span class="ruby-identifier">cols</span>)
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;LINES&quot;</span>] = <span class="ruby-identifier">lines</span>.<span class="ruby-identifier">to_s</span>
  <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;COLUMNS&quot;</span>] = <span class="ruby-identifier">cols</span>.<span class="ruby-identifier">to_s</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-space_to_eol" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">space_to_eol</span><span
            class="method-args">(count)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Clear to the end of the line using spaces.  COUNT is the minimum</p>

<pre>number of character spaces to clear,</pre>
          
          

          
          <div class="method-source-code" id="space_to_eol-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4606</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">space_to_eol</span>(<span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@hConsoleHandle</span>
    <span class="ruby-identifier">csbi</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">24</span>
    <span class="ruby-ivar">@GetConsoleScreenBufferInfo</span>.<span class="ruby-constant">Call</span>(<span class="ruby-ivar">@hConsoleHandle</span>,<span class="ruby-identifier">csbi</span>)
    <span class="ruby-identifier">cursor_pos</span> = <span class="ruby-identifier">csbi</span>[<span class="ruby-value">4</span>,<span class="ruby-value">4</span>].<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;L&#39;</span>).<span class="ruby-identifier">first</span>
    <span class="ruby-identifier">written</span> = <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">*</span> <span class="ruby-value">4</span>
    <span class="ruby-ivar">@FillConsoleOutputCharacter</span>.<span class="ruby-constant">Call</span>(<span class="ruby-ivar">@hConsoleHandle</span>,<span class="ruby-value">0x20</span>,<span class="ruby-identifier">count</span>,<span class="ruby-identifier">cursor_pos</span>,<span class="ruby-identifier">written</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">count</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">count</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stat_char" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stat_char</span><span
            class="method-args">(filename)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Return the character which best describes FILENAME.</p>

<pre>`@&#39; for symbolic links
`/&#39; for directories
`*&#39; for executables
`=&#39; for sockets
`|&#39; for FIFOs
`%&#39; for character special devices
`#&#39; for block special devices</pre>
          
          

          
          <div class="method-source-code" id="stat_char-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6514</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stat_char</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">filename</span>)

  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;/&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">directory?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;%&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">chardev?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;#&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">blockdev?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;@&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">symlink?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;=&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">socket?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;|&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">pipe?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;*&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">executable?</span>(<span class="ruby-identifier">filename</span>)
  <span class="ruby-keyword">nil</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-stifle_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">stifle_history</span><span
            class="method-args">(max)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Stifle the history list, remembering only MAX number of lines.</p>
          
          

          
          <div class="method-source-code" id="stifle_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8468</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">stifle_history</span>(<span class="ruby-identifier">max</span>)
  <span class="ruby-identifier">max</span> = <span class="ruby-value">0</span> <span class="ruby-keyword">if</span> (<span class="ruby-identifier">max</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>)

  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@history_length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max</span>)
    <span class="ruby-ivar">@the_history</span>.<span class="ruby-identifier">slice!</span>(<span class="ruby-value">0</span>,(<span class="ruby-ivar">@history_length</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">max</span>))
    <span class="ruby-ivar">@history_length</span> = <span class="ruby-identifier">max</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@history_stifled</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-ivar">@max_input_history</span> = <span class="ruby-ivar">@history_max_entries</span> = <span class="ruby-identifier">max</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-tgetflag" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">tgetflag</span><span
            class="method-args">(name)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="tgetflag-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 1899</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">tgetflag</span>(<span class="ruby-identifier">name</span>)
    <span class="ruby-value">%xinfocmp -C -r`</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/\w{2}/</span>).<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">name</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-trans" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">trans</span><span
            class="method-args">(i)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Undo the next thing in the list.  Return 0 if there</p>

<pre>is nothing to undo, or non-zero if there was.</pre>
          
          

          
          <div class="method-source-code" id="trans-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 7604</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">trans</span>(<span class="ruby-identifier">i</span>)
  ((<span class="ruby-identifier">i</span>) <span class="ruby-operator">==</span> <span class="ruby-value">-1</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_point</span> <span class="ruby-operator">:</span> ((<span class="ruby-identifier">i</span>) <span class="ruby-operator">==</span> <span class="ruby-value">-2</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@rl_end</span> <span class="ruby-operator">:</span> (<span class="ruby-identifier">i</span>)))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-unstifle_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">unstifle_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Stop stifling the history.  This returns the previous maximum</p>

<pre>number of history entries.  The value is positive if the history
was stifled,  negative if it wasn&#39;t.</pre>
          
          

          
          <div class="method-source-code" id="unstifle_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8483</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">unstifle_history</span>()
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@history_stifled</span>)
    <span class="ruby-ivar">@history_stifled</span> = <span class="ruby-keyword">false</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-ivar">@history_max_entries</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-keyword">return</span> (<span class="ruby-operator">-</span><span class="ruby-ivar">@history_max_entries</span>)
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-update_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">update_line</span><span
            class="method-args">(old, ostart, new, current_line, omax, nmax, inv_botlin)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>PWP: <a href="RbReadline.html#method-i-update_line">#update_line</a>() is
based on finding the middle difference of each</p>

<pre> line on the screen; vis:

           /old first difference
/beginning of line   |        /old last same       /old EOL
v          v         v         v</pre>

<p>old:   eddie&gt; Oh, my little gruntle-buggy is to me, as lurgid as new:  
eddie&gt; Oh, my little buggy says to me, as lurgid as</p>

<pre>^          ^   ^           ^
\beginning of line   |  \new last same    \new end of line
           \new first difference

 All are character pointers for the sake of speed.  Special cases for
 no differences, as well as for end of line additions must be handled.

 Could be made even smarter, but this works well enough</pre>
          
          

          
          <div class="method-source-code" id="update_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2675</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">update_line</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span>, <span class="ruby-identifier">new</span>, <span class="ruby-identifier">current_line</span>, <span class="ruby-identifier">omax</span>, <span class="ruby-identifier">nmax</span>, <span class="ruby-identifier">inv_botlin</span>)
  <span class="ruby-comment"># If we&#39;re at the right edge of a terminal that supports xn, we&#39;re</span>
  <span class="ruby-comment">#   ready to wrap around, so do so.  This fixes problems with knowing</span>
  <span class="ruby-comment">#   the exact cursor position and cut-and-paste with certain terminal</span>
  <span class="ruby-comment">#   emulators.  In this calculation, TEMP is the physical screen</span>
  <span class="ruby-comment">#   position of the cursor.</span>
  <span class="ruby-keyword">if</span> <span class="ruby-ivar">@encoding</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;X&#39;</span>
    <span class="ruby-identifier">old</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;ASCII-8BIT&#39;</span>)
    <span class="ruby-identifier">new</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-string">&#39;ASCII-8BIT&#39;</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@_rl_last_c_pos</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">temp</span> = <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">w_offset</span>(<span class="ruby-ivar">@_rl_last_v_pos</span>, <span class="ruby-ivar">@visible_wrap_offset</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@_rl_screenwidth</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_term_autowrap</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-ivar">@_rl_last_v_pos</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)

    <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
      <span class="ruby-comment"># This fixes only double-column characters, but if the wrapped</span>
      <span class="ruby-comment">#   character comsumes more than three columns, spaces will be</span>
      <span class="ruby-comment">#   inserted in the string buffer.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">current_line</span>] <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-ivar">@_rl_wrapped_line</span>[<span class="ruby-identifier">current_line</span>])
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
        <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
        <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
          <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">new</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>]
          <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
          <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">new</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>]
          <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
        <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
          <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">new</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>]
          <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&#39;U&#39;</span>).<span class="ruby-identifier">first</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
          <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>]
          <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">bytesize</span>
          <span class="ruby-identifier">tempwidth</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">ord</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0x1000</span> <span class="ruby-operator">?</span> <span class="ruby-value">2</span> <span class="ruby-operator">:</span> <span class="ruby-value">1</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">ret</span> = <span class="ruby-value">1</span>
          <span class="ruby-identifier">tempwidth</span> = <span class="ruby-value">1</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">tempwidth</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">tempwidth</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">bytes</span> = <span class="ruby-identifier">ret</span>
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">bytes</span>])
        <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">tempwidth</span>
        <span class="ruby-ivar">@_rl_last_v_pos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>

        <span class="ruby-keyword">if</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>
          <span class="ruby-keyword">case</span> <span class="ruby-ivar">@encoding</span>
          <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;E&#39;</span>
            <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./me</span>)[<span class="ruby-value">0</span>]
            <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;S&#39;</span>
            <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./ms</span>)[<span class="ruby-value">0</span>]
            <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;U&#39;</span>
            <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">scan</span>(<span class="ruby-regexp">/./mu</span>)[<span class="ruby-value">0</span>]
            <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">length</span>
          <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;X&#39;</span>
            <span class="ruby-identifier">wc</span> = <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">force_encoding</span>(<span class="ruby-ivar">@encoding_name</span>)[<span class="ruby-value">0</span>]
            <span class="ruby-identifier">ret</span> = <span class="ruby-identifier">wc</span>.<span class="ruby-identifier">bytesize</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">ret</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ret</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">bytes</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>)
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">ret</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">bytes</span>
            <span class="ruby-identifier">len</span> = <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>].<span class="ruby-identifier">index</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>,<span class="ruby-identifier">ret</span>)
            <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">bytes</span>,<span class="ruby-identifier">len</span><span class="ruby-operator">-</span><span class="ruby-identifier">ret</span>] = <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ret</span>,<span class="ruby-identifier">len</span><span class="ruby-operator">-</span><span class="ruby-identifier">ret</span>]
          <span class="ruby-keyword">end</span>
          <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-identifier">bytes</span>] = <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">bytes</span>]
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39; &#39;</span>)
        <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-value">1</span>
        <span class="ruby-ivar">@_rl_last_v_pos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
        <span class="ruby-keyword">if</span> (<span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
          <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-value">1</span>] = <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>]
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>])
      <span class="ruby-keyword">else</span>
        <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-string">&#39; &#39;</span>)
      <span class="ruby-keyword">end</span>
      <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-value">1</span>
      <span class="ruby-ivar">@_rl_last_v_pos</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)
        <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-value">1</span>] = <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-value">1</span>]
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Find first difference.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)
    <span class="ruby-comment"># See if the old line is a subset of the new line, so that the</span>
    <span class="ruby-comment"># only change is adding characters.</span>
    <span class="ruby-identifier">temp</span> = (<span class="ruby-identifier">omax</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">nmax</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">omax</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">nmax</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-identifier">temp</span>]<span class="ruby-operator">==</span><span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">temp</span>]
      <span class="ruby-identifier">ofd</span> = <span class="ruby-identifier">temp</span>
      <span class="ruby-identifier">nfd</span> = <span class="ruby-identifier">temp</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">omax</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">nmax</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new</span>[<span class="ruby-value">0</span>,<span class="ruby-identifier">omax</span>]<span class="ruby-operator">==</span><span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span>,<span class="ruby-identifier">omax</span>])
        <span class="ruby-identifier">ofd</span> = <span class="ruby-identifier">omax</span>
        <span class="ruby-identifier">nfd</span> = <span class="ruby-identifier">nmax</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">new_offset</span> = <span class="ruby-value">0</span>
        <span class="ruby-identifier">old_offset</span> = <span class="ruby-identifier">ostart</span>
        <span class="ruby-identifier">ofd</span> = <span class="ruby-value">0</span>
        <span class="ruby-identifier">nfd</span> = <span class="ruby-value">0</span>
        <span class="ruby-keyword">while</span>(<span class="ruby-identifier">ofd</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">omax</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ofd</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span>
              <span class="ruby-identifier">_rl_compare_chars</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">old_offset</span>, <span class="ruby-identifier">new</span>, <span class="ruby-identifier">new_offset</span>))

          <span class="ruby-identifier">old_offset</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">old_offset</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
          <span class="ruby-identifier">new_offset</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">new_offset</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
          <span class="ruby-identifier">ofd</span> = <span class="ruby-identifier">old_offset</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">ostart</span>
          <span class="ruby-identifier">nfd</span> = <span class="ruby-identifier">new_offset</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ofd</span> = <span class="ruby-value">0</span>
    <span class="ruby-identifier">nfd</span> = <span class="ruby-value">0</span>
    <span class="ruby-keyword">while</span>(<span class="ruby-identifier">ofd</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">omax</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ofd</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ofd</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">new</span>[<span class="ruby-identifier">nfd</span>,<span class="ruby-value">1</span>])
      <span class="ruby-identifier">ofd</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
      <span class="ruby-identifier">nfd</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>


  <span class="ruby-comment"># Move to the end of the screen line.  ND and OD are used to keep track</span>
  <span class="ruby-comment">#   of the distance between ne and new and oe and old, respectively, to</span>
  <span class="ruby-comment">#   move a subtraction out of each loop.</span>
  <span class="ruby-identifier">oe</span> = <span class="ruby-identifier">old</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>,<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ofd</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">ostart</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">oe</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">oe</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">omax</span>
    <span class="ruby-identifier">oe</span> = <span class="ruby-identifier">omax</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">ne</span> = <span class="ruby-identifier">new</span>.<span class="ruby-identifier">index</span>(<span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>,<span class="ruby-identifier">nfd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">ne</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">ne</span><span class="ruby-operator">&gt;</span><span class="ruby-identifier">omax</span>
    <span class="ruby-identifier">ne</span> = <span class="ruby-identifier">nmax</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If no difference, continue to next line.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">ofd</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">oe</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">nfd</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">ne</span>)
    <span class="ruby-keyword">return</span>
  <span class="ruby-keyword">end</span>


  <span class="ruby-identifier">wsatend</span> = <span class="ruby-keyword">true</span>       <span class="ruby-comment"># flag for trailing whitespace</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>)

    <span class="ruby-identifier">ols</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">oe</span>, <span class="ruby-constant">MB_FIND_ANY</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">ostart</span>
    <span class="ruby-identifier">nls</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">ne</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
    <span class="ruby-keyword">while</span> ((<span class="ruby-identifier">ols</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ofd</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">nls</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">nfd</span>))

      <span class="ruby-keyword">if</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_compare_chars</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>, <span class="ruby-identifier">new</span>, <span class="ruby-identifier">nls</span>))
        <span class="ruby-keyword">break</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-string">&quot; &quot;</span>)
        <span class="ruby-identifier">wsatend</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">ols</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ols</span><span class="ruby-operator">+</span><span class="ruby-identifier">ostart</span>, <span class="ruby-constant">MB_FIND_ANY</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">ostart</span>
      <span class="ruby-identifier">nls</span> = <span class="ruby-identifier">_rl_find_prev_mbchar</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">nls</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">ols</span> = <span class="ruby-identifier">oe</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>         <span class="ruby-comment"># find last same</span>
    <span class="ruby-identifier">nls</span> = <span class="ruby-identifier">ne</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>
    <span class="ruby-keyword">while</span> ((<span class="ruby-identifier">ols</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ofd</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">nls</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">nfd</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">new</span>[<span class="ruby-identifier">nls</span>,<span class="ruby-value">1</span>])
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-string">&quot; &quot;</span>)
        <span class="ruby-identifier">wsatend</span> = <span class="ruby-keyword">false</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-identifier">ols</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
      <span class="ruby-identifier">nls</span><span class="ruby-operator">-=</span><span class="ruby-value">1</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">wsatend</span>)
    <span class="ruby-identifier">ols</span> = <span class="ruby-identifier">oe</span>
    <span class="ruby-identifier">nls</span> = <span class="ruby-identifier">ne</span>
  <span class="ruby-keyword">elsif</span> (<span class="ruby-operator">!</span><span class="ruby-identifier">_rl_compare_chars</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>, <span class="ruby-identifier">new</span>, <span class="ruby-identifier">nls</span>))
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span>)         <span class="ruby-comment"># don&#39;t step past the NUL</span>
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-identifier">ols</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">ostart</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">ols</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-identifier">new</span>[<span class="ruby-identifier">nls</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> )
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-identifier">nls</span> = <span class="ruby-identifier">_rl_find_next_mbchar</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">nls</span>, <span class="ruby-value">1</span>, <span class="ruby-constant">MB_FIND_ANY</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">nls</span><span class="ruby-operator">+=</span><span class="ruby-value">1</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># count of invisible characters in the current invisible line.</span>
  <span class="ruby-identifier">current_invis_chars</span> = <span class="ruby-identifier">w_offset</span>(<span class="ruby-identifier">current_line</span>, <span class="ruby-ivar">@wrap_offset</span>)
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_last_v_pos</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">current_line</span>)
    <span class="ruby-identifier">_rl_move_vert</span>(<span class="ruby-identifier">current_line</span>)
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@visible_wrap_offset</span><span class="ruby-operator">!=</span><span class="ruby-value">0</span>)
      <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@visible_wrap_offset</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If this is the first line and there are invisible characters in the</span>
  <span class="ruby-comment">#   prompt string, and the prompt string has not changed, and the current</span>
  <span class="ruby-comment">#   cursor position is before the last invisible character in the prompt,</span>
  <span class="ruby-comment">#   and the index of the character to move to is past the end of the prompt</span>
  <span class="ruby-comment">#   string, then redraw the entire prompt string.  We can only do this</span>
  <span class="ruby-comment">#   reliably if the terminal supports a `cr&#39; capability.</span>

  <span class="ruby-comment">#  This is not an efficiency hack -- there is a problem with redrawing</span>
  <span class="ruby-comment">#  portions of the prompt string if they contain terminal escape</span>
  <span class="ruby-comment">#  sequences (like drawing the `unbold&#39; sequence without a corresponding</span>
  <span class="ruby-comment">#  `bold&#39;) that manifests itself on certain terminals.</span>

  <span class="ruby-identifier">lendiff</span> = <span class="ruby-ivar">@local_prompt_len</span>

  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-ivar">@_rl_term_cr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@prompt_visible_length</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-identifier">ofd</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">prompt_ending_index</span>())
    <span class="ruby-ivar">@rl_outstream</span>.<span class="ruby-identifier">write</span>(<span class="ruby-ivar">@_rl_term_cr</span>)
    <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-ivar">@local_prompt</span>,<span class="ruby-value">0</span>,<span class="ruby-identifier">lendiff</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-comment"># We take wrap_offset into account here so we can pass correct</span>
      <span class="ruby-comment">#   information to _rl_move_cursor_relative.</span>
      <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-ivar">@local_prompt</span>, <span class="ruby-value">0</span>, <span class="ruby-identifier">lendiff</span>) <span class="ruby-operator">-</span> <span class="ruby-ivar">@wrap_offset</span>
      <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-ivar">@_rl_last_c_pos</span> = <span class="ruby-identifier">lendiff</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">o_cpos</span> = <span class="ruby-ivar">@_rl_last_c_pos</span>

  <span class="ruby-comment"># When this function returns, _rl_last_c_pos is correct, and an absolute</span>
  <span class="ruby-comment">#   cursor postion in multibyte mode, but a buffer index when not in a</span>
  <span class="ruby-comment">#   multibyte locale.</span>
  <span class="ruby-identifier">_rl_move_cursor_relative</span>(<span class="ruby-identifier">ofd</span>, <span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span>)

  <span class="ruby-comment"># We need to indicate that the cursor position is correct in the presence</span>
  <span class="ruby-comment"># of invisible characters in the prompt string.  Let&#39;s see if setting this</span>
  <span class="ruby-comment"># when we make sure we&#39;re at the end of the drawn prompt string works.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span> <span class="ruby-operator">&amp;&amp;</span>
      (<span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">o_cpos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@prompt_physical_chars</span>)
    <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># if (len (new) &gt; len (old))</span>
  <span class="ruby-comment">#   lendiff == difference in buffer</span>
  <span class="ruby-comment">#   col_lendiff == difference on screen</span>
  <span class="ruby-comment">#   When not using multibyte characters, these are equal</span>
  <span class="ruby-identifier">lendiff</span> = (<span class="ruby-identifier">nls</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">nfd</span>) <span class="ruby-operator">-</span> (<span class="ruby-identifier">ols</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">ofd</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">col_lendiff</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">nls</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ofd</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">col_lendiff</span> = <span class="ruby-identifier">lendiff</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># If we are changing the number of invisible characters in a line, and</span>
  <span class="ruby-comment">#   the spot of first difference is before the end of the invisible chars,</span>
  <span class="ruby-comment">#   lendiff needs to be adjusted.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span>
      <span class="ruby-identifier">current_invis_chars</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@visible_wrap_offset</span>)
    <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
      <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@visible_wrap_offset</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">current_invis_chars</span>
      <span class="ruby-identifier">col_lendiff</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@visible_wrap_offset</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">current_invis_chars</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@visible_wrap_offset</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">current_invis_chars</span>
      <span class="ruby-identifier">col_lendiff</span> = <span class="ruby-identifier">lendiff</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-comment"># Insert (diff (len (old), len (new)) ch.</span>
  <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">ne</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">nfd</span>
  <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
    <span class="ruby-identifier">col_temp</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>,<span class="ruby-identifier">ne</span>)
  <span class="ruby-keyword">else</span>
    <span class="ruby-identifier">col_temp</span> = <span class="ruby-identifier">temp</span>
  <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-identifier">col_lendiff</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>) <span class="ruby-comment"># XXX - was lendiff</span>

    <span class="ruby-comment"># Non-zero if we&#39;re increasing the number of lines.</span>
    <span class="ruby-identifier">gl</span> = <span class="ruby-identifier">current_line</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@_rl_vis_botlin</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">inv_botlin</span> <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_vis_botlin</span>

    <span class="ruby-comment"># If col_lendiff is &gt; 0, implying that the new string takes up more</span>
    <span class="ruby-comment"># screen real estate than the old, but lendiff is &lt; 0, meaning that it</span>
    <span class="ruby-comment"># takes fewer bytes, we need to just output the characters starting from</span>
    <span class="ruby-comment"># the first difference.  These will overwrite what is on the display, so</span>
    <span class="ruby-comment"># there&#39;s no reason to do a smart update.  This can really only happen in</span>
    <span class="ruby-comment"># a multibyte environment.</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>
      <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">temp</span>)
      <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">new</span>, <span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">nfd</span><span class="ruby-operator">+</span><span class="ruby-identifier">temp</span>)

      <span class="ruby-comment"># If nfd begins before any invisible characters in the prompt, adjust</span>
      <span class="ruby-comment"># _rl_last_c_pos to account for wrap_offset and set cpos_adjusted to</span>
      <span class="ruby-comment"># let the caller know.</span>
      <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">nfd</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@prompt_last_invisible</span>
        <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@wrap_offset</span>
        <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">return</span>
    <span class="ruby-comment"># Sometimes it is cheaper to print the characters rather than</span>
    <span class="ruby-comment"># use the terminal&#39;s capabilities.  If we&#39;re growing the number</span>
    <span class="ruby-comment"># of lines, make sure we actually cause the new line to wrap</span>
    <span class="ruby-comment"># around on auto-wrapping terminals.</span>
    <span class="ruby-keyword">elsif</span> (<span class="ruby-ivar">@_rl_terminal_can_insert</span> <span class="ruby-operator">&amp;&amp;</span> ((<span class="ruby-value">2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">col_temp</span>) <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">col_lendiff</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_term_IC</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_term_autowrap</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">gl</span>))

      <span class="ruby-comment"># If lendiff &gt; prompt_visible_length and _rl_last_c_pos == 0 and</span>
      <span class="ruby-comment">#   _rl_horizontal_scroll_mode == 1, inserting the characters with</span>
      <span class="ruby-comment">#   _rl_term_IC or _rl_term_ic will screw up the screen because of the</span>
      <span class="ruby-comment">#   invisible characters.  We need to just draw them.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-operator">!</span><span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">||</span>
                                         <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@prompt_visible_length</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">current_invis_chars</span><span class="ruby-operator">==</span><span class="ruby-value">0</span>))

        <span class="ruby-identifier">insert_some_chars</span>(<span class="ruby-identifier">new</span>[<span class="ruby-identifier">nfd</span><span class="ruby-operator">..</span><span class="ruby-value">-1</span>], <span class="ruby-identifier">lendiff</span>, <span class="ruby-identifier">col_lendiff</span>)
        <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">col_lendiff</span>
      <span class="ruby-keyword">elsif</span> ((<span class="ruby-ivar">@rl_byte_oriented</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">old</span>[<span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">ols</span>,<span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value">0</span>.<span class="ruby-identifier">chr</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">lendiff</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-comment"># At the end of a line the characters do not have to</span>
        <span class="ruby-comment"># be &quot;inserted&quot;.  They can just be placed on the screen.</span>
        <span class="ruby-comment"># However, this screws up the rest of this block, which</span>
        <span class="ruby-comment"># assumes you&#39;ve done the insert because you can.</span>
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">lendiff</span>)
        <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">col_lendiff</span>
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">temp</span>)
        <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">col_temp</span>
        <span class="ruby-comment"># If nfd begins before any invisible characters in the prompt, adjust</span>
        <span class="ruby-comment"># _rl_last_c_pos to account for wrap_offset and set cpos_adjusted to</span>
        <span class="ruby-comment"># let the caller know.</span>
        <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">nfd</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@prompt_last_invisible</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@wrap_offset</span>
          <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
        <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">return</span>
      <span class="ruby-keyword">end</span>
      <span class="ruby-comment"># Copy (new) chars to screen from first diff to last match.</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">nls</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">nfd</span>
      <span class="ruby-keyword">if</span> ((<span class="ruby-identifier">temp</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lendiff</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>,(<span class="ruby-identifier">nfd</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">lendiff</span>),<span class="ruby-identifier">temp</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">lendiff</span>)
        <span class="ruby-comment"># XXX -- this bears closer inspection.  Fixes a redisplay bug</span>
        <span class="ruby-comment"># reported against bash-3.0-alpha by Andreas Schwab involving</span>
        <span class="ruby-comment"># multibyte characters and prompt strings with invisible</span>
        <span class="ruby-comment"># characters, but was previously disabled.</span>
        <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span><span class="ruby-operator">+</span><span class="ruby-identifier">lendiff</span>, <span class="ruby-identifier">nfd</span><span class="ruby-operator">+</span><span class="ruby-identifier">lendiff</span><span class="ruby-operator">+</span><span class="ruby-identifier">temp</span><span class="ruby-operator">-</span><span class="ruby-identifier">col_lendiff</span>)
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-comment"># cannot insert chars, write to EOL</span>
      <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">temp</span>)
      <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">col_temp</span>
      <span class="ruby-comment"># If we&#39;re in a multibyte locale and were before the last invisible</span>
      <span class="ruby-comment">#   char in the current line (which implies we just output some invisible</span>
      <span class="ruby-comment">#   characters) we need to adjust _rl_last_c_pos, since it represents</span>
      <span class="ruby-comment">#   a physical character position.</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">else</span>           <span class="ruby-comment"># Delete characters from line.</span>
    <span class="ruby-comment"># If possible and inexpensive to use terminal deletion, then do so.</span>
    <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_dc</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-value">2</span> <span class="ruby-operator">*</span> <span class="ruby-identifier">col_temp</span>) <span class="ruby-operator">&gt;=</span> <span class="ruby-operator">-</span><span class="ruby-identifier">col_lendiff</span>)

      <span class="ruby-comment"># If all we&#39;re doing is erasing the invisible characters in the</span>
      <span class="ruby-comment">#   prompt string, don&#39;t bother.  It screws up the assumptions</span>
      <span class="ruby-comment">#   about what&#39;s on the screen.</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_horizontal_scroll_mode</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span>
          <span class="ruby-operator">-</span><span class="ruby-identifier">lendiff</span> <span class="ruby-operator">==</span> <span class="ruby-ivar">@visible_wrap_offset</span>)
        <span class="ruby-identifier">col_lendiff</span> = <span class="ruby-value">0</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">col_lendiff!</span>=<span class="ruby-value">0</span>)
        <span class="ruby-identifier">delete_chars</span>(<span class="ruby-operator">-</span><span class="ruby-identifier">col_lendiff</span>) <span class="ruby-comment"># delete (diff) characters</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Copy (new) chars to screen from first diff to last match</span>
      <span class="ruby-identifier">temp</span> = <span class="ruby-identifier">nls</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">nfd</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-comment"># If nfd begins at the prompt, or before the invisible characters in</span>
        <span class="ruby-comment"># the prompt, we need to adjust _rl_last_c_pos in a multibyte locale</span>
        <span class="ruby-comment"># to account for the wrap offset and set cpos_adjusted accordingly.</span>
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">temp</span>)
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>,<span class="ruby-identifier">nfd</span><span class="ruby-operator">+</span><span class="ruby-identifier">temp</span>)
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">nfd</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@prompt_last_invisible</span>
            <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@wrap_offset</span>
            <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">else</span>
          <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">temp</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-comment"># Otherwise, print over the existing material.</span>
    <span class="ruby-keyword">else</span>
      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">temp</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>)
        <span class="ruby-comment"># If nfd begins at the prompt, or before the invisible characters in</span>
        <span class="ruby-comment"># the prompt, we need to adjust _rl_last_c_pos in a multibyte locale</span>
        <span class="ruby-comment"># to account for the wrap offset and set cpos_adjusted accordingly.</span>
        <span class="ruby-identifier">_rl_output_some_chars</span>(<span class="ruby-identifier">new</span>,<span class="ruby-identifier">nfd</span>, <span class="ruby-identifier">temp</span>)
        <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">col_temp</span>      <span class="ruby-comment"># XXX</span>
        <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
          <span class="ruby-keyword">if</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@wrap_offset</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">nfd</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-ivar">@prompt_last_invisible</span>
            <span class="ruby-ivar">@_rl_last_c_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-ivar">@wrap_offset</span>
            <span class="ruby-ivar">@cpos_adjusted</span> = <span class="ruby-keyword">true</span>
          <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-identifier">lendiff</span> = (<span class="ruby-identifier">oe</span>) <span class="ruby-operator">-</span> (<span class="ruby-identifier">ne</span>)
      <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@rl_byte_oriented</span>
        <span class="ruby-identifier">col_lendiff</span> = <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">old</span>, <span class="ruby-identifier">ostart</span>, <span class="ruby-identifier">ostart</span><span class="ruby-operator">+</span><span class="ruby-identifier">oe</span>) <span class="ruby-operator">-</span> <span class="ruby-identifier">_rl_col_width</span>(<span class="ruby-identifier">new</span>, <span class="ruby-value">0</span>, <span class="ruby-identifier">ne</span>)
      <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">col_lendiff</span> = <span class="ruby-identifier">lendiff</span>
      <span class="ruby-keyword">end</span>

      <span class="ruby-keyword">if</span> (<span class="ruby-identifier">col_lendiff!</span>=<span class="ruby-value">0</span>)
        <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@_rl_term_autowrap</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_line</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">inv_botlin</span>)
          <span class="ruby-identifier">space_to_eol</span>(<span class="ruby-identifier">col_lendiff</span>)
        <span class="ruby-keyword">else</span>
          <span class="ruby-identifier">_rl_clear_to_eol</span>(<span class="ruby-identifier">col_lendiff</span>)
        <span class="ruby-keyword">end</span>
      <span class="ruby-keyword">end</span>
    <span class="ruby-keyword">end</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-using_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">using_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="using_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 6120</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">using_history</span>()
  <span class="ruby-ivar">@history_offset</span> = <span class="ruby-ivar">@history_length</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vis_chars" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vis_chars</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="vis_chars-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2638</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vis_chars</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-ivar">@visible_line</span>[<span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-identifier">line</span>] <span class="ruby-operator">..</span> <span class="ruby-value">-1</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vis_line" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vis_line</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="vis_line-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2646</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vis_line</span>(<span class="ruby-identifier">line</span>)
  ((<span class="ruby-identifier">line</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_vis_botlin</span>) <span class="ruby-operator">?</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">vis_chars</span>(<span class="ruby-identifier">line</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vis_llen" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vis_llen</span><span
            class="method-args">(l)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="vis_llen-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2630</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vis_llen</span>(<span class="ruby-identifier">l</span>)
  ((<span class="ruby-identifier">l</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@_rl_vis_botlin</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> (<span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-identifier">l</span><span class="ruby-operator">+</span><span class="ruby-value">1</span>] <span class="ruby-operator">-</span> <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-identifier">l</span>]))
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-vis_pos" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">vis_pos</span><span
            class="method-args">(line)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="vis_pos-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2642</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">vis_pos</span>(<span class="ruby-identifier">line</span>)
  <span class="ruby-ivar">@vis_lbreaks</span>[<span class="ruby-identifier">line</span>]
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-w_offset" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">w_offset</span><span
            class="method-args">(line, offset)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="w_offset-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2626</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">w_offset</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">offset</span>)
  ((<span class="ruby-identifier">line</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">offset</span> <span class="ruby-operator">:</span> <span class="ruby-value">0</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-where_history" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">where_history</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Returns the magic number which says what history element we are</p>

<pre>looking at now.  In this implementation, it returns history_offset.</pre>
          
          

          
          <div class="method-source-code" id="where_history-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 5352</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">where_history</span>()
  <span class="ruby-ivar">@history_offset</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-whitespace" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">whitespace</span><span
            class="method-args">(c)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="whitespace-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 2622</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">whitespace</span>(<span class="ruby-identifier">c</span>)
  (<span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39; &#39;</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;\t&quot;</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
     <section id="private-instance-5Buntitled-5D-method-details" class="method-section">
       <header>
         <h3>Private Instance Methods</h3>
       </header>

    
      <div id="method-i-no_terminal-3F" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">no_terminal?</span><span
            class="method-args">()</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          
          
          

          
          <div class="method-source-code" id="no_terminal-3F-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 8859</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">no_terminal?</span>
  <span class="ruby-identifier">term</span> = <span class="ruby-constant">ENV</span>[<span class="ruby-string">&quot;TERM&quot;</span>]
  <span class="ruby-identifier">term</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">term</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;dumb&#39;</span>) <span class="ruby-operator">||</span> (<span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/mswin|mingw/</span>)
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
      <div id="method-i-readline" class="method-detail ">
        
        <div class="method-heading">
          <span class="method-name">readline</span><span
            class="method-args">(prompt)</span>
          
          <span class="method-click-advice">click to toggle source</span>
          
        </div>
        

        <div class="method-description">
          
          <p>Read a line of input.  Prompt with PROMPT.  An empty PROMPT means</p>

<pre>none.  A return value of NULL means that EOF was encountered.</pre>
          
          

          
          <div class="method-source-code" id="readline-source">
            <pre><span class="ruby-comment"># File lib/rbreadline.rb, line 4806</span>
<span class="ruby-keyword">def</span> <span class="ruby-identifier">readline</span>(<span class="ruby-identifier">prompt</span>)
  <span class="ruby-comment"># If we are at EOF return a NULL string.</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_pending_input</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EOF</span>)
    <span class="ruby-identifier">rl_clear_pending_input</span>()
    <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_set_prompt</span>(<span class="ruby-identifier">prompt</span>)

  <span class="ruby-identifier">rl_initialize</span>()
  <span class="ruby-ivar">@readline_echoing_p</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">if</span> (<span class="ruby-ivar">@rl_prep_term_function</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_prep_term_function</span>,<span class="ruby-ivar">@_rl_meta_flag</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">rl_set_signals</span>()

  <span class="ruby-identifier">value</span> = <span class="ruby-identifier">readline_internal</span>()
  <span class="ruby-keyword">if</span>(<span class="ruby-ivar">@rl_deprep_term_function</span>)
    <span class="ruby-identifier">send</span>(<span class="ruby-ivar">@rl_deprep_term_function</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">rl_clear_signals</span>()

  <span class="ruby-identifier">value</span>
<span class="ruby-keyword">end</span></pre>
          </div>
          
        </div>

        

        
      </div>

    
    </section>
  
  </section>
</main>


<footer id="validator-badges" role="contentinfo">
  <p><a href="http://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="http://rdoc.rubyforge.org">RDoc</a> 4.1.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

